(function(){store.enabled?Qiita.store=store:Qiita.store={set:function(key,value){return value},get:function(key,defaultVal){return defaultVal},remove:function(key){return void 0},clear:function(){return void 0},transact:function(key,defaultVal,transactionFn){return void 0},getAll:function(){return{}},forEach:function(callback){return void 0},serialize:store.serialize,deserialize:store.deserialize}}).call(this),window.ns=function(namespace){window.Qiita===undefined&&(window.Qiita={});var i,l,parts=namespace.split("."),parent=window.Qiita;parts[0]==="Qiita"&&(parts=parts.slice(1));for(i=0,l=parts.length;i<l;i++)_.isUndefined(parent[parts[i]])&&(parent[parts[i]]={}),parent=parent[parts[i]];return parent};var lockTable={},KEY_FOR_LOCK_UTILITIES="lock";_.mixin({capitalize:function(string){return string.charAt(0).toUpperCase()+string.substring(1).toLowerCase()},freeAll:function(){lockTable={}},lock:function(func){var funcId=_.uniqueId(KEY_FOR_LOCK_UTILITIES);return function(){if(lockTable[funcId])return lockTable[funcId].memo;lockTable[funcId]={};var args=[];args.push(function(){lockTable[funcId]=!1});var result=func.apply(this,args.concat(_.toArray(arguments)));return lockTable[funcId]&&(lockTable[funcId].memo=result),result}},lockAndFinallyReplayLastInvocation:function(func){var queuedArgsToReplay,uniqueObject,funcId;return queuedArgsToReplay=uniqueObject={},funcId=_.uniqueId(KEY_FOR_LOCK_UTILITIES),function(){var args=_.toArray(arguments);if(lockTable[funcId]){queuedArgsToReplay=args;return}lockTable[funcId]=!0;var that=this;args.unshift(function replayOrFree(){if(queuedArgsToReplay!==uniqueObject){var replayArgs=queuedArgsToReplay;queuedArgsToReplay=uniqueObject,replayArgs.unshift(replayOrFree),func.apply(that,replayArgs)}else lockTable[funcId]=!1}),func.apply(this,args)}},numberToHumanSize:function(number){if(number==Number.POSITIVE_INFINITY)return"&infin;";var units=["B","KB","MB","GB","TB"],i=0;while(number>1024)i++,number/=1024;return number=Math.round(number*100)/100,number+units[i]},strftime:function(date,format){var d,directive,replace,method,result=format,methods={d:"getDate",w:"getDay",Y:"getFullYear",H:"getHours",L:"getMilliseconds",M:"getMinutes",m:function(date){return date.getMonth()+1},S:"getSeconds",s:"getTime",z:"getTimezoneOffset"};for(d in methods)if(methods.hasOwnProperty(d)){directive="%"+d;if(result.indexOf(directive)==-1)continue;method=methods[d],_.isString(method)?replace=date[method].call(date):replace=method(date),result=result.replace(new RegExp(directive,"g"),replace)}return result},parse:function(escaped_json){return JSON.parse(_.unescape(escaped_json))}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(searchElement){"use strict";if(this===void 0||this===null)throw new TypeError;var t=Object(this),len=t.length>>>0;if(len===0)return-1;var n=0;arguments.length>0&&(n=Number(arguments[1]),n!==n?n=0:n!==0&&n!==Infinity&&n!==-Infinity&&(n=(n>0||-1)*Math.floor(Math.abs(n))));if(n>=len)return-1;var k=n>=0?n:Math.max(len-Math.abs(n),0);for(;k<len;k++)if(k in t&&t[k]===searchElement)return k;return-1});var I18n=I18n||{};I18n.defaultLocale="en",I18n.translations={},function(){var merge=function(dest,obj){var key,value;for(key in obj)obj.hasOwnProperty(key)&&(value=obj[key],Object.prototype.toString.call(value)==="[object String]"?dest[key]=value:(dest[key]==null&&(dest[key]={}),merge(dest[key],value)))};I18n.addTranslations=function(obj){merge(I18n.translations,obj)}}(),I18n.fallbacks=!1,I18n.defaultSeparator=".",I18n.locale=null,I18n.PLACEHOLDER=/(?:\{\{|%\{)(.*?)(?:\}\}?)/gm,I18n.fallbackRules={},I18n.pluralizationRules={en:function(n){return n==0?["zero","none","other"]:n==1?"one":"other"}},I18n.getFallbacks=function(locale){if(locale===I18n.defaultLocale)return[];if(!I18n.fallbackRules[locale]){var rules=[],components=locale.split("-");for(var l=1;l<components.length;l++)rules.push(components.slice(0,l).join("-"));rules.push(I18n.defaultLocale),I18n.fallbackRules[locale]=rules}return I18n.fallbackRules[locale]},I18n.isValidNode=function(obj,node,undefined){return obj[node]!==null&&obj[node]!==undefined},I18n.lookup=function(scope,options){var options=options||{},lookupInitialScope=scope,translations=this.prepareOptions(I18n.translations),locale=options.locale||I18n.currentLocale(),messages=translations[locale]||{},options=this.prepareOptions(options),currentScope;typeof scope=="object"&&(scope=scope.join(this.defaultSeparator)),options.scope&&(scope=options.scope.toString()+this.defaultSeparator+scope),scope=scope.split(this.defaultSeparator);while(messages&&scope.length>0)currentScope=scope.shift(),messages=messages[currentScope];if(!messages){if(I18n.fallbacks){var fallbacks=this.getFallbacks(locale);for(var fallback=0;fallback<fallbacks.length;fallbacks++){messages=I18n.lookup(lookupInitialScope,this.prepareOptions({locale:fallbacks[fallback]},options));if(messages)break}}!messages&&this.isValidNode(options,"defaultValue")&&(messages=options.defaultValue)}return messages},I18n.prepareOptions=function(){var options={},opts,count=arguments.length;for(var i=0;i<count;i++){opts=arguments[i];if(!opts)continue;for(var key in opts)this.isValidNode(options,key)||(options[key]=opts[key])}return options},I18n.interpolate=function(message,options){options=this.prepareOptions(options);var matches=message.match(this.PLACEHOLDER),placeholder,value,name;if(!matches)return message;for(var i=0;placeholder=matches[i];i++)name=placeholder.replace(this.PLACEHOLDER,"$1"),value=options[name],this.isValidNode(options,name)||(value="[missing "+placeholder+" value]"),regex=new RegExp(placeholder.replace(/\{/gm,"\\{").replace(/\}/gm,"\\}")),message=message.replace(regex,value);return message},I18n.translate=function(scope,options){options=this.prepareOptions(options);var translation=this.lookup(scope,options);try{return typeof translation=="object"?typeof options.count=="number"?this.pluralize(options.count,scope,options):translation:this.interpolate(translation,options)}catch(err){return this.missingTranslation(scope)}},I18n.localize=function(scope,value){switch(scope){case"currency":return this.toCurrency(value);case"number":return scope=this.lookup("number.format"),this.toNumber(value,scope);case"percentage":return this.toPercentage(value);default:return scope.match(/^(date|time)/)?this.toTime(scope,value):value.toString()}},I18n.parseDate=function(date){var matches,convertedDate;if(typeof date=="object")return date;matches=date.toString().match(/(\d{4})-(\d{2})-(\d{2})(?:[ T](\d{2}):(\d{2}):(\d{2}))?(Z|\+0000)?/);if(matches){for(var i=1;i<=6;i++)matches[i]=parseInt(matches[i],10)||0;matches[2]-=1,matches[7]?convertedDate=new Date(Date.UTC(matches[1],matches[2],matches[3],matches[4],matches[5],matches[6])):convertedDate=new Date(matches[1],matches[2],matches[3],matches[4],matches[5],matches[6])}else typeof date=="number"?(convertedDate=new Date,convertedDate.setTime(date)):date.match(/\d+ \d+:\d+:\d+ [+-]\d+ \d+/)?(convertedDate=new Date,convertedDate.setTime(Date.parse(date))):(convertedDate=new Date,convertedDate.setTime(Date.parse(date)));return convertedDate},I18n.toTime=function(scope,d){var date=this.parseDate(d),format=this.lookup(scope);return date.toString().match(/invalid/i)?date.toString():format?this.strftime(date,format):date.toString()},I18n.strftime=function(date,format){var options=this.lookup("date");if(!options)return date.toString();options.meridian=options.meridian||["AM","PM"];var weekDay=date.getDay(),day=date.getDate(),year=date.getFullYear(),month=date.getMonth()+1,hour=date.getHours(),hour12=hour,meridian=hour>11?1:0,secs=date.getSeconds(),mins=date.getMinutes(),offset=date.getTimezoneOffset(),absOffsetHours=Math.floor(Math.abs(offset/60)),absOffsetMinutes=Math.abs(offset)-absOffsetHours*60,timezoneoffset=(offset>0?"-":"+")+(absOffsetHours.toString().length<2?"0"+absOffsetHours:absOffsetHours)+(absOffsetMinutes.toString().length<2?"0"+absOffsetMinutes:absOffsetMinutes);hour12>12?hour12-=12:hour12===0&&(hour12=12);var padding=function(n){var s="0"+n.toString();return s.substr(s.length-2)},f=format;return f=f.replace("%a",options.abbr_day_names[weekDay]),f=f.replace("%A",options.day_names[weekDay]),f=f.replace("%b",options.abbr_month_names[month]),f=f.replace("%B",options.month_names[month]),f=f.replace("%d",padding(day)),f=f.replace("%e",day),f=f.replace("%-d",day),f=f.replace("%H",padding(hour)),f=f.replace("%-H",hour),f=f.replace("%I",padding(hour12)),f=f.replace("%-I",hour12),f=f.replace("%m",padding(month)),f=f.replace("%-m",month),f=f.replace("%M",padding(mins)),f=f.replace("%-M",mins),f=f.replace("%p",options.meridian[meridian]),f=f.replace("%S",padding(secs)),f=f.replace("%-S",secs),f=f.replace("%w",weekDay),f=f.replace("%y",padding(year)),f=f.replace("%-y",padding(year).replace(/^0+/,"")),f=f.replace("%Y",year),f=f.replace("%z",timezoneoffset),f},I18n.toNumber=function(number,options){options=this.prepareOptions(options,this.lookup("number.format"),{precision:3,separator:".",delimiter:",",strip_insignificant_zeros:!1});var negative=number<0,string=Math.abs(number).toFixed(options.precision).toString(),parts=string.split("."),precision,buffer=[],formattedNumber;number=parts[0],precision=parts[1];while(number.length>0)buffer.unshift(number.substr(Math.max(0,number.length-3),3)),number=number.substr(0,number.length-3);formattedNumber=buffer.join(options.delimiter),options.precision>0&&(formattedNumber+=options.separator+parts[1]),negative&&(formattedNumber="-"+formattedNumber);if(options.strip_insignificant_zeros){var regex={separator:new RegExp(options.separator.replace(/\./,"\\.")+"$"),zeros:/0+$/};formattedNumber=formattedNumber.replace(regex.zeros,"").replace(regex.separator,"")}return formattedNumber},I18n.toCurrency=function(number,options){return options=this.prepareOptions(options,this.lookup("number.currency.format"),this.lookup("number.format"),{unit:"$",precision:2,format:"%u%n",delimiter:",",separator:"."}),number=this.toNumber(number,options),number=options.format.replace("%u",options.unit).replace("%n",number),number},I18n.toHumanSize=function(number,options){var kb=1024,size=number,iterations=0,unit,precision;while(size>=kb&&iterations<4)size/=kb,iterations+=1;return iterations===0?(unit=this.t("number.human.storage_units.units.byte",{count:size}),precision=0):(unit=this.t("number.human.storage_units.units."+[null,"kb","mb","gb","tb"][iterations]),precision=size-Math.floor(size)===0?0:1),options=this.prepareOptions(options,{precision:precision,format:"%n%u",delimiter:""}),number=this.toNumber(size,options),number=options.format.replace("%u",unit).replace("%n",number),number},I18n.toPercentage=function(number,options){return options=this.prepareOptions(options,this.lookup("number.percentage.format"),this.lookup("number.format"),{precision:3,separator:".",delimiter:""}),number=this.toNumber(number,options),number+"%"},I18n.pluralizer=function(locale){return pluralizer=this.pluralizationRules[locale],pluralizer!==undefined?pluralizer:this.pluralizationRules.en},I18n.findAndTranslateValidNode=function(keys,translation){for(i=0;i<keys.length;i++){key=keys[i];if(this.isValidNode(translation,key))return translation[key]}return null},I18n.pluralize=function(count,scope,options){var translation;try{translation=this.lookup(scope,options)}catch(error){}if(!translation)return this.missingTranslation(scope);var message;return options=this.prepareOptions(options),options.count=count.toString(),pluralizer=this.pluralizer(this.currentLocale()),key=pluralizer(Math.abs(count)),keys=typeof key=="object"&&key instanceof Array?key:[key],message=this.findAndTranslateValidNode(keys,translation),message==null&&(message=this.missingTranslation(scope,keys[0])),this.interpolate(message,options)},I18n.missingTranslation=function(){var message='[missing "'+this.currentLocale(),count=arguments.length;for(var i=0;i<count;i++)message+="."+arguments[i];return message+='" translation]',message},I18n.currentLocale=function(){return I18n.locale||I18n.defaultLocale},I18n.t=I18n.translate,I18n.l=I18n.localize,I18n.p=I18n.pluralize;var I18n=I18n||{};I18n.addTranslations({en:{js:{common:{loading:"Loading",stock:"Stock",unstock:"Unstock",submit:"Submit",cancel:"Cancel",comment:"Comment",comments:"Comments",optional:"Optional",ago:"%{distance_in_words} ago",follow:"Follow",unfollow:"Unfollow",preview:"Preview"}}},ja:{js:{common:{loading:"読み込み中",stock:"ストックする",unstock:"ストック解除",submit:"送信",cancel:"キャンセル",comment:"コメント",comments:"コメント",optional:"任意",ago:"%{distance_in_words}前",follow:"フォローする",unfollow:"フォロー解除",preview:"プレビュー"}}}}),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("models"),namespace.Team=function(_super){function Team(){return Team.__super__.constructor.apply(this,arguments)}var BANNED,PAID,PAYMENT_EXTENSION,SUSPENDED,TRIAL;return __extends(Team,_super),TRIAL=0,PAID=1,PAYMENT_EXTENSION=2,SUSPENDED=3,BANNED=4,Team.prototype._searchResults={},Team.prototype.isTrial=function(){return this.get("status")===TRIAL},Team.prototype.isPaid=function(){return this.get("status")===PAID},Team.prototype.isPaymentExtension=function(){return this.get("status")===PAYMENT_EXTENSION},Team.prototype.isSuspended=function(){return this.get("status")===SUSPENDED},Team.prototype.isBanned=function(){return this.get("status")===BANNED},Team.prototype.search=function(rawQuery){var dfd;return this._searchResults[rawQuery]?(dfd=$.Deferred(),dfd.resolve(this._searchResults[rawQuery]),dfd.promise()):$.getJSON("/search",{q:rawQuery,sort:"rel"}).done(function(_this){return function(results){return _this._searchResults[rawQuery]=results}}(this))},Team.prototype.createdAtInTime=function(){return this.has("created_at")?this.get("created_at").getTime():null},Team}(Backbone.Model)}.call(this),function(global,_,Backbone){var Qiita=global.Qiita;Backbone.sync_orig=Backbone.sync,Backbone.sync=function(method,model,opts){var name=model.constructor.name;return console.debug(name,"METHOD:",method,"URL:",_.result(model,"url")),Backbone.sync_orig(method,model,opts)},global.onerror=function(msg,url){var reg=new RegExp("^"+location.protocol+"//"+location.host);reg.test(url)&&(console.debug("Exception:",msg),window.ga&&ga("send","exception",{exDesctiption:msg}),_.freeAll())},Qiita.DEBUG==null&&(Qiita.DEBUG=/qiita\.dev$/.test(document.domain));var hostname=location.hostname;if(!/192\.168\.\d{1,3}\.\d{1,3}/.test(hostname)){var teamName=hostname.split(".")[0];_.contains(["qiita","staging","127","career","teams"],teamName)||(Qiita.teamName=teamName)}var TLD=hostname.split(".");Qiita.TLD=TLD[TLD.length-1],key.filter=function(event){var tagName=(event.target||event.srcElement).tagName;return tagName!="SELECT"},Qiita.teamAttrs&&(Qiita.currentTeam=new Qiita.models.Team(Qiita.teamAttrs)),Qiita.getIsTeamLandingPage=function(){return Qiita.isTeamLandingPage=Qiita.isTeamLandingPage||$(document.body).hasClass("js-is-team-landing-page")},Qiita.getIsTeamPage=function(){return Qiita.isTeamPage=Qiita.isTeamPage||$(document.body).hasClass("js-is-team-page")}}(this,_,Backbone),function(){var location,strategies;location=ns("location"),strategies=[{match:/^\/(public|mine|stock)?$/,type:function(match){return match[1]?"home":"/"},id:function(match){return match[1]?match[1]:"/"},detail:function(match){return match[1]?void 0:"/"}},{match:/^\/(about|asct|admin|docs|explorer|features|logout|pricing|registered|registration|settings|tags|templates|terms|privacy|organizations)(?:\/([^\/]+)(?:\/([^\/]+))?)?$/,type:1,id:2,detail:3},{match:/^\/advent-calendar(?:\/([^\/]+)(?:\/([^\/]+)(?:\/([^\/]+))?)?)?$/,type:"advent_calendars",id:function(match){return match[1]?match[2]==="new"?"new":match[2]===void 0?match[1]:""+match[1]+"-"+match[2]:void 0},detail:3},{match:/^\/drafts\/([^\/]+)(\/edit)?$/,type:"items",id:1,detail:function(match){return match[1]==="new"?void 0:match[2]?"edit":"show_at_drafts"}},{match:/^\/(?:[^\/]+)\/items\/(\w+)(?:\/([^\/]+)(?:\/[^\/]+)?)?$/,type:"items",id:1,detail:2},{match:/^\/([^\/]+)(?:\/([^\/]+))?$/,type:"users",id:1,detail:2}],location.reset=function(){var match,pathname,prop,strategy,type,_i,_j,_len,_len1,_ref,_results;pathname=window.location.pathname,_results=[];for(_i=0,_len=strategies.length;_i<_len;_i++){strategy=strategies[_i];if(!(match=pathname.match(strategy.match)))continue;_ref=["type","id","detail"];for(_j=0,_len1=_ref.length;_j<_len1;_j++)type=_ref[_j],prop=strategy[type],location["page"+_.capitalize(type)]=_.isNumber(prop)?match[prop]||void 0:_.isString(prop)?prop:_.isFunction(prop)?prop(match)||void 0:void 0;break}return _results},location.reset()}.call(this),function(){var namespace;namespace=ns("util"),namespace.distinctId=function(){return Qiita.user?Qiita.user.id:void 0}}.call(this),function(){var location,namespace,util;namespace=ns("analysis"),location=Qiita.location,util=Qiita.util,namespace.mixpanel=function(event_name,func){return func==null&&(func=function(){}),function(props){var default_props,dfd;return props==null&&(props={}),dfd=$.Deferred(),default_props={distinct_id:util.distinctId(),page:location.pageType,page_id:location.pageId,page_detail:location.pageDetail,team_name:Qiita.teamName},props=_.defaults(func(props)||{},default_props),props.event_name&&(event_name=props.event_name,delete props.event_name),console.debug("START","Mixpanel",event_name,props),Qiita.isMixpanelAvailable===!0?mixpanel.track(event_name,props,function(){return console.debug("DONE","Mixpanel",event_name,props),dfd.resolve()}):Qiita.isMixpanelAvailable===!1?(console.warn("FAIL","Mixpanel",event_name,props),dfd.reject()):(mixpanel.track(event_name,props,function(){return Qiita.isMixpanelAvailable=!0,console.debug("DONE","Mixpanel",event_name,props),dfd.resolve()}),dfd.fail(function(){return Qiita.isMixpanelAvailable=!1,console.warn("FAIL","Mixpanel",event_name,props)}),setTimeout(function(){return dfd.reject()},2e3)),dfd.promise()}},namespace.analytics=function(category,action,func){return func==null&&(func=function(props){return props}),function(props){var dfd;return props==null&&(props={}),dfd=$.Deferred(),props=func(props),props.eventCategory==null&&(props.eventCategory=category),props.eventAction==null&&(props.eventAction=action),props.nonInteraction=!0,console.debug("START","Analytics",category,action,props),Qiita.isAnalyticsAvailable===!0?(props.hitCallback=function(){return console.debug("DONE","Analytics",category,action,props),dfd.resolve()},ga("send","event",props)):Qiita.isAnalyticsAvailable===!1?(console.warn("FAIL","Analytics",category,action,props),dfd.reject()):(props.hitCallback=function(){return Qiita.isAnalyticsAvailable=!0,console.debug("DONE","Analytics",category,action,props),dfd.resolve()},ga("send","event",props),dfd.fail(function(){return Qiita.isAnalyticsAvailable=!1,console.warn("FAIL","Analytics",category,action,props)}),setTimeout(function(){return dfd.reject()},2e3)),dfd.promise()}},namespace.wrap=function(trackers){return function(props){var dfd;return dfd=$.Deferred(),$.when.apply($,_.map(trackers,function(tracker){return tracker(props)})).done(function(){return dfd.resolve()}).fail(function(){return dfd.reject()}),dfd.promise()}}}.call(this),function(){var namespace;namespace=ns("analysis"),namespace.clickAdvertisement=namespace.wrap([namespace.mixpanel("Advertisement Click",function(props){return{logged_in:!!Qiita.user,place:props.place,ad_id:props.adId,type:props.type}}),namespace.analytics("Advertisement","Click",function(props){return{eventLabel:props.adId}})])}.call(this),function(){var namespace;namespace=ns("analysis"),namespace.clickNews=namespace.mixpanel("Click news",function(props){return{logged_in:!!Qiita.user}})}.call(this),function(){var namespace;namespace=ns("analysis"),namespace.formSubmit=namespace.wrap([namespace.mixpanel(null,function(props){return{event_name:props.event_name}}),namespace.analytics("Form","Submit",function(props){return{eventLabel:props.event_name}})])}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty;namespace=ns("analysis"),namespace.linkClick=namespace.wrap([namespace.mixpanel("Click a link",function(props){var key,result,val;result={};for(key in props){if(!__hasProp.call(props,key))continue;val=props[key],result[key.replace("__"," ")]=val}return result}),namespace.analytics("Link","Click",function(props){return{eventLabel:props.label||props.event_name}})])}.call(this),function(){var namespace;namespace=ns("analysis"),namespace.search=namespace.mixpanel("Search",function(props){return{logged_in:!!Qiita.user,stocked:props.stocked,keyword:props.keyword}})}.call(this),function(){var namespace;namespace=ns("analysis"),namespace.showAdvertisement=namespace.analytics("Advertisement","Show",function(props){return{eventLabel:props.adId}})}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.DropdownNavView=function(_super){function DropdownNavView(){return DropdownNavView.__super__.constructor.apply(this,arguments)}return __extends(DropdownNavView,_super),DropdownNavView.prototype.shown=!1,DropdownNavView.prototype.events={"click .js-dropdownSurface":"onClickSurface",click:function(e){return e.originalEvent[this.cid]=!0}},DropdownNavView.prototype.initialize=function(){return this.listenTo(Backbone,"click",function(e){var _ref;if((_ref=e.originalEvent)!=null?!_ref[this.cid]:!void 0)return this.hideContainer()})},DropdownNavView.prototype.onClickSurface=function(e){return this.shown?this.hideContainer():this.showContainer()},DropdownNavView.prototype.showContainer=function(){return this.shown=!0,this.$el.addClass("active"),this.$el.addClass("open")},DropdownNavView.prototype.hideContainer=function(){return this.shown=!1,this.$el.removeClass("active")},DropdownNavView}(Backbone.View)}.call(this),function(){_.extend(ns("config"),{INIT_FETCH_INTERVAL:18e4})}.call(this);var I18n=I18n||{};I18n.addTranslations({en:{js:{templates:{notification:{"public":{accept_patch:' <span class="bold">accepted</span> your edit request.',comment_mention:'<span class="bold">mentioned</span> you in a comment to the post <span class="title">%{title}</span>.',follow_user:'is <span class="bold">following</span> you.',item_mention:'<span class="bold">mentioned</span> you in the post <span class="title">%{title}</span>.',new_comment_for_stocker:'<span class="bold">commented</span> at the post <span class="title">%{title}</span> you stocked.',lgtm:'<span class="bold">liked</span> your post <span class="title">%{title}</span>.',refer_to_public_article:' linked to your post in the post <span class="title">%{title}</span>.',receive_patch:' sent an <span class="bold">edit request</span> to your post <span class="title">%{title}</span>.',reply:'<span class="bold">commented</span> to your post <span class="title">%{title}</span>.',stock:'<span class="bold">stocked</span> your post <span class="title">%{title}</span>.',stocked_item_update:'<span class="bold">updated</span> the post <span class="title">%{title}</span> you stocked.',update_posted_chunk:'<span class="bold">commented</span> to a post <span class="title">%{title}</span> you commented.',invite_advent_calendar:'<span class="bold">invited</span> to the <span class="title">%{title}</span> advent calendar.',post_advent_calendar_item:'<span class="bold">posted</span> to the <span class="title">%{title}</span> advent calendar.',remind_advent_calendar:'%{date} is <span class="bold">your turn</span> for the <span class="title">%{title}</span> advent calendar.',tweet:{one:'Your post <span class="title">%{title}</span> was <span class="bold">tweeted</span> on Twitter.',other:'Your post <span class="title">%{title}</span> was <span class="bold">tweeted</span> %{count} times on Twitter.'},like:{one:'Your post <span class="title">%{title}</span> was <span class="bold">liked</span> on Facebook.',other:'Your post <span class="title">%{title}</span> was <span class="bold">liked</span> %{count} times on Facebook.'},thanked:'<span class="bold">thanked</span> your comment.',other:"did something."},team:{accept_patch:' <span class="bold">accepted</span> your edit request in %{team_name} team.',comment_mention:'<span class="bold">mentioned</span> you in a comment to the post <span class="title">%{title}</span> in %{team_name} team.',item_mention:'<span class="bold">mentioned</span> you in the post <span class="title">%{title}</span> in %{team_name} team.',new_comment_for_stocker:'<span class="bold">commented</span> at the post <span class="title">%{title}</span> you stocked at %{team_name} team.',lgtm:'<span class="bold">liked</span> your post <span class="title">%{title}</span> in %{team_name} team',receive_patch:' sent an <span class="bold">edit request</span> to your post <span class="title">%{title}</span> in %{team_name} team',reply:'<span class="bold">commented</span> to your post <span class="title">%{title}</span> in %{team_name} team.',stock:'<span class="bold">stocked</span> your post <span class="title">%{title}</span> in %{team_name} team.',stocked_item_update:'<span class="bold">updated</span> the post <span class="title">%{title}</span> you stocked in %{team_name} team.',update_posted_chunk:'<span class="bold">commented</span> to a post <span class="title">%{title}</span> you commented in %{team_name} team.',update_stocked_chunk:'<span class="bold">commented</span> to your stocked post <span class="title">%{title}</span> in %{team_name} team.',thanked:'<span class="bold">thanked</span> your comment in %{team_name} team.',other:"did something."}}}}},ja:{js:{templates:{notification:{"public":{accept_patch:'があなたの編集リクエストを<span class="bold">採用</span>しました。',comment_mention:'が<span class="title">%{title}</span>のコメントで<span class="bold">メンション</span>しました。',follow_user:'があなたを<span class="bold">フォロー</span>しました。',item_mention:'が<span class="title">%{title}</span>で<span class="bold">メンション</span>しました。',new_comment_for_stocker:'があなたのストックした投稿<span class="title">%{title}</span>で<span class="bold">コメント</span>しました。',lgtm:'があなたの投稿<span class="title">%{title}</span>に<span class="bold">いいね!</span>しました。',refer_to_public_article:'が投稿<span class="title">%{title}</span>であなたの投稿を<span class="bold">リンク</span>しました。',receive_patch:'があなたの投稿<span class="title">%{title}</span>へ<span class="bold">編集リクエスト</span>を送りました。',reply:'があなたの編集した投稿<span class="title">%{title}</span>に<span class="bold">コメント</span>しました。',stock:'があなたの投稿<span class="title">%{title}</span>を<span class="bold">ストック</span>しました。',stocked_item_update:'があなたのストックした投稿<span class="title">%{title}</span>を<span class="bold">編集</span>しました。',update_posted_chunk:'があなたのコメントした投稿<span class="title">%{title}</span>に<span class="bold">コメント</span>しました。',invite_advent_calendar:'がアドベントカレンダー<span class="title">%{title}</span>に<span class="bold">招待</span>しました。',post_advent_calendar_item:'が<span class="title">%{title}</span>アドベントカレンダーに<span class="bold">投稿</span>しました。',remind_advent_calendar:'%{date}は<span class="title">%{title}</span>アドベントカレンダーの<span class="bold">あなたの担当日</span>です。',tweet:{one:'あなたの投稿<span class="title">%{title}</span>が<span class="bold">ツイート</span>されました。',other:'あなたの投稿<span class="title">%{title}</span>が%{count}回<span class="bold">ツイート</span>されました。'},like:{one:'あなたの投稿<span class="title">%{title}</span>が<span class="bold">いいね</span>されました。',other:'あなたの投稿<span class="title">%{title}</span>が%{count}回<span class="bold">いいね</span>されました。'},thanked:'があなたのコメントに <span class="bold">Thank!</span> と言っています。',other:"が何かしました。"},team:{accept_patch:'が%{team_name}のあなたの編集リクエストを<span class="bold">採用</span>しました。',comment_mention:'が%{team_name}の<span class="title">%{title}</span>のコメントで<span class="bold">メンション</span>しました。',item_mention:'が%{team_name}の<span class="title">%{title}</span>で<span class="bold">メンション</span>しました。',new_comment_for_stocker:'が%{team_name}であなたのストックした投稿<span class="title">%{title}</span>で<span class="bold">コメント</span>しました。',lgtm:'が%{team_name}のあなたの投稿<span class="title">%{title}</span>に<span class="bold">いいね!</span>しました。',receive_patch:'が%{team_name}のあなたの投稿<span class="title">%{title}</span>へ<span class="bold">編集リクエスト</span>を送りました。',reply:'が%{team_name}のあなたの編集した投稿<span class="title">%{title}</span>に<span class="bold">コメント</span>しました。',stock:'が%{team_name}のあなたの投稿<span class="title">%{title}</span>を<span class="bold">ストック</span>しました。',stocked_item_update:'が%{team_name}チームであなたのストックした投稿<span class="title">%{title}</span>を<span class="bold">編集</span>しました。',update_posted_chunk:'が%{team_name}のあなたのコメントした投稿<span class="title">%{title}</span>に<span class="bold">コメント</span>しました。',update_stocked_chunk:'が%{team_name}のあなたのストックした投稿<span class="title">%{title}</span>に<span class="bold">コメント</span>しました。',thanked:'が%{team_name}のあなたのコメントに <span class="bold">Thank!</span> と言っています。',other:"が何かしました。"}}}}}});var I18n=I18n||{};I18n.addTranslations({en:{js:{templates:{stream:{search_form:{stock:"Search from stocked items",mine:"Search from your items"},fail_to_fetch:{fail_to_fetch_html:"Fail to fetch the feed. <br />\nPlease reload and try again."}}}}},ja:{js:{templates:{stream:{search_form:{stock:"ストック検索",mine:"自分の投稿の中から検索"},fail_to_fetch:{fail_to_fetch_html:"フィードの読み込みに失敗しました。<br />\n画面の再読み込みをお試しください。"}}}}}}),function(){this.JST||(this.JST={}),this.JST["t/notification"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{}){__p.push("");var scope,title,user,src;scope="js.templates.notification."+(notice.team_name?"team.":"public."),scope+=_.contains(["accept_patch","comment_mention","follow_user","item_mention","new_comment_for_stocker","lgtm","receive_patch","refer_to_public_article","reply","stock","stocked_item_update","update_posted_chunk","tweet","like","invite_advent_calendar","post_advent_calendar_item","remind_advent_calendar","thanked"],notice.action)?notice.action:"other",title=notice.short_title?'"'+notice.short_title+'"':"",_.contains(["tweet","like"],notice.action)||(user=notice.users[0]),user&&(src=user.profile_image_url),__p.push('\n<li class="globalNotificationContents_listItem">\n  <a href="',(""+notice.object).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" class="globalNotificationContents_itemLink',notice.seen?"":"-unread",'">\n      <div class="globalNotificationContents_itemIcon">\n        '),notice.action=="tweet"?__p.push('\n          <i class="fa fa-twitter-square"></i>\n        '):notice.action=="like"?__p.push('\n          <i class="fa fa-facebook-square"></i>\n        '):__p.push('\n          <img src="',src,'"/>\n        '),__p.push('\n      </div>\n      <div class="globalNotificationContents_itemText">\n        '),user&&notice.is_action_by_others&&__p.push('\n          <span class="bold">\n            ',_.map(notice.users,function(user){return user.url_name}).join(", "),"\n          </span>\n        "),__p.push("\n        ",I18n.t(scope,{title:title,team_name:notice.team_name,date:notice.date,count:notice.count}),'\n        <div class="status">\n          ',I18n.t("js.common.ago",{distance_in_words:notice.created_at_in_words}),"\n        </div>\n      </div>\n  </a>\n</li>\n")}return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["t/stream/circle-loading"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="circle-loading">\n  <p>',I18n.t("js.common.loading"),"</p>\n  <div>\n    <div/>\n    <div/>\n    <div/>\n  </div>\n</div>\n");return __p.join("")}}.call(this),function(){var namespace,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.NotificationView=function(_super){function NotificationView(){return this.checkUnreadCount=__bind(this.checkUnreadCount,this),NotificationView.__super__.constructor.apply(this,arguments)}return __extends(NotificationView,_super),NotificationView.prototype.count=null,NotificationView.prototype.isFirstFetch=!0,NotificationView.prototype.interval=Qiita.config.INIT_FETCH_INTERVAL,NotificationView.prototype.initialize=function(){return NotificationView
.__super__.initialize.apply(this,arguments),this.renderCount(Qiita.user.unreadNotificationsCount)},NotificationView.prototype.renderCount=function(count){return this.$counter==null&&(this.$counter=this.$(".js-globalNotification_count")),this.count=count,this.$counter.text(this.count),this.count>0?this.$counter.addClass("unchecked"):this.$counter.removeClass("unchecked")},NotificationView.prototype.renderNotifications=function(notifications,renderAll){var notification,_i,_len,_ref,_results;_ref=_.sortBy(notifications,"created_at"),_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++)notification=_ref[_i],renderAll||!notification.seen?_results.push(this.$list.prepend(JST["t/notification"]({notice:notification}))):_results.push(void 0);return _results},NotificationView.prototype.showContainer=function(){NotificationView.__super__.showContainer.apply(this,arguments);if(this.count||this.isFirstFetch)return this.fetchNotifications()},NotificationView.prototype.hideContainer=function(){return NotificationView.__super__.hideContainer.apply(this,arguments),this.$(".unread").removeClass("unread")},NotificationView.prototype.checkUnreadCount=function(){return $.ajax({url:"/api/notifications/count",dataType:"json"}).done(function(_this){return function(data){return _this.interval=Qiita.config.INIT_FETCH_INTERVAL,_this.renderCount(data.count)}}(this)).fail(function(_this){return function(){return _this.interval*=2}}(this)).always(function(_this){return function(){return setTimeout(_this.checkUnreadCount,_this.interval)}}(this))},NotificationView.prototype.fetchNotifications=_.lock(function(free){var el;return el=$(JST["t/stream/circle-loading"]()),this.$list==null&&(this.$list=this.$(".js-globalNotification_list")),this.$list.prepend(el),$.ajax({url:"/api/notifications",dataType:"json"}).done(function(_this){return function(notifications){return el.remove(),_this.renderNotifications(notifications,_this.isFirstFetch),_this.isFirstFetch=!1,$.ajax({url:"/api/notifications/read"}).done(function(){return _this.renderCount(0)}),free()}}(this))}),NotificationView}(namespace.DropdownNavView)}.call(this),function(){this.JST||(this.JST={}),this.JST["t/search_form/incremental_search_result"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="incrementalSearchResult js-searchResult">\n  <a href="',url,'">\n    <span class="incrementalSearchResult_title">\n      '),type=="ProjectPage"?__p.push('\n        <i class="fa fa-flag incrementalSearchResult_projectIcon"></i>\n      '):__p.push('\n        <img src="',user.profile_image_url,'" class="incrementalSearchResult_userIcon">\n      '),__p.push("\n      ",title,'\n    </span>\n    <i class="fa fa-angle-right incrementalSearchResult_arrow"></i>\n  </a>\n</div>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["t/search_form/incremental_search_more_results"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="incrementalSearchResult-moreResults js-searchResultMorePage">\n  <a href="#" class="js-incremental-search-more-results">\n    <span class="incrementalSearchResult_title">\n       ',I18n.t("js.templates.search_form.more_results"),"\n    </span>\n  </a>\n</div>\n");return __p.join("")}}.call(this);var I18n=I18n||{};I18n.addTranslations({en:{js:{templates:{search_form:{more_results:"More results"}}}},ja:{js:{templates:{search_form:{more_results:"もっと見る"}}}}}),function(){var namespace,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.IncrementalSearchResultsView=function(_super){function IncrementalSearchResultsView(){return this.render=__bind(this.render,this),IncrementalSearchResultsView.__super__.constructor.apply(this,arguments)}var MAX_DISPLAYED_RESULT_COUNT;return __extends(IncrementalSearchResultsView,_super),MAX_DISPLAYED_RESULT_COUNT=5,IncrementalSearchResultsView.prototype.shown=!1,IncrementalSearchResultsView.prototype.currentValue=null,IncrementalSearchResultsView.prototype.$activeEl=null,IncrementalSearchResultsView.prototype.events={"mouseover .js-searchResult":"activateHoveredResult","mouseover .js-searchResultMorePage":"activateHoveredResult","click .js-searchResultMorePage":"openSearchResultPage"},IncrementalSearchResultsView.prototype.search=_.lockAndFinallyReplayLastInvocation(function(free,value){return value=this.normalize(value),this.currentValue===value?free():(this.currentValue=value,this.trigger("start"),Qiita.currentTeam.search(value).done(this.render).always(function(_this){return function(){return _this.trigger("complete"),free()}}(this)))}),IncrementalSearchResultsView.prototype.hide=function(){if(this.shown)return this.shown=!1,this.currentValue=null,this.$el.hide()},IncrementalSearchResultsView.prototype.up=function(){var $el,_ref;if(!this.shown)return;return this.$activeEl=this.$activeEl?(this.$activeEl.removeClass("active"),$el=this.$activeEl.prev(),$el.length?$el:null):this.$el.children(":last-child"),(_ref=this.$activeEl)!=null?_ref.addClass("active"):void 0},IncrementalSearchResultsView.prototype.down=function(){var $el,_ref;if(!this.shown)return;return this.$activeEl=this.$activeEl?(this.$activeEl.removeClass("active"),$el=this.$activeEl.next(),$el.length?$el:null):this.$el.children(":first-child"),(_ref=this.$activeEl)!=null?_ref.addClass("active"):void 0},IncrementalSearchResultsView.prototype.select=function(e){if(this.shown&&this.$activeEl)return e.preventDefault(),this.$activeEl.find(".js-incremental-search-more-results").length===0?location.href=this.$activeEl.find("a").prop("href"):$(".js-globalSearchForm_submitBtn").click()},IncrementalSearchResultsView.prototype.render=function(results){var html;return results.length?(this.shown=!0,html=_.map(_.first(results,MAX_DISPLAYED_RESULT_COUNT),function(result){return JST["t/search_form/incremental_search_result"](result)}),results.length>MAX_DISPLAYED_RESULT_COUNT&&html.push(JST["t/search_form/incremental_search_more_results"]()),this.$el.html(html.join("")).show()):this.hide()},IncrementalSearchResultsView.prototype.activateHoveredResult=function(e){var _ref;return(_ref=this.$activeEl)!=null&&_ref.removeClass("active"),this.$activeEl=$(e.currentTarget).addClass("active")},IncrementalSearchResultsView.prototype.normalize=function(value){return _.compact(value.split(/\s+/)).join(" ")},IncrementalSearchResultsView.prototype.openSearchResultPage=function(e){return e.preventDefault(),$(".js-globalSearchForm_submitBtn").click()},IncrementalSearchResultsView}(Backbone.View)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.SearchHelperView=function(_super){function SearchHelperView(){return SearchHelperView.__super__.constructor.apply(this,arguments)}return __extends(SearchHelperView,_super),SearchHelperView.prototype.shown=!1,SearchHelperView.prototype.setQueries=function(_arg){var tags,users;return users=_arg.users,tags=_arg.tags,this.$(".js-user-query").val(users.join(" ")),this.$(".js-tag-query").val(tags.join(" ")),this},SearchHelperView.prototype.getQueries=function(){var tags,users;return users=this.$(".js-user-query").val().split(/\s|,/g).filter(function(user){return user.length>0}),tags=this.$(".js-tag-query").val().split(/\s|,/g).filter(function(tag){return tag.length>0}),{users:users,tags:tags}},SearchHelperView.prototype.show=function(){if(!this.shown)return this.shown=!0,this.trigger("shown"),this.$el.show(),_.defer(function(_this){return function(){return _this.$(".js-user-query").focus()}}(this))},SearchHelperView.prototype.hide=function(){if(this.shown)return this.shown=!1,this.trigger("hidden"),this.$el.fadeOut(200)},SearchHelperView}(Backbone.View)}.call(this),function(){var namespace;namespace=ns("util"),namespace.buildQuery=function(rawQuery,users,tags){var result,tagExpression;return tagExpression=tags.map(function(tag){return"tag:"+tag}).join(" "),result=users.length>0?users.map(function(user){return rawQuery+" user:"+user+" "+tagExpression}).join(" or "):rawQuery+" "+tagExpression,/^\s+$/.test(result)?"":result},namespace.parseQuery=function(rawQuery){var g,group,key,keys,raws,tags,users;keys=rawQuery.split(/\s|,/g),group=_.groupBy(keys,function(i){return i.split(":")[0]}),tags=[],users=[],raws=[];for(key in group)g=group[key],key.length>0&&(key==="tag"?tags=g.map(function(expr){return expr.replace("tag:","")}):key==="user"?users=g.map(function(expr){return expr.replace("user:","")}):raws.push.apply(raws,g));return{users:users,tags:tags,raws:raws}}}.call(this),function(){var buildQuery,namespace,parseQuery,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),_ref=Qiita.util,buildQuery=_ref.buildQuery,parseQuery=_ref.parseQuery,namespace.SearchFormView=function(_super){function SearchFormView(){return SearchFormView.__super__.constructor.apply(this,arguments)}var CLICK_EVENT;return __extends(SearchFormView,_super),CLICK_EVENT="clickSearchForm",SearchFormView.prototype.el="form.js-globalSearchForm",SearchFormView.prototype.events={submit:"onSubmit","focus .js-globalSearchForm_query":"onFocusQueryForm","focusout .js-globalSearchForm_query":"onFocusOutQueryForm","keyup .js-globalSearchForm_query":"onKeyupQueryForm","click .js-wise-search":"toggleSearchHelper",click:"onClick"},SearchFormView.prototype.shortcuts={"up globalSearchForm":"selectPrevResult","ctrl+p globalSearchForm":"selectPrevResult","down globalSearchForm":"selectNextResult","ctrl+n globalSearchForm":"selectNextResult","enter globalSearchForm":"moveToSelectedResult","ctrl+m globalSearchForm":"moveToSelectedResult"},SearchFormView.prototype.initialize=function(){return this.$query=this.$(".js-globalSearchForm_query"),this.listenTo(Backbone,"click",function(ev){if(!ev.originalEvent||!ev.originalEvent[CLICK_EVENT])return this.hidePanels()})},SearchFormView.prototype.onClick=function(ev){if(ev.originalEvent)return ev.originalEvent[CLICK_EVENT]=!0},SearchFormView.prototype.onFocusQueryForm=function(){return this.activateIfNeeded(),key.setScope("globalSearchForm")},SearchFormView.prototype.onFocusOutQueryForm=function(){return key.setScope("all")},SearchFormView.prototype.onKeyupQueryForm=function(){var _ref1;if(!this.searchHelperView.shown)return(_ref1=this.incrementalSearchView)!=null?_ref1.search(this.$query.val()):void 0},SearchFormView.prototype.onSubmit=function(ev){if(!this.submitting)return ev.preventDefault(),this.searchHelperView.hide(),Qiita.analysis.search({stocked:!!this.$(".js-stock-only").attr("checked"),keyword:this.$query.val()}).always(function(_this){return function(){return _this.submitting=!0,_this.$el.submit()}}(this))},SearchFormView.prototype.activateIfNeeded=_.once(function(){return this.$query.animate({width:230,duration:100}),this.startSearchHelper(),Qiita.currentTeam&&this.startIncrementalSearch(),this.$(".js-globalSearchForm_submitBtn").addClass("show"),$(".headerNews").hide()}),SearchFormView.prototype.startIncrementalSearch=function(){return this.incrementalSearchView=new Qiita.views.IncrementalSearchResultsView({el:this.$(".js-globalSearchForm_incrementalSearchResults")}),this.listenTo(this.incrementalSearchView,"start",function(){return this.$el.addClass("searching")}),this.listenTo(this.incrementalSearchView,"complete",function(){return this.$el.removeClass("searching")}),_.extend(this,Backbone.Shortcuts.prototype),this.delegateShortcuts()},SearchFormView.prototype.startSearchHelper=function(){return this.$(".js-wise-search").css({visibility:"visible"}),this.searchHelperView=new Qiita.views.SearchHelperView({el:this.$(".js-globalSearchForm_stockedSearch")}),this.listenTo(this.searchHelperView,"shown",this.updateHelper),this.listenTo(this.searchHelperView,"hidden",this.updateQuery)},SearchFormView.prototype.hidePanels=function(){var _ref1,_ref2;return(_ref1=this.searchHelperView)!=null&&_ref1.hide(),(_ref2=this.incrementalSearchView)!=null?_ref2.hide():void 0},SearchFormView.prototype.toggleSearchHelper=function(){var _ref1;return this.searchHelperView.shown?this.searchHelperView.hide():((_ref1=this.incrementalSearchView)!=null&&_ref1.hide(),this.searchHelperView.show())},SearchFormView.prototype.updateQuery=function(){var tags,users,_ref1;return _ref1=this.searchHelperView.getQueries(),users=_ref1.users,tags=_ref1.tags,this.$query.val(buildQuery(this.$query.val(),users,tags))},SearchFormView.prototype.updateHelper=function(){var raws,tags,users,_ref1;return _ref1=parseQuery(this.$query.val()),users=_ref1.users,tags=_ref1.tags,raws=_ref1.raws,this.searchHelperView.setQueries({users:users,tags:tags}),this.$query.val(raws.join(" "))},SearchFormView.prototype.selectPrevResult=function(e){var _ref1;return e.preventDefault(),(_ref1=this.incrementalSearchView)!=null?_ref1.up():void 0},SearchFormView.prototype.selectNextResult=function(e){var _ref1;return e.preventDefault(),(_ref1=this.incrementalSearchView)!=null?_ref1.down():void 0},SearchFormView.prototype.moveToSelectedResult=function(e){var _ref1;return(_ref1=this.incrementalSearchView)!=null?_ref1.select(e):void 0},SearchFormView}(Backbone.View)}.call(this),function(){this.JST||(this.JST={}),this.JST["t/modal"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="modal-backdrop fade in"></div>\n<div class="modal fade in" style="display: block;">\n  <div class="modal-dialog">\n    <div class="modal-content">\n      '),source.html?__p.push("\n        ",source.html,"\n      "):(__p.push("\n        "),source.header&&__p.push('\n          <div class="modal-header">\n            ',source.header,"\n          </div>\n        "),__p.push('\n        <div class="modal-body">\n          ',source.body,"\n        </div>\n        "),source.footer&&__p.push('\n          <div class="modal-footer">\n            ',source.footer,"\n          </div>\n        "),__p.push("\n      ")),__p.push("\n    </div>\n  </div>\n</div>\n");return __p.join("")}}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.ModalView=function(_super){function ModalView(){return ModalView.__super__.constructor.apply(this,arguments)}return __extends(ModalView,_super),ModalView.prototype.events=function(){return{"click .modal-backdrop":"onClickDismiss","click .dismiss":"onClickDismiss","click .success":"onSubmit"}},ModalView.prototype.render=function(){return this.$el.html(JST["t/modal"]({source:this.presenter()})),this.$("form").on("submit",_.bind(this.onSubmit,this)),this},ModalView.prototype.initialize=function(options){this.options=options},ModalView.prototype.disablePrimaryButton=function(){return this.$(".btn-primary").addClass("disabled")},ModalView.prototype.enableButtons=function(){return this.$(".btn").removeClass("disabled")},ModalView.prototype.onSubmit=function(e){e.preventDefault(),this.disablePrimaryButton(),this.trigger("success",this);if(!this.options.keepalive)return this.remove()},ModalView.prototype.onClickDismiss=function(){this.trigger("dismiss",this);if(!this.options.keepalive)return this.remove()},ModalView.prototype.presenter=function(){return{html:this.options.html,header:this.options.header,body:this.options.body,footer:this.options.footer}},ModalView.prototype.getValues=function(){return this.$("form").formData()},ModalView}(Backbone.View)}.call(this),function(){var namespace;namespace=ns("analysis"),namespace.clickLoginModal=namespace.wrap([namespace.mixpanel("Click login modal",function(props){return{provider:props.provider,type:props.type}}),namespace.analytics("LoginModal","Click",function(props){return{eventLabel:_.capitalize(props.type)}})])}.call(this),function(){var namespace;namespace=ns("analysis"),namespace.showLoginModal=namespace.wrap([namespace.mixpanel("Show login modal",function(props){return{type:props.type}}),namespace.analytics("LoginModal","Show",function(props){return{eventLabel:_.capitalize(props.type)}})])}.call(this);var I18n=I18n||{};I18n.addTranslations({en:{js:{templates:{login_modal_view:{lead:{stock:"You need to sign up in order to stock this item :)",followUser:"You need to sign up in order to follow %{target} :)",followTag:"You need to sign up in order to follow %{target} tag :)",participate:"You need to sign up in order to join the Advent Calendar.",thank:"You need to sign up in order to thank the comment :)"},signup:"Sign Up",login:"Login",login_with_github:"Login with GitHub",login_with_twitter:"Login with Twitter",or:"or",already_have_account:"If you already have a Qiita account",login_with_password:"Login with password.",goto_login_page:"Goto login page (https)"}}}},ja:{js:{templates:{login_modal_view:{lead:{stock:"Qiita に登録すると投稿をストックできます。<br />ユーザ登録(無料)してお楽しみください :)",followUser:"%{target} をフォローするにはユーザ登録する必要があります。",followTag:"%{target} タグをフォローするにはユーザ登録する必要があります。",participate:"Advent Calendarに参加するにはユーザ登録する必要があります。",thank:"ユーザ登録するとコメントにThankできます:)"},signup:"ユーザ登録(無料)",login:"ログイン",login_with_github:"GitHubでログイン",login_with_twitter:"Twitterでログイン",or:"または",already_have_account:"すでにQiitaアカウントを持っている方は",login_with_password:"パスワードを使ってログインする。",goto_login_page:"ログインページ（https）に移動する"}}}}}),function(){this.JST||(this.JST={}),this.JST["t/login_modal_view"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{}){__p.push("");var namespace="js.templates.login_modal_view.";__p.push("\n");var host=/dev$/.test(location.hostname)?"":"https://"+location.hostname;__p.push("\n");var redirect_to=encodeURIComponent(location.pathname);__p.push("\n");var query="do="+action+"&target="+target+"&redirect_to="+redirect_to;__p.push('\n\n<div class="modal-body text-center loginModal">\n  <span class="close dismiss"><i class="fa fa-times"></i></span>\n  <p class="lead">\n    ',I18n.t(namespace+"lead."+action,{target:target}),'\n  </p>\n  <a href="https://',location.host,"/signup?",query,'" class="btn btn-primary btn-block btn-lg">\n    ',I18n.t(namespace+"signup"),'\n  </a>\n  <div class="lineSeparator">\n    <div class="lineSeparator_text">\n      ',I18n.t(namespace+"or"),'\n    </div>\n  </div>\n  <p class="lead">\n    ',I18n.t(namespace+"already_have_account"),'\n  </p>\n  <div class="row">\n    <span class="col-xs-6">\n      <a href="https://',location.host,"/auth/github?",query,'"\n          class="btn btn-github-inverse btn-block"\n          track="click"\n          data-event_name="Login"\n          data-login__type="GitHub"\n          data-place="login modal">\n        <i class="fa fa-github"></i>\n        ',I18n.t(namespace+"login_with_github"),'\n      </a>\n      <a href="https://',location.host,"/auth/twitter?",query,'"\n          class="btn btn-twitter-inverse btn-block"\n          track="click"\n          data-event_name="Login"\n          data-login__type="Twitter"\n          data-place="login modal">\n        <i class="fa fa-twitter"></i>\n        ',I18n.t(namespace+"login_with_twitter"),'\n      </a>\n    </span>\n    <span class="col-xs-6">\n      <p class="loginModal_loginMessage btn btn-block">',I18n.t(namespace+"login_with_password"),'</p>\n      <a href="https://',location.host,"/login?",query,'" class="btn btn-link btn-block">\n        ',I18n.t(namespace+"goto_login_page"),"\n      </p>\n    </span>\n  </div>\n</div>\n")}return __p.join("")}}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.LoginModalView=function(_super){function LoginModalView(){return LoginModalView.__super__.constructor.apply(this,arguments)}return __extends(LoginModalView,_super),LoginModalView.prototype.events={"click a":"onClickLogin","click .modal-backdrop":"onClickDismiss","click .dismiss":"onClickDismiss","click .success":"onSubmit"},LoginModalView.prototype.initialize=function(options){this.options=options},LoginModalView.prototype.render=function(){return Qiita.analysis.showLoginModal({type:this.options.type}),LoginModalView.__super__.render.apply(this,arguments)},LoginModalView.prototype.onClickLogin=function(e){var $el,href;return e.preventDefault(),$el=$(e.target),href=$el.attr("href"),Qiita.analysis.clickLoginModal({provider:$el.data("provider"),type:this.options.type}).always(function(){return location.href=href})},LoginModalView.prototype.presenter=function(){return{html:JST["t/login_modal_view"]({action:this.options.action,target:this.options.target})}},LoginModalView}(namespace.ModalView)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.ResponsiveButtonView=function(_super){function ResponsiveButtonView(){return ResponsiveButtonView.__super__.constructor.apply(this,arguments)}var textRenderer;return __extends(ResponsiveButtonView,_super),ResponsiveButtonView.prototype.activeClass="btn-primary",ResponsiveButtonView.prototype.deactiveClass="btn-default",textRenderer=function(name){return function(){return I18n.t(""+this.namespace+"."+name)}},ResponsiveButtonView.prototype.namespace="js.views.responsive_button_view",ResponsiveButtonView.prototype.activeText=textRenderer("active"),ResponsiveButtonView.prototype.deactiveText=textRenderer("deactive"),ResponsiveButtonView.prototype.activatingText=textRenderer("activating"),ResponsiveButtonView.prototype.deactivatingText=textRenderer("deactivating"),ResponsiveButtonView.prototype.execute=function(){return this.model.toggleFollowing()},ResponsiveButtonView.prototype.modalSettings={action:null,target:null,type:"ResponsiveButtonView"},ResponsiveButtonView.prototype.isActive=function(){return!this.model.get("following")},ResponsiveButtonView.prototype.bindRenderEvent=function(){return this.listenTo(this.model,"change:following",this.render)},ResponsiveButtonView.prototype.events={click:"onClick"},ResponsiveButtonView.prototype.initialize=function(){return this.bindRenderEvent()},ResponsiveButtonView.prototype.onClick=_.lock(function(free,e){var prevText;return Qiita.user?(prevText=this.$el.text(),this.disable(),this.isActive()?this.showActivatingText():this.showDeactivatingText(),this.execute().always(function(_this){return function(){return _this.enable(),free()}}(this)).fail(function(_this){return function(){return _this.$el.text(prevText)}}(this))):this.showLoginModal?this.showLoginModal(free):free()}),ResponsiveButtonView.prototype.render=function(){return this.isActive()?(this.activeClass&&this.$el.addClass(this.activeClass),this.deactiveClass&&this.$el.removeClass(this.deactiveClass),this.$el.html(_.result(this,"activeText"))):(this.deactiveClass&&this.$el.addClass(this.deactiveClass),this.activeClass&&this.$el.removeClass(this.activeClass),this.$el.html(_.result(this,"deactiveText")))},ResponsiveButtonView.prototype.disable=function(){return this.$el.addClass("disabled")},ResponsiveButtonView.prototype.showDeactivatingText=function(){if(this.deactivatingText)return this.$el.html(_.result(this,"deactivatingText"))},ResponsiveButtonView.prototype.showActivatingText=function(){if(this.activatingText)return this.$el.html(_.result(this,"activatingText"))},ResponsiveButtonView.prototype.enable=function(){return this.$el.removeClass("disabled")},ResponsiveButtonView.prototype.showLoginModal=function(free){var view;return view=new namespace.LoginModalView(_.result(this,"modalSettings")),view.on("dismiss",function(){return free()}),$("body").append(view.render().el)},ResponsiveButtonView}(Backbone.View)}.call(this),function(){var namespace;namespace=ns("analysis"),namespace.favorableActionFactory=function(actionType){return namespace.mixpanel("Favorable Action",function(props){return{"action type":actionType}})}}.call(this),function(){var actionType,namespace;namespace=ns("analysis"),actionType="Follow a tag",namespace.followATag=namespace.wrap([namespace.favorableActionFactory(actionType),namespace.mixpanel(actionType,function(props){return{url_name:props.urlName,place:props.place}}),namespace.analytics("Tag","Follow",function(props){return{eventLabel:_.capitalize(props.place)}})])}.call(this);var I18n=I18n||{};I18n.addTranslations({en:{js:{views:{tags:{follow_button_view:{active:"Follow",deactive:"Following",activating:"Following",deactivating:"Unfollowing"}}}}},ja:{js:{views:{tags:{follow_button_view:{active:"フォローする",deactive:"フォロー中",activating:"フォロー中",deactivating:"フォロー解除中"}}}}}}),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views.tags"),namespace.FollowButtonView=function(_super){function FollowButtonView(){return FollowButtonView.__super__.constructor.apply(this,arguments)}var FOLLOWING_CLASS_NAME;return __extends(FollowButtonView,_super),FOLLOWING_CLASS_NAME="following",FollowButtonView.prototype.events={click:"onClick"},FollowButtonView.prototype.initialize=function(){return this.model=new Qiita.models.Tag({url_name:this.$el.data("url_name"),following:this.$el.hasClass(FOLLOWING_CLASS_NAME)}),this.listenTo(this.model,"change:following",this.render)},FollowButtonView.prototype.onClick=_.lock(function(free,e){return e.preventDefault(),this.$el.find(".btn").prop("disabled","disabled"),Qiita.user?(this.model.toggleFollowing().always(function(_this){return function(){return _this.$el.find(".btn").prop("disabled",!1),free()}}(this)),this.model.get("following")||this.trackFollowEvent()):this.showLoginModal().on("dismiss",function(_this){return function(){return _this.$el.find(".btn").prop("disabled",!1),free()}}(this)),free()}),FollowButtonView.prototype.render=function(){return this.model.get("following")?this.$el.addClass(FOLLOWING_CLASS_NAME):this.$el.removeClass(FOLLOWING_CLASS_NAME)},FollowButtonView.prototype.showLoginModal=function(){var modalView;return modalView=new Qiita.views.LoginModalView({action:"followTag",target:this.$el.data("url_name"),type:"followTag:"+this.$el.data("position")}),$("body").append(modalView.render().el),modalView},FollowButtonView.prototype.trackFollowEvent=function(){return Qiita.analysis.followATag({urlName:this.model.id,place:this.$el.data("position")})},FollowButtonView}(Qiita.views.ResponsiveButtonView)}.call(this),function(){var actionType,namespace;namespace=ns("analysis"),actionType="Follow a user",namespace.followAUser=namespace.wrap([namespace.favorableActionFactory(actionType),namespace.mixpanel(actionType,function(props){return{url_name:props.urlName,place:props.place}}),namespace.analytics("User","Follow",function(props){return{eventLabel:_.capitalize(props.place)}})])}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views.users"),namespace.FollowButtonView=function(_super){function FollowButtonView(){return FollowButtonView.__super__.constructor.apply(this,arguments)}var FOLLOWING_CLASS_NAME;return __extends(FollowButtonView,_super),FOLLOWING_CLASS_NAME="following",FollowButtonView.prototype.events={click:"onClick"},FollowButtonView.prototype.initialize=function(){return this.model=new Qiita.models.User({url_name:this.$el.data("urlName"),following:this.$el.hasClass(FOLLOWING_CLASS_NAME)}),this.listenTo(this.model,"change:following",this.render)},FollowButtonView.prototype.onClick=_.lock(function(free,e){e.preventDefault(),this.$el.find(".btn").prop("disabled","disabled");if(!Qiita.user)return this.showLoginModal().on("dismiss",function(_this){return function(){return _this.$el.find(".btn").prop("disabled",!1),free()}}(this));this.model.toggleFollowing().always(function(_this){return function(){return _this.$el.find(".btn").prop("disabled",!1),free()}}(this));if(!this.model.get("following"))return this.trackFollowEvent()}),FollowButtonView.prototype.render=function(){return this.model.get("following")?this.$el.addClass(FOLLOWING_CLASS_NAME):this.$el.removeClass(FOLLOWING_CLASS_NAME)},FollowButtonView.prototype.showLoginModal=function(){var modalView;return modalView=new Qiita.views.LoginModalView({action:"followUser",target:this.$el.data("urlName"),type:"followUser:"+this.$el.data("position")}),$("body").append(modalView.render().el),modalView},FollowButtonView.prototype.trackFollowEvent=function(){return Qiita.analysis.followAUser({urlName:this.model.id,place:this.$el.data("position")||"follow button"})},FollowButtonView}(Backbone.View)}.call(this),function(){var namespace;namespace=ns("analysis"),namespace.thankComment=namespace.wrap([namespace.mixpanel("Thank a comment",function(props){return{"Comment uuid":props.uuid}}),namespace.analytics("Comment","Thank",function(props){return{eventLabel:props.uuid}})])}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("models"),namespace.Comment=function(_super){function Comment(){return Comment.__super__.constructor.apply(this,arguments)}return __extends(Comment,_super),Comment.prototype.idAttribute="uuid",Comment.prototype.urlRoot="/comments/",Comment.prototype.isEditable=function(){var _ref;return this.get("user_id")===((_ref=Qiita.user)!=null?_ref.id:void 0)},Comment.prototype.toggleThanked=function(){return this.get("thanked")?this.unThank():this.thank()},Comment.prototype.thank=function(){return $.ajax({url:""+this.url()+"/thanks",type:"post",dataType:"json"}).done(function(_this){return function(){return Qiita.analysis.thankComment({uuid:_this.id}),_this.set("thanked",!0)}}(this))},Comment.prototype.unThank=function(){return $.ajax({url:""+this.url()+"/thanks",type:"delete",dataType:"json"}).done(function(_this){return function(){return _this.set("thanked",!1)}}(this))},Comment.prototype.toJSON=function(){return{comment:_.pick(Comment.__super__.toJSON.apply(this,arguments),["item_id","item_type","raw_body"])}},Comment}(Backbone.Model)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("collections"),namespace.CommentList=function(_super){function CommentList(){return CommentList.__super__.constructor.apply(this,arguments)}return __extends(CommentList,_super),CommentList.prototype.model=Qiita.models.Comment,CommentList.prototype.initialize=function(models,options){options&&(this.item=options.item);if(this.item)return this.listenTo(this.item,"sync:assets",this.onSyncAssets)},CommentList.prototype.onSyncAssets=function(json){var removeComments;return removeComments=this.select(function(model){return!_.contains(json.comments.uuids,model.id)}),this.remove(removeComments),this.add(json.comments.updates,{merge:!0,remove:!1})},CommentList}(Backbone.Collection)}.call(this),function(){var namespace,__hasProp=
{}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("models"),namespace.Item=function(_super){function Item(){return Item.__super__.constructor.apply(this,arguments)}return __extends(Item,_super),Item.prototype.idAttribute="uuid",Item.prototype.url=function(){return this.get("url")||"/items/"+this.get("uuid")},Item.prototype.initialize=function(){return this.lastCheckedAt=this.getTimestamp(),this.resetInterval(),this.comments=new Qiita.collections.CommentList([],{item:this})},Item.prototype.resetInterval=function(){return this.interval=4e4},Item.prototype.getTimestamp=function(){return Math.round(Date.now()/1e3)},Item.prototype.loadBody=function(){this.$body=$("#item-"+this.id);if(this.$body.length)return this.set({body:this.$body.html()})},Item.prototype.stock=function(){if(this.get("secret"))throw new Error("Can not stock a secret item");if(this.get("stocked"))return;return $.ajax({url:""+this.url()+"/stock",type:"post"}).done(function(_this){return function(){return _this.set({stocked:!0,stock_count:_this.get("stock_count")+1})}}(this))},Item.prototype.unstock=function(){if(this.get("secret"))throw new Error("Can not stock a secret item");if(!this.get("stocked"))return;return $.ajax({url:""+this.url()+"/unstock",type:"post"}).done(function(_this){return function(){return _this.set({stocked:!1,stock_count:_this.get("stock_count")-1})}}(this))},Item.prototype.like=function(){if(this.get("team_id")===0)throw new Error("Can not like a public item");if(this.get("liked"))return;return $.ajax({url:""+this.url()+"/like",type:"post",dataType:"json"}).done(function(_this){return function(){return _this.set({liked:!0,lgtm_count:_this.get("lgtm_count")+1})}}(this)).fail(function(_this){return function(){return _this.trigger("error")}}(this))},Item.prototype.unlike=function(){if(this.get("team_id")===0)throw new Error("Can not unlike a public item");if(!this.get("liked"))return;return $.ajax({url:""+this.url()+"/like",type:"delete",dataType:"json"}).done(function(_this){return function(){return _this.set({liked:!1,lgtm_count:_this.get("lgtm_count")-1})}}(this)).fail(function(_this){return function(){return _this.trigger("error")}}(this))},Item.prototype.toggleStock=function(){return this.get("stocked")?this.unstock():this.stock()},Item.prototype.toggleLike=function(){return this.get("liked")?this.unlike():this.like()},Item.prototype.fetchAssets=function(){return $.ajax({url:""+this.url()+"/assets",type:"get",data:{last_checked_at:this.lastCheckedAt}}).done(function(_this){return function(json){return _this.trigger("sync:assets",json)}}(this))},Item.prototype.beginCheckAssets=function(){var scheduledFetchAssets;return scheduledFetchAssets=function(_this){return function(){var checkedAt;return checkedAt=_this.getTimestamp(),_this.fetchAssets().done(function(){return _this.lastCheckedAt=checkedAt,_this.resetInterval()}).fail(function(){return _this.interval*=2}).always(function(){return _this.beginCheckAssets()})}}(this),setTimeout(scheduledFetchAssets,this.interval)},Item}(Backbone.Model)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("collections"),namespace.ItemList=function(_super){function ItemList(){return ItemList.__super__.constructor.apply(this,arguments)}return __extends(ItemList,_super),ItemList.prototype.model=Qiita.models.Item,ItemList.prototype.findByUuid=function(uuid){var dfd,item;return dfd=$.Deferred(),(item=this.get(uuid))?dfd.resolve(item):(item=new this.model({uuid:uuid}),item.fetch().done(function(_this){return function(){return _this.add(item),dfd.resolve(item)}}(this)).fail(function(){return dfd.reject()})),dfd.promise()},ItemList}(Backbone.Collection)}.call(this),function(){var namespace;namespace=ns("db"),namespace.items=new Qiita.collections.ItemList}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("models"),namespace.Tag=function(_super){function Tag(){return Tag.__super__.constructor.apply(this,arguments)}return __extends(Tag,_super),Tag.prototype.idAttribute="url_name",Tag.prototype.urlRoot="/tags/",Tag.prototype.url=function(){var base;return base=_.result(this,"urlRoot")||_.result(this.collection,"url")||urlError(),this.isNew()?base:base.replace(/([^\/])$/,"$1/")+this.id},Tag.prototype.follow=function(){if(this.get("following"))return;return $.ajax({url:""+this.url()+"/follow",type:"post"}).done(function(_this){return function(){return _this.set("following",!0)}}(this))},Tag.prototype.unfollow=function(){if(!this.get("following"))return;return $.ajax({url:""+this.url()+"/unfollow",type:"post"}).done(function(_this){return function(){return _this.set("following",!1)}}(this))},Tag.prototype.toggleFollowing=function(){return this.get("following")?this.unfollow():this.follow()},Tag}(Backbone.Model)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("collections"),namespace.TagList=function(_super){function TagList(){return TagList.__super__.constructor.apply(this,arguments)}return __extends(TagList,_super),TagList.prototype.model=Qiita.models.Tag,TagList.prototype.findByUrlName=function(urlName){var dfd,tag;return dfd=$.Deferred(),(tag=this.get(urlName))?dfd.resolve(tag):(tag=new Qiita.models.Tag({url_name:urlName}),tag.fetch().done(function(_this){return function(){return _this.add(tag),dfd.resolve(tag)}}(this)).fail(function(){return dfd.reject()})),dfd.promise()},TagList}(Backbone.Collection)}.call(this),function(){var namespace;namespace=ns("db"),namespace.tags=new Qiita.collections.TagList}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("models"),namespace.User=function(_super){function User(){return User.__super__.constructor.apply(this,arguments)}var URL_NAME_REG;return __extends(User,_super),User.prototype.idAttribute="url_name",User.prototype.urlRoot="/",URL_NAME_REG=/^[\w\-]{3,32}$/,User.prototype.validateUrlName=function(url_name){var dfd,_ref;return url_name==null&&(url_name=""),dfd=$.Deferred(),3<=(_ref=url_name.length)&&_ref<=32?URL_NAME_REG.test(url_name)?$.ajax({url:"/api/users/"+url_name,type:"GET"}).done(function(){return dfd.resolve("valid")}).fail(function(){return dfd.reject("already_exists")}):dfd.reject("invalid_characters"):dfd.reject("invalid_length"),dfd.promise()},User.prototype.follow=function(){if(this.get("following"))return;return $.ajax({url:""+this.url(!1)+"/follow",type:"post"}).done(function(_this){return function(){return _this.set("following",!0)}}(this))},User.prototype.unfollow=function(){if(!this.get("following"))return;return $.ajax({url:""+this.url(!1)+"/unfollow",type:"post"}).done(function(_this){return function(){return _this.set("following",!1)}}(this))},User.prototype.toggleFollowing=function(){return this.get("following")?this.unfollow():this.follow()},User.prototype.url=function(forceJson){return forceJson==null&&(forceJson=!0),forceJson?""+User.__super__.url.apply(this,arguments)+".json":User.__super__.url.apply(this,arguments)},User}(Backbone.Model)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("collections"),namespace.UserList=function(_super){function UserList(){return UserList.__super__.constructor.apply(this,arguments)}return __extends(UserList,_super),UserList.prototype.model=Qiita.models.User,UserList.prototype.findByUrlName=function(urlName){var dfd,user;return dfd=$.Deferred(),(user=this.get(urlName))?dfd.resolve(user):(user=new Qiita.models.User({url_name:urlName}),user.fetch().done(function(_this){return function(){return _this.add(user),dfd.resolve(user)}}(this)).fail(function(){return dfd.reject()})),dfd.promise()},UserList}(Backbone.Collection)}.call(this),function(){var namespace;namespace=ns("db"),namespace.users=new Qiita.collections.UserList}.call(this),function(){this.JST||(this.JST={}),this.JST["t/response"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="position-relative response">\n  '),icon?__p.push('\n    <i class="fa fa-',icon,' left-side-icon"></i>\n    <p class="trimmed">&nbsp;',message,"</p>\n  "):__p.push("\n    <p>",message,"</p>\n  "),__p.push("\n  "),keep&&__p.push('<i class="close-btn fa fa-times-circle-o"></i>'),__p.push("\n</div>\n");return __p.join("")}}.call(this),function(){var CONTAINER_CLASS,CONTAINER_ID,namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),CONTAINER_ID="js-response-container",CONTAINER_CLASS="response-container response_container",namespace.ResponseView=function(_super){function ResponseView(){return ResponseView.__super__.constructor.apply(this,arguments)}return __extends(ResponseView,_super),ResponseView.prototype.events={"click .close-btn":"hide"},ResponseView.prototype.initialize=function(options){var _base;return this.options=options,(_base=this.options).type==null&&(_base.type="notice"),this.render()},ResponseView.prototype.render=function(){return this.$el.html(JST["t/response"](this.presenter())).addClass(""+this.options.type+"-response response_message-"+this.options.type).appendTo(this.findContainer()),this.shown=!0,this.options.keep||setTimeout(function(_this){return function(){return _this.hide()}}(this),this.options.time||3e3),this},ResponseView.prototype.hide=function(){if(this.shown)return this.$el.fadeOut({done:function(_this){return function(){return _this.shown=!1,_this.$el.remove()}}(this)})},ResponseView.prototype.findContainer=function(){return this.$container||(this.$container=$("#"+CONTAINER_ID),this.$container.length||(this.$container=$("<div id='"+CONTAINER_ID+"' class='"+CONTAINER_CLASS+"'></div>"),this.$container.appendTo("body"))),this.$container},ResponseView.prototype.presenter=function(){return{keep:this.options.keep,message:this.options.message,type:this.options.type,icon:this.options.icon}},ResponseView}(Backbone.View)}.call(this),function(){var notification;notification=ns("notification"),_.extend(notification,{notify:function(type,message,params){return new Qiita.views.ResponseView({type:type,message:_.escape(message),keep:params.keep,time:params.time,icon:params.icon})},alert:function(message,params){return params==null&&(params={keep:!0,icon:"warning-sign fa-exclamation-triangle"}),notification.notify("alert",message,params)},notice:function(message,params){return params==null&&(params={}),notification.notify("notice",message,params)},error:function(message,params){return params==null&&(params={keep:!0}),notification.notify("error",message,params)}})}.call(this),function(){var config,identify,isCareerPages,isPublicPages,isTeamLandingPage,isTeamPage,perTeamToken,token,_ref,_ref1,_ref2;isTeamLandingPage=Qiita.getIsTeamLandingPage(),isTeamPage=Qiita.getIsTeamPage(),isCareerPages=Qiita.controller==="human_resources",isPublicPages=!(isTeamLandingPage||isTeamPage||isCareerPages),token=isTeamPage||isTeamLandingPage?Qiita.config.mixpanel.team:isCareerPages?Qiita.config.mixpanel.career:Qiita.config.mixpanel["public"],config={upgrade:!0,track_pageview:!1};if(Qiita.env!=="production"||Qiita.DEBUG)config.verbose=!0,config.debug=!0;mixpanel.init(token,config),Qiita.user&&mixpanel.identify(Qiita.user.id.toString());if(!isTeamPage&&!isTeamLandingPage)return;perTeamToken=((_ref=Qiita.user)!=null?_ref.staff:void 0)?"donttrackstaffaccess":Qiita.config.mixpanel.per_team,mixpanel.init(perTeamToken,config,"perTeam"),isTeamPage?(identify=function(){return mixpanel.perTeam.identify(Qiita.currentTeam.id.toString()),mixpanel.register({owner:Qiita.user.isOwner,url_name:Qiita.currentTeam.get("url_name"),status:Qiita.currentTeam.get("status")}),mixpanel.perTeam.register({owner:Qiita.user.isOwner,url_name:Qiita.currentTeam.get("url_name"),status:Qiita.currentTeam.get("status")})},mixpanel.perTeam.register({owner:Qiita.user.isOwner,url_name:Qiita.currentTeam.get("url_name")}),Qiita.flash.signup?(mixpanel.track("Create Team",{team_name:Qiita.currentTeam.get("url_name")}),mixpanel.perTeam.alias(Qiita.currentTeam.id.toString()),mixpanel.perTeam.track("$born",{url_name:Qiita.currentTeam.get("url_name")},function(){return $.removeCookie("mp_"+Qiita.config.mixpanel.per_team+"_mixpanel",{domain:"qiita."+Qiita.TLD,path:"/"}),delete mixpanel.perTeam,mixpanel.init(Qiita.config.mixpanel.per_team,config,"perTeam"),identify()})):(identify(),mixpanel.track("page view",{controller_action:Qiita.controllerAction,url:window.location.pathname,user_url_name:(_ref1=Qiita.user)!=null?_ref1.url_name:void 0}),mixpanel.perTeam.track("page view",{controller_action:Qiita.controllerAction,url:window.location.pathname,user_url_name:(_ref2=Qiita.user)!=null?_ref2.url_name:void 0}))):(mixpanel.perTeam.unregister("owner"),mixpanel.perTeam.unregister("url_name"),_.delay(function(){var _ref3;return/^\d+$/.test(mixpanel.perTeam.get_distinct_id())&&mixpanel.perTeam.identify(Math.random().toString()),mixpanel.perTeam.track("page view",{controller_action:Qiita.controllerAction,url:window.location.pathname,user_url_name:(_ref3=Qiita.user)!=null?_ref3.url_name:void 0})},1e3))}.call(this),function(global,Qiita,_){"use strict";var Mixpanel=Qiita.Mixpanel={},util=Qiita.util,user=Qiita.user,teamName=Qiita.teamName,location=Qiita.location,isMixpanelAvailable;Mixpanel.properties||(Mixpanel.properties={});var favorableAction=function(properties,callback){isMixpanelAvailable?(properties||(properties={}),global.mixpanel.track("Favorable Action",{distinct_id:util.distinctId(),page:location.pageType,page_id:location.pageId,page_detail:location.pageDetail,"action type":properties.actionType,item_uuid:properties.uuid,team_name:teamName},callback)):_.isFunction(callback)&&callback()};Mixpanel.tweetAnItem=function(properties,callback){isMixpanelAvailable?(properties||(properties={}),user?global.mixpanel.track("Tweet an item",{distinct_id:util.distinctId(),page:location.pageType,page_id:location.pageId,page_detail:location.pageDetail,logged_in:!!user,item_uuid:properties.uuid},function(){favorableAction({actionType:"Tweet an item",uuid:properties.uuid},callback)}):global.mixpanel.track("Tweet an item",{distinct_id:util.distinctId(),page:location.pageType,page_id:location.pageId,page_detail:location.pageDetail,logged_in:!!user,item_uuid:properties.uuid},callback)):_.isFunction(callback)&&callback()},Mixpanel.likeAnItem=function(properties,callback){isMixpanelAvailable?(properties||(properties={}),user?global.mixpanel.track("Like an item",{distinct_id:util.distinctId(),page:location.pageType,page_id:location.pageId,page_detail:location.pageDetail,logged_in:!!user,item_uuid:properties.uuid},function(){favorableAction({actionType:"Like an item",uuid:properties.uuid},callback)}):global.mixpanel.track("Like an item",{distinct_id:util.distinctId(),page:location.pageType,page_id:location.pageId,page_detail:location.pageDetail,logged_in:!!user,item_uuid:properties.uuid},callback)):_.isFunction(callback)&&callback()}}(this,Qiita,_);var I18n=I18n||{};I18n.addTranslations({en:{js:{views:{shared:{try_again_after_reloading_page:"Try again after reloading page."}}}},ja:{js:{views:{shared:{try_again_after_reloading_page:"ページを再読込後、再度お試しください"}}}}}),function(){$(document).on("change",".task-list-item-checkbox",function(){var $checkbox,$container,$field,$form;$checkbox=$(this),$container=$checkbox.closest(".js-task-list-container");if($container.length!==0)return $field=$container.find(".js-task-list-field").first(),$field.val(tasklist.convert($field.val(),$container.find(".task-list-item-checkbox").index($checkbox)+1,$checkbox.prop("checked"))),$form=$field.closest(".js-task-list-update"),$.rails.handleRemote($form)}),$(document).on("ajax:send.rails",".js-task-list-update",function(){return $(this).closest(".js-task-list-container").find(".task-list-item-checkbox").attr("disabled",!0)}),$(document).on("ajax:complete.rails",".js-task-list-update",function(){return $(this).closest(".js-task-list-container").find(".task-list-item-checkbox").attr("disabled",null)}),$(document).on("ajax:success.rails",".js-task-list-update",function(_,resource){return $(this).find(".js-task-list-updated-at").val(Date.parse(resource.updated_at)*.001)}),$(document).on("ajax:error.rails",".js-task-list-update",function(){return Qiita.notification.error(I18n.t("js.views.shared.try_again_after_reloading_page"))}),$(function(){return $(".js-task-list-enabled .task-list-item-checkbox").attr("disabled",null)})}.call(this),function(){var SearchFormView;Backbone.emulateHTTP=!0,SearchFormView=Qiita.views.SearchFormView,$(function(){var $document,$el,$menu,activateCallback,analysis,db,deactivateCallback,loadingTime,onPageMoved,searchFormView,views;views=Qiita.views,analysis=Qiita.analysis,db=Qiita.db,$document=$(document),Qiita.user&&($el=$(".js-globalNotification"),$el.length&&new views.NotificationView({el:$el})),new Qiita.views.FeedbackFormView,$menu=$(".dropdown-menu"),activateCallback=function(row){return $(row).addClass("active")},deactivateCallback=function(row){return $(row).removeClass("active")},$menu.each(function(){var opts;return $el=$(this),opts={activate:activateCallback,deactivate:deactivateCallback},$el.find(".submenu-left").length&&(opts.submenuDirection="left"),$el.menuAim(opts)}),$("#news-content").click(function(){return analysis.clickNews()}),$document.on("click",function(e){return Backbone.trigger("click",e),$menu.find(".active").removeClass("active")}),$document.on("click",'a[track="click"]',function(e){var href,isHashChange,promise;$el=$(this),href=$el.attr("href"),isHashChange=href.charAt(0)==="#",promise=null;if(e.metaKey)return analysis.linkClick($el.data());$el.attr("target")!=="_blank"&&!isHashChange&&e.preventDefault(),promise=analysis.linkClick($el.data());if(!isHashChange)return promise.always(function(){return window.location.href=href})}),$document.on("submit","form[data-event_name]",function(e){return $el=$(this),e.preventDefault(),analysis.formSubmit({event_name:$el.data("event_name")}).always(function(){return $el.removeAttr("data-event_name"),$el.submit()})}),searchFormView=new SearchFormView,$(".js-teamSwitch").on("click",function(e){$(".js-teamSwitch_teamList").toggle();if(e.originalEvent)return e.originalEvent.clickTeamsSwitch=!0}),$(document).on("click",function(e){if(!e.originalEvent||!e.originalEvent.clickTeamsSwitch)return $(".js-teamSwitch_teamList").fadeOut(200)}),$(".js-item").each(function(){var html;return html=$(this).html(),db.items.add(_.parse(html))}),$(".js-user").each(function(){var html;return html=$(this).html(),db.users.add(_.parse(html))}),$(".js-userFollowButton").each(function(){return new views.users.FollowButtonView({el:this})}),$(".js-tagFollowButton").each(function(){return new views.tags.FollowButtonView({el:this})}),$(".js-tag").each(function(){return db.tags.add(_.parse($(this).html()))}),$(".js-userData").each(function(){return _.extend(Qiita.user,$(this).data())}),$(".js-userJson").each(function(){return _.extend(Qiita.user,JSON.parse(_.unescape($(this).text())))}),$("#draftsDropdown").attr("href","#"),Backbone.history&&(Backbone.history.start({pushState:!0,hashChange:!1}),onPageMoved=function(){Qiita.location.reset();if(Qiita.isAnalyticsAvailable)return ga("set","location",location.href),ga("set","page",location.pathname),ga("set","title",document.title),ga("send","pageview")},Backbone.history.on("route",onPageMoved),$document.on("pjax:end",function(){return onPageMoved(),Backbone.history.checkUrl()})),_.each(["error","alert","notice"],function(type){var messages,value;value=Qiita.flash[type];if(!Qiita.flash[type])return;return messages=_.isArray(value)?value:[value],_.each(messages,function(message){return Qiita.notification[type](message)})}),$.support.pjax&&$document.on("click","a[data-pjax]",function(e){var container,opts;return container=$(this).data("pjax"),_.isString(container)||(container="#pjax-container"),opts={container:container},Qiita.variant==="phone"?opts.timeout=1e4:opts.timeout=2e3,$.pjax.click(e,opts)}),Qiita.unqueue();if(Qiita.DEBUG||~~(Math.random()*1e4)===1){loadingTime=Date.now()-Qiita.startTime,console.info("loaded",loadingTime);if(window.mixpanel)return mixpanel.track("loading_time",{loading_time:loadingTime})}})}.call(this),function(){if(Qiita.env==="test")return;var script=document.getElementsByTagName("script")[0],load=function(src,id){var el=document.createElement("script");el.async=!0,el.src=src,el.id=id,script.parentNode.insertBefore(el,script)},_e=[];window.twttr={_e:_e,ready:function(f){_e.push(f)}},load("//platform.twitter.com/widgets.js","twitter-jssdk");if(Qiita.teamName&&Qiita.teamName!=="teams")return;var fbRoot=document.createElement("div");fbRoot.id="fb-root",document.getElementsByTagName("body")[0].appendChild(fbRoot),load("//connect.facebook.net/en_US/all.js#xfbml=1&appId=222621691108322","facebook-jssdk"),load("//apis.google.com/js/plusone.js","google-plusone-jssdk")}();if(typeof jQuery=="undefined")throw new Error("Bootstrap's JavaScript requires jQuery");+function($){"use strict";function transitionEnd(){var el=document.createElement("bootstrap"),transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var name in transEndEventNames)if(el.style[name]!==undefined)return{end:transEndEventNames[name]};return!1}$.fn.emulateTransitionEnd=function(duration){var called=!1,$el=this;$(this).one("bsTransitionEnd",function(){called=!0});var callback=function(){called||$($el).trigger($.support.transition.end)};return setTimeout(callback,duration),this},$(function(){$.support.transition=transitionEnd();if(!$.support.transition)return;$.event.special.bsTransitionEnd={bindType:$.support.transition.end,delegateType:$.support.transition.end,handle:function(e){if($(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}}})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.alert");data||$this.data("bs.alert",data=new Alert(this)),typeof option=="string"&&data[option].call($this)})}var dismiss='[data-dismiss="alert"]',Alert=function(el){$(el).on("click",dismiss,this.close)};Alert.VERSION="3.2.0",Alert.prototype.close=function(e){function removeElement(){$parent.detach().trigger("closed.bs.alert").remove()}var $this=$(this),selector=$this.attr("data-target");selector||(selector=$this.attr("href"),selector=selector&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=$(selector);e&&e.preventDefault(),$parent.length||($parent=$this.hasClass("alert")?$this:$this.parent()),$parent.trigger(e=$.Event("close.bs.alert"));if(e.isDefaultPrevented())return;$parent.removeClass("in"),$.support.transition&&$parent.hasClass("fade")?$parent.one("bsTransitionEnd",removeElement).emulateTransitionEnd(150):removeElement()};var old=$.fn.alert;$.fn.alert=Plugin,$.fn.alert.Constructor=Alert,$.fn.alert.noConflict=function(){return $.fn.alert=old,this},$(document).on("click.bs.alert.data-api",dismiss,Alert.prototype.close)}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.button"),options=typeof option=="object"&&option;data||$this.data("bs.button",data=new Button(this,options)),option=="toggle"?data.toggle():option&&data.setState(option)})}var Button=function(element,options){this.$element=$(element),this.options=$.extend({},Button.DEFAULTS,options),this.isLoading=!1};Button.VERSION="3.2.0",Button.DEFAULTS={loadingText:"loading..."},Button.prototype.setState=function(state){var d="disabled",$el=this.$element,val=$el.is("input")?"val":"html",data=$el.data();state+="Text",data.resetText==null&&$el.data("resetText",$el[val]()),$el[val](data[state]==null?this.options[state]:data[state]),setTimeout($.proxy(function(){state=="loadingText"?(this.isLoading=!0,$el.addClass(d).attr(d,d)):this.isLoading&&(this.isLoading=!1,$el.removeClass(d).removeAttr(d))},this),0)},Button.prototype.toggle=function(){var changed=!0,$parent=this.$element.closest('[data-toggle="buttons"]');if($parent.length){var $input=this.$element.find("input");$input.prop("type")=="radio"&&($input.prop("checked")&&this.$element.hasClass("active")?changed=!1:$parent.find(".active").removeClass("active")),changed&&$input.prop("checked",!this.$element.hasClass("active")).trigger("change")}changed&&this.$element.toggleClass("active")};var old=$.fn.button;$.fn.button=Plugin,$.fn.button.Constructor=Button,$.fn.button.noConflict=function(){return $.fn.button=old,this},$(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(e){var $btn=$(e.target);$btn.hasClass("btn")||($btn=$btn.closest(".btn")),Plugin.call($btn,"toggle"),e.preventDefault()})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.carousel"),options=$.extend({},Carousel.DEFAULTS,$this.data(),typeof option=="object"&&option),action=typeof option=="string"?option:options.slide;data||$this.data("bs.carousel",data=new Carousel(this,options)),typeof option=="number"?data.to(option):action?data[action]():options.interval&&data.pause().cycle()})}var Carousel=function(element,options){this.$element=$(element).on("keydown.bs.carousel",$.proxy(this.keydown,this)),this.$indicators=this.$element.find(".carousel-indicators"),this.options=options,this.paused=this.sliding=this.interval=this.$active=this.$items=null,this.options.pause=="hover"&&this.$element.on("mouseenter.bs.carousel",$.proxy(this.pause,this)).on("mouseleave.bs.carousel",$.proxy(this.cycle,this))};Carousel.VERSION="3.2.0",Carousel.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},Carousel.prototype.keydown=function(e){switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()},Carousel.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval($.proxy(this.next,this),this.options.interval)),this},Carousel.prototype.getItemIndex=function(item){return this.$items=item.parent().children(".item"),this.$items.index(item||this.$active)},Carousel.prototype.to=function(pos){var that=this,activeIndex=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(pos>this.$items.length-1||pos<0)return;return this.sliding?this.$element.one("slid.bs.carousel",function(){that.to(pos)}):activeIndex==pos?this.pause().cycle():this.slide(pos>activeIndex?"next":"prev",$(this.$items[pos]))},Carousel.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&$.support.transition&&(this.$element.trigger($.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},Carousel.prototype.next=function(){if(this.sliding)return;return this.slide("next")},Carousel.prototype.prev=function(){if(this.sliding)return;return this.slide("prev")},Carousel.prototype.slide=function(type,next){var $active=this.$element.find(".item.active"),$next=next||$active[type](),isCycling=this.interval,direction=type=="next"?"left":"right",fallback=type=="next"?"first":"last",that=this;if(!$next.length){if(!this.options.wrap)return;$next=this.$element.find(".item")[fallback]()}if($next.hasClass("active"))return this.sliding=!1;var relatedTarget=$next[0],slideEvent=$.Event("slide.bs.carousel",{relatedTarget:relatedTarget,direction:direction});this.$element.trigger(slideEvent);if(slideEvent.isDefaultPrevented())return;this.sliding=!0,isCycling&&this.pause();if(this.$indicators.length){this.$indicators.find(".active").removeClass("active");var $nextIndicator=$(this.$indicators.children()[this.getItemIndex($next)]);$nextIndicator&&$nextIndicator.addClass("active")}var slidEvent=$.Event("slid.bs.carousel",{relatedTarget:relatedTarget,direction:direction});return $.support.transition&&this.$element.hasClass("slide")?($next.addClass(type),$next[0].offsetWidth,$active.addClass(direction),$next.addClass(direction),$active.one("bsTransitionEnd",function(){$next.removeClass([type,direction].join(" ")).addClass("active"),$active.removeClass(["active",direction].join(" ")),that.sliding=!1,setTimeout(function(){that.$element.trigger(slidEvent)},0)}).emulateTransitionEnd($active.css("transition-duration").slice(0,-1)*1e3)):($active.removeClass("active"),$next.addClass("active"),this.sliding=!1,this.$element.trigger(slidEvent)),isCycling&&this.cycle(),this};var old=$.fn.carousel;$.fn.carousel=Plugin,$.fn.carousel.Constructor=Carousel,$.fn.carousel.noConflict=function(){return $.fn.carousel=old,this},$(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(e){var href,$this=$(this),$target=$($this.attr("data-target")||(href=$this.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,""));if(!$target.hasClass("carousel"))return;var options=$.extend({},$target.data(),$this.data()),slideIndex=$this.attr("data-slide-to");slideIndex&&(options.interval=!1),Plugin.call($target,options),slideIndex&&$target.data("bs.carousel").to(slideIndex),e.preventDefault()}),$(window).on("load",function(){$('[data-ride="carousel"]').each(function(){var $carousel=$(this);Plugin.call($carousel,$carousel.data())})})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.collapse"),options=$.extend({},Collapse.DEFAULTS,$this.data(),typeof option=="object"&&option);!data&&options.toggle&&option=="show"&&(option=!option),data||$this.data("bs.collapse",data=new Collapse(this,options)),typeof option=="string"&&data[option]()})}var Collapse=function(element,options){this.$element=$(element),this.options=$.extend({},Collapse.DEFAULTS,options),this.transitioning=null,this.options.parent&&(this.$parent=$(this.options.parent)),this.options.toggle&&this.toggle()};Collapse.VERSION="3.2.0",Collapse.DEFAULTS={toggle:!0},Collapse.prototype.dimension=function(){var hasWidth=this.$element.hasClass("width");return hasWidth?"width":"height"},Collapse.prototype.show=function(){if(this.transitioning||this.$element.hasClass("in"))return;var startEvent=$.Event("show.bs.collapse");this.$element.trigger(startEvent);if(startEvent.isDefaultPrevented())return;var actives=this.$parent&&this.$parent.find("> .panel > .in");if(actives&&actives.length){var hasData=actives.data("bs.collapse");if(hasData&&hasData.transitioning)return;Plugin.call(actives,"hide"),hasData||actives.data("bs.collapse",null)}var dimension=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[dimension](0),this.transitioning=1;var complete=function(){this.$element.removeClass("collapsing").addClass("collapse in")[dimension](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!$.support.transition)return complete.call(this);var scrollSize=$.camelCase(["scroll",dimension].join("-"));this.$element.one("bsTransitionEnd",$.proxy(complete,this)).emulateTransitionEnd(350)[dimension](this.$element[0][scrollSize])},Collapse.prototype.hide=function(){if(this.transitioning||!this.$element.hasClass("in"))return;var startEvent=$.Event("hide.bs.collapse");this.$element.trigger(startEvent);if(startEvent.isDefaultPrevented())
return;var dimension=this.dimension();this.$element[dimension](this.$element[dimension]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var complete=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};if(!$.support.transition)return complete.call(this);this.$element[dimension](0).one("bsTransitionEnd",$.proxy(complete,this)).emulateTransitionEnd(350)},Collapse.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var old=$.fn.collapse;$.fn.collapse=Plugin,$.fn.collapse.Constructor=Collapse,$.fn.collapse.noConflict=function(){return $.fn.collapse=old,this},$(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(e){var href,$this=$(this),target=$this.attr("data-target")||e.preventDefault()||(href=$this.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,""),$target=$(target),data=$target.data("bs.collapse"),option=data?"toggle":$this.data(),parent=$this.attr("data-parent"),$parent=parent&&$(parent);if(!data||!data.transitioning)$parent&&$parent.find('[data-toggle="collapse"][data-parent="'+parent+'"]').not($this).addClass("collapsed"),$this[$target.hasClass("in")?"addClass":"removeClass"]("collapsed");Plugin.call($target,option)})}(jQuery),+function($){"use strict";function clearMenus(e){if(e&&e.which===3)return;$(backdrop).remove(),$(toggle).each(function(){var $parent=getParent($(this)),relatedTarget={relatedTarget:this};if(!$parent.hasClass("open"))return;$parent.trigger(e=$.Event("hide.bs.dropdown",relatedTarget));if(e.isDefaultPrevented())return;$parent.removeClass("open").trigger("hidden.bs.dropdown",relatedTarget)})}function getParent($this){var selector=$this.attr("data-target");selector||(selector=$this.attr("href"),selector=selector&&/#[A-Za-z]/.test(selector)&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=selector&&$(selector);return $parent&&$parent.length?$parent:$this.parent()}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.dropdown");data||$this.data("bs.dropdown",data=new Dropdown(this)),typeof option=="string"&&data[option].call($this)})}var backdrop=".dropdown-backdrop",toggle='[data-toggle="dropdown"]',Dropdown=function(element){$(element).on("click.bs.dropdown",this.toggle)};Dropdown.VERSION="3.2.0",Dropdown.prototype.toggle=function(e){var $this=$(this);if($this.is(".disabled, :disabled"))return;var $parent=getParent($this),isActive=$parent.hasClass("open");clearMenus();if(!isActive){"ontouchstart"in document.documentElement&&!$parent.closest(".navbar-nav").length&&$('<div class="dropdown-backdrop"/>').insertAfter($(this)).on("click",clearMenus);var relatedTarget={relatedTarget:this};$parent.trigger(e=$.Event("show.bs.dropdown",relatedTarget));if(e.isDefaultPrevented())return;$this.trigger("focus"),$parent.toggleClass("open").trigger("shown.bs.dropdown",relatedTarget)}return!1},Dropdown.prototype.keydown=function(e){if(!/(38|40|27)/.test(e.keyCode))return;var $this=$(this);e.preventDefault(),e.stopPropagation();if($this.is(".disabled, :disabled"))return;var $parent=getParent($this),isActive=$parent.hasClass("open");if(!isActive||isActive&&e.keyCode==27)return e.which==27&&$parent.find(toggle).trigger("focus"),$this.trigger("click");var desc=" li:not(.divider):visible a",$items=$parent.find('[role="menu"]'+desc+', [role="listbox"]'+desc);if(!$items.length)return;var index=$items.index($items.filter(":focus"));e.keyCode==38&&index>0&&index--,e.keyCode==40&&index<$items.length-1&&index++,~index||(index=0),$items.eq(index).trigger("focus")};var old=$.fn.dropdown;$.fn.dropdown=Plugin,$.fn.dropdown.Constructor=Dropdown,$.fn.dropdown.noConflict=function(){return $.fn.dropdown=old,this},$(document).on("click.bs.dropdown.data-api",clearMenus).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",toggle,Dropdown.prototype.toggle).on("keydown.bs.dropdown.data-api",toggle+', [role="menu"], [role="listbox"]',Dropdown.prototype.keydown)}(jQuery),+function($){"use strict";function Plugin(option,_relatedTarget){return this.each(function(){var $this=$(this),data=$this.data("bs.modal"),options=$.extend({},Modal.DEFAULTS,$this.data(),typeof option=="object"&&option);data||$this.data("bs.modal",data=new Modal(this,options)),typeof option=="string"?data[option](_relatedTarget):options.show&&data.show(_relatedTarget)})}var Modal=function(element,options){this.options=options,this.$body=$(document.body),this.$element=$(element),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,$.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};Modal.VERSION="3.2.0",Modal.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},Modal.prototype.toggle=function(_relatedTarget){return this.isShown?this.hide():this.show(_relatedTarget)},Modal.prototype.show=function(_relatedTarget){var that=this,e=$.Event("show.bs.modal",{relatedTarget:_relatedTarget});this.$element.trigger(e);if(this.isShown||e.isDefaultPrevented())return;this.isShown=!0,this.checkScrollbar(),this.$body.addClass("modal-open"),this.setScrollbar(),this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',$.proxy(this.hide,this)),this.backdrop(function(){var transition=$.support.transition&&that.$element.hasClass("fade");that.$element.parent().length||that.$element.appendTo(that.$body),that.$element.show().scrollTop(0),transition&&that.$element[0].offsetWidth,that.$element.addClass("in").attr("aria-hidden",!1),that.enforceFocus();var e=$.Event("shown.bs.modal",{relatedTarget:_relatedTarget});transition?that.$element.find(".modal-dialog").one("bsTransitionEnd",function(){that.$element.trigger("focus").trigger(e)}).emulateTransitionEnd(300):that.$element.trigger("focus").trigger(e)})},Modal.prototype.hide=function(e){e&&e.preventDefault(),e=$.Event("hide.bs.modal"),this.$element.trigger(e);if(!this.isShown||e.isDefaultPrevented())return;this.isShown=!1,this.$body.removeClass("modal-open"),this.resetScrollbar(),this.escape(),$(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),$.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",$.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal()},Modal.prototype.enforceFocus=function(){$(document).off("focusin.bs.modal").on("focusin.bs.modal",$.proxy(function(e){this.$element[0]!==e.target&&!this.$element.has(e.target).length&&this.$element.trigger("focus")},this))},Modal.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",$.proxy(function(e){e.which==27&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},Modal.prototype.hideModal=function(){var that=this;this.$element.hide(),this.backdrop(function(){that.$element.trigger("hidden.bs.modal")})},Modal.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},Modal.prototype.backdrop=function(callback){var that=this,animate=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate;this.$backdrop=$('<div class="modal-backdrop '+animate+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",$.proxy(function(e){if(e.target!==e.currentTarget)return;this.options.backdrop=="static"?this.$element[0].focus.call(this.$element[0]):this.hide.call(this)},this)),doAnimate&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in");if(!callback)return;doAnimate?this.$backdrop.one("bsTransitionEnd",callback).emulateTransitionEnd(150):callback()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var callbackRemove=function(){that.removeBackdrop(),callback&&callback()};$.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",callbackRemove).emulateTransitionEnd(150):callbackRemove()}else callback&&callback()},Modal.prototype.checkScrollbar=function(){if(document.body.clientWidth>=window.innerWidth)return;this.scrollbarWidth=this.scrollbarWidth||this.measureScrollbar()},Modal.prototype.setScrollbar=function(){var bodyPad=parseInt(this.$body.css("padding-right")||0,10);this.scrollbarWidth&&this.$body.css("padding-right",bodyPad+this.scrollbarWidth)},Modal.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},Modal.prototype.measureScrollbar=function(){var scrollDiv=document.createElement("div");scrollDiv.className="modal-scrollbar-measure",this.$body.append(scrollDiv);var scrollbarWidth=scrollDiv.offsetWidth-scrollDiv.clientWidth;return this.$body[0].removeChild(scrollDiv),scrollbarWidth};var old=$.fn.modal;$.fn.modal=Plugin,$.fn.modal.Constructor=Modal,$.fn.modal.noConflict=function(){return $.fn.modal=old,this},$(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(e){var $this=$(this),href=$this.attr("href"),$target=$($this.attr("data-target")||href&&href.replace(/.*(?=#[^\s]+$)/,"")),option=$target.data("bs.modal")?"toggle":$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data());$this.is("a")&&e.preventDefault(),$target.one("show.bs.modal",function(showEvent){if(showEvent.isDefaultPrevented())return;$target.one("hidden.bs.modal",function(){$this.is(":visible")&&$this.trigger("focus")})}),Plugin.call($target,option,this)})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.tooltip"),options=typeof option=="object"&&option;if(!data&&option=="destroy")return;data||$this.data("bs.tooltip",data=new Tooltip(this,options)),typeof option=="string"&&data[option]()})}var Tooltip=function(element,options){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",element,options)};Tooltip.VERSION="3.2.0",Tooltip.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},Tooltip.prototype.init=function(type,element,options){this.enabled=!0,this.type=type,this.$element=$(element),this.options=this.getOptions(options),this.$viewport=this.options.viewport&&$(this.options.viewport.selector||this.options.viewport);var triggers=this.options.trigger.split(" ");for(var i=triggers.length;i--;){var trigger=triggers[i];if(trigger=="click")this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this));else if(trigger!="manual"){var eventIn=trigger=="hover"?"mouseenter":"focusin",eventOut=trigger=="hover"?"mouseleave":"focusout";this.$element.on(eventIn+"."+this.type,this.options.selector,$.proxy(this.enter,this)),this.$element.on(eventOut+"."+this.type,this.options.selector,$.proxy(this.leave,this))}}this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},Tooltip.prototype.getDefaults=function(){return Tooltip.DEFAULTS},Tooltip.prototype.getOptions=function(options){return options=$.extend({},this.getDefaults(),this.$element.data(),options),options.delay&&typeof options.delay=="number"&&(options.delay={show:options.delay,hide:options.delay}),options},Tooltip.prototype.getDelegateOptions=function(){var options={},defaults=this.getDefaults();return this._options&&$.each(this._options,function(key,value){defaults[key]!=value&&(options[key]=value)}),options},Tooltip.prototype.enter=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),clearTimeout(self.timeout),self.hoverState="in";if(!self.options.delay||!self.options.delay.show)return self.show();self.timeout=setTimeout(function(){self.hoverState=="in"&&self.show()},self.options.delay.show)},Tooltip.prototype.leave=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),clearTimeout(self.timeout),self.hoverState="out";if(!self.options.delay||!self.options.delay.hide)return self.hide();self.timeout=setTimeout(function(){self.hoverState=="out"&&self.hide()},self.options.delay.hide)},Tooltip.prototype.show=function(){var e=$.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var inDom=$.contains(document.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!inDom)return;var that=this,$tip=this.tip(),tipId=this.getUID(this.type);this.setContent(),$tip.attr("id",tipId),this.$element.attr("aria-describedby",tipId),this.options.animation&&$tip.addClass("fade");var placement=typeof this.options.placement=="function"?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement,autoToken=/\s?auto?\s?/i,autoPlace=autoToken.test(placement);autoPlace&&(placement=placement.replace(autoToken,"")||"top"),$tip.detach().css({top:0,left:0,display:"block"}).addClass(placement).data("bs."+this.type,this),this.options.container?$tip.appendTo(this.options.container):$tip.insertAfter(this.$element);var pos=this.getPosition(),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;if(autoPlace){var orgPlacement=placement,$parent=this.$element.parent(),parentDim=this.getPosition($parent);placement=placement=="bottom"&&pos.top+pos.height+actualHeight-parentDim.scroll>parentDim.height?"top":placement=="top"&&pos.top-parentDim.scroll-actualHeight<0?"bottom":placement=="right"&&pos.right+actualWidth>parentDim.width?"left":placement=="left"&&pos.left-actualWidth<parentDim.left?"right":placement,$tip.removeClass(orgPlacement).addClass(placement)}var calculatedOffset=this.getCalculatedOffset(placement,pos,actualWidth,actualHeight);this.applyPlacement(calculatedOffset,placement);var complete=function(){that.$element.trigger("shown.bs."+that.type),that.hoverState=null};$.support.transition&&this.$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(150):complete()}},Tooltip.prototype.applyPlacement=function(offset,placement){var $tip=this.tip(),width=$tip[0].offsetWidth,height=$tip[0].offsetHeight,marginTop=parseInt($tip.css("margin-top"),10),marginLeft=parseInt($tip.css("margin-left"),10);isNaN(marginTop)&&(marginTop=0),isNaN(marginLeft)&&(marginLeft=0),offset.top=offset.top+marginTop,offset.left=offset.left+marginLeft,$.offset.setOffset($tip[0],$.extend({using:function(props){$tip.css({top:Math.round(props.top),left:Math.round(props.left)})}},offset),0),$tip.addClass("in");var actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;placement=="top"&&actualHeight!=height&&(offset.top=offset.top+height-actualHeight);var delta=this.getViewportAdjustedDelta(placement,offset,actualWidth,actualHeight);delta.left?offset.left+=delta.left:offset.top+=delta.top;var arrowDelta=delta.left?delta.left*2-width+actualWidth:delta.top*2-height+actualHeight,arrowPosition=delta.left?"left":"top",arrowOffsetPosition=delta.left?"offsetWidth":"offsetHeight";$tip.offset(offset),this.replaceArrow(arrowDelta,$tip[0][arrowOffsetPosition],arrowPosition)},Tooltip.prototype.replaceArrow=function(delta,dimension,position){this.arrow().css(position,delta?50*(1-delta/dimension)+"%":"")},Tooltip.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle();$tip.find(".tooltip-inner")[this.options.html?"html":"text"](title),$tip.removeClass("fade in top bottom left right")},Tooltip.prototype.hide=function(){function complete(){that.hoverState!="in"&&$tip.detach(),that.$element.trigger("hidden.bs."+that.type)}var that=this,$tip=this.tip(),e=$.Event("hide.bs."+this.type);this.$element.removeAttr("aria-describedby"),this.$element.trigger(e);if(e.isDefaultPrevented())return;return $tip.removeClass("in"),$.support.transition&&this.$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(150):complete(),this.hoverState=null,this},Tooltip.prototype.fixTitle=function(){var $e=this.$element;($e.attr("title")||typeof $e.attr("data-original-title")!="string")&&$e.attr("data-original-title",$e.attr("title")||"").attr("title","")},Tooltip.prototype.hasContent=function(){return this.getTitle()},Tooltip.prototype.getPosition=function($element){$element=$element||this.$element;var el=$element[0],isBody=el.tagName=="BODY";return $.extend({},typeof el.getBoundingClientRect=="function"?el.getBoundingClientRect():null,{scroll:isBody?document.documentElement.scrollTop||document.body.scrollTop:$element.scrollTop(),width:isBody?$(window).width():$element.outerWidth(),height:isBody?$(window).height():$element.outerHeight()},isBody?{top:0,left:0}:$element.offset())},Tooltip.prototype.getCalculatedOffset=function(placement,pos,actualWidth,actualHeight){return placement=="bottom"?{top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2}:placement=="top"?{top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2}:placement=="left"?{top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth}:{top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width}},Tooltip.prototype.getViewportAdjustedDelta=function(placement,pos,actualWidth,actualHeight){var delta={top:0,left:0};if(!this.$viewport)return delta;var viewportPadding=this.options.viewport&&this.options.viewport.padding||0,viewportDimensions=this.getPosition(this.$viewport);if(/right|left/.test(placement)){var topEdgeOffset=pos.top-viewportPadding-viewportDimensions.scroll,bottomEdgeOffset=pos.top+viewportPadding-viewportDimensions.scroll+actualHeight;topEdgeOffset<viewportDimensions.top?delta.top=viewportDimensions.top-topEdgeOffset:bottomEdgeOffset>viewportDimensions.top+viewportDimensions.height&&(delta.top=viewportDimensions.top+viewportDimensions.height-bottomEdgeOffset)}else{var leftEdgeOffset=pos.left-viewportPadding,rightEdgeOffset=pos.left+viewportPadding+actualWidth;leftEdgeOffset<viewportDimensions.left?delta.left=viewportDimensions.left-leftEdgeOffset:rightEdgeOffset>viewportDimensions.width&&(delta.left=viewportDimensions.left+viewportDimensions.width-rightEdgeOffset)}return delta},Tooltip.prototype.getTitle=function(){var title,$e=this.$element,o=this.options;return title=$e.attr("data-original-title")||(typeof o.title=="function"?o.title.call($e[0]):o.title),title},Tooltip.prototype.getUID=function(prefix){do prefix+=~~(Math.random()*1e6);while(document.getElementById(prefix));return prefix},Tooltip.prototype.tip=function(){return this.$tip=this.$tip||$(this.options.template)},Tooltip.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},Tooltip.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},Tooltip.prototype.enable=function(){this.enabled=!0},Tooltip.prototype.disable=function(){this.enabled=!1},Tooltip.prototype.toggleEnabled=function(){this.enabled=!this.enabled},Tooltip.prototype.toggle=function(e){var self=this;e&&(self=$(e.currentTarget).data("bs."+this.type),self||(self=new this.constructor(e.currentTarget,this.getDelegateOptions()),$(e.currentTarget).data("bs."+this.type,self))),self.tip().hasClass("in")?self.leave(self):self.enter(self)},Tooltip.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var old=$.fn.tooltip;$.fn.tooltip=Plugin,$.fn.tooltip.Constructor=Tooltip,$.fn.tooltip.noConflict=function(){return $.fn.tooltip=old,this}}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.popover"),options=typeof option=="object"&&option;if(!data&&option=="destroy")return;data||$this.data("bs.popover",data=new Popover(this,options)),typeof option=="string"&&data[option]()})}var Popover=function(element,options){this.init("popover",element,options)};if(!$.fn.tooltip)throw new Error("Popover requires tooltip.js");Popover.VERSION="3.2.0",Popover.DEFAULTS=$.extend({},$.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),Popover.prototype=$.extend({},$.fn.tooltip.Constructor.prototype),Popover.prototype.constructor=Popover,Popover.prototype.getDefaults=function(){return Popover.DEFAULTS},Popover.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle(),content=this.getContent();$tip.find(".popover-title")[this.options.html?"html":"text"](title),$tip.find(".popover-content").empty()[this.options.html?typeof content=="string"?"html":"append":"text"](content),$tip.removeClass("fade top bottom left right in"),$tip.find(".popover-title").html()||$tip.find(".popover-title").hide()},Popover.prototype.hasContent=function(){return this.getTitle()||this.getContent()},Popover.prototype.getContent=function(){var $e=this.$element,o=this.options;return $e.attr("data-content")||(typeof o.content=="function"?o.content.call($e[0]):o.content)},Popover.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},Popover.prototype.tip=function(){return this.$tip||(this.$tip=$(this.options.template)),this.$tip};var old=$.fn.popover;$.fn.popover=Plugin,$.fn.popover.Constructor=Popover,$.fn.popover.noConflict=function(){return $.fn.popover=old,this}}(jQuery),+function($){"use strict";function ScrollSpy(element,options){var process=$.proxy(this.process,this);this.$body=$("body"),this.$scrollElement=$(element).is("body")?$(window):$(element),this.options=$.extend({},ScrollSpy.DEFAULTS,options),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",process),this.refresh(),this.process()}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.scrollspy"),options=typeof option=="object"&&option;data||$this.data("bs.scrollspy",data=new ScrollSpy(this,options)),typeof option=="string"&&data[option]()})}ScrollSpy.VERSION="3.2.0",ScrollSpy.DEFAULTS={offset:10},ScrollSpy.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},ScrollSpy.prototype.refresh=function(){var offsetMethod="offset",offsetBase=0;$.isWindow(this.$scrollElement[0])||(offsetMethod="position",offsetBase=this.$scrollElement.scrollTop()),this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight();var self=this;this.$body.find(this.selector).map(function(){var $el=$(this),href=$el.data("target")||$el.attr("href"),$href=/^#./.test(href)&&$(decodeURIComponent(href));return $href&&$href.length&&$href.is(":visible")&&[[$href[offsetMethod]().top+offsetBase,href]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){self.offsets.push(this[0]),self.targets.push(this[1])})},ScrollSpy.prototype.process=function(){var scrollTop=this.$scrollElement.scrollTop()+this.options.offset,scrollHeight=this.getScrollHeight(),maxScroll=this.options.offset+scrollHeight-this.$scrollElement.height(),offsets=this.offsets,targets=this.targets,activeTarget=this.activeTarget,i;this.scrollHeight!=scrollHeight&&this.refresh();if(scrollTop>=maxScroll)return activeTarget!=(i=targets[targets.length-1])&&this.activate(i);if(activeTarget&&scrollTop<=offsets[0])return activeTarget!=(i=targets[0])&&this.activate(i);for(i=offsets.length;i--;)activeTarget!=targets[i]&&scrollTop>=offsets[i]&&(!offsets[i+1]||scrollTop<=offsets[i+1])&&this.activate(targets[i])},ScrollSpy.prototype.activate=function(target){this.activeTarget=target,$(this.selector).parentsUntil(this.options.target,".active").removeClass("active");var selector=this.selector+'[data-target="'+target+'"],'+this.selector+'[href="'+target+'"]',active=$(selector).parents("li").addClass("active");active.parent(".dropdown-menu").length&&(active=active.closest("li.dropdown").addClass("active")),active.trigger("activate.bs.scrollspy")};var old=$.fn.scrollspy;$.fn.scrollspy=Plugin,$.fn.scrollspy.Constructor=ScrollSpy,$.fn.scrollspy.noConflict=function(){return $.fn.scrollspy=old,this},$(window).on("load.bs.scrollspy.data-api",function(){$('[data-spy="scroll"]').each(function(){var $spy=$(this);Plugin.call($spy,$spy.data())})})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.tab");data||$this.data("bs.tab",data=new Tab(this)),typeof option=="string"&&data[option]()})}var Tab=function(element){this.element=$(element)};Tab.VERSION="3.2.0",Tab.prototype.show=function(){var $this=this.element,$ul=$this.closest("ul:not(.dropdown-menu)"),selector=$this.data("target");selector||(selector=$this.attr("href"),selector=selector&&selector.replace(/.*(?=#[^\s]*$)/,""));if($this.parent("li").hasClass("active"))return;var previous=$ul.find(".active:last a")[0],e=$.Event("show.bs.tab",{relatedTarget:previous});$this.trigger(e);if(e.isDefaultPrevented())return;var $target=$(selector);this.activate($this.closest("li"),$ul),this.activate($target,$target.parent(),function(){$this.trigger({type:"shown.bs.tab",relatedTarget:previous})})},Tab.prototype.activate=function(element,container,callback){function next(){$active.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),element.addClass("active"),transition?(element[0].offsetWidth,element.addClass("in")):element.removeClass("fade"),element.parent(".dropdown-menu")&&element.closest("li.dropdown").addClass("active"),callback&&callback()}var $active=container.find("> .active"),transition=callback&&$.support.transition&&$active.hasClass("fade");transition?$active.one("bsTransitionEnd",next).emulateTransitionEnd(150):next(),$active.removeClass("in")};var old=$.fn.tab;$.fn.tab=Plugin,$.fn.tab.Constructor=Tab,$.fn.tab.noConflict=function(){return $.fn.tab=old,this},$(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(e){e.preventDefault(),Plugin.call($(this),"show")})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.affix"),options=typeof option=="object"&&option;data||$this.data("bs.affix",data=new Affix(this,options)),typeof option=="string"&&data[option]()})}var Affix=function(element,options){this.options=$.extend({},Affix.DEFAULTS,options),this.$target=$(this.options.target).on("scroll.bs.affix.data-api",$.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",$.proxy(this.checkPositionWithEventLoop,this)),this.$element=$(element),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};Affix.VERSION="3.2.0",Affix.RESET="affix affix-top affix-bottom",Affix.DEFAULTS={offset:0,target:window},Affix.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(Affix.RESET).addClass("affix");var scrollTop=this.$target.scrollTop(),position=this.$element.offset();return this.pinnedOffset=position.top-scrollTop},Affix.prototype.checkPositionWithEventLoop=function(){setTimeout($.proxy(this.checkPosition,this),1)},Affix.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var scrollHeight=$(document).height(),scrollTop=this.$target.scrollTop(),position=this.$element.offset(),offset=this.options.offset,offsetTop=offset.top,offsetBottom=offset.bottom;typeof offset!="object"&&(offsetBottom=offsetTop=offset),typeof offsetTop=="function"&&(offsetTop=offset.top(this.$element)),typeof offsetBottom=="function"&&(offsetBottom=offset.bottom(this.$element));var affix=this.unpin!=null&&scrollTop+this.unpin<=position.top?!1:offsetBottom!=null&&position.top+this.$element.height()>=scrollHeight-offsetBottom?"bottom":offsetTop!=null&&scrollTop<=offsetTop?"top":!1;if(this.affixed===affix)return;this.unpin!=null&&this.$element.css("top","");var affixType="affix"+(affix?"-"+affix:""),e=$.Event(affixType+".bs.affix");this.$element.trigger(e);if(e.isDefaultPrevented())return;this.affixed=affix,this.unpin=affix=="bottom"?this.getPinnedOffset():null,this.$element.removeClass(Affix.RESET).addClass(affixType).trigger($.Event(affixType.replace("affix","affixed"))),affix=="bottom"&&this.$element.offset({top:scrollHeight-this.$element.height()-offsetBottom})};var old=$.fn.affix;$.fn.affix=Plugin,$.fn.affix.Constructor=Affix,$.fn.affix.noConflict=function(){return $.fn.affix=old,this},$(window).on("load",function(){$('[data-spy="affix"]').each(function(){var $spy=$(this),data=$spy.data();data.offset=data.offset||{},data.offsetBottom&&(data.offset.bottom=data.offsetBottom),data.offsetTop&&(data.offset.top=data.offsetTop),Plugin.call($spy,data)})})}(jQuery),function(){var namespace;namespace=ns("analysis"),namespace.inviteAdventCalendar=namespace.wrap([namespace.mixpanel("Invite advent calendar",function(props){return{advent_calendar_id:props.advent_calendar_id,role:props.role}}),namespace.analytics("AdventCalendarInvitation","Invite",function(props){return{eventLabel:props.role}})])}.call(this);var I18n=I18n||{};I18n.addTranslations({en:{js:{models:{AdventCalendarItem:{comment:{message:"Too long: maximum 127"}}}}},ja:{js:{models:{AdventCalendarItem:{comment:{message:"コメントが長過ぎます(最長127文字)"}}}}}}),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("models"),namespace.AdventCalendarItem=function(_super){function AdventCalendarItem(){return AdventCalendarItem.__super__.constructor.apply(this,arguments)}return __extends(AdventCalendarItem,_super),AdventCalendarItem.prototype.validate=function(attrs){if(attrs.comment.length>127)return I18n.t("js.models.AdventCalendarItem.comment.message")},AdventCalendarItem}(Backbone.Model)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views.advent_calendar_items"),namespace.AdventCalendarItemView=function(_super){function AdventCalendarItemView(){return AdventCalendarItemView.__super__.constructor.apply(this,arguments)}return __extends(AdventCalendarItemView,_super),AdventCalendarItemView.prototype.events={"click .js-edit":"edit","click .js-cancel":"cancel"},AdventCalendarItemView.prototype.initialize=function(){return _.bindAll(this,"onSubmit"),this.$("form").on("submit",this.onSubmit),this.model=new Qiita.models.AdventCalendarItem,this.listenTo(this.model,"invalid",this.renderValidationMessage)},AdventCalendarItemView.prototype.edit=function(e){return e.preventDefault(),this.$el.addClass("editing")},AdventCalendarItemView.prototype.cancel=function(e){return e.preventDefault(),this.$el.removeClass("editing")},AdventCalendarItemView.prototype.renderValidationMessage=function(){return this.$(".validation-error").text(this.model.validationError).addClass("active")},AdventCalendarItemView.prototype.onSubmit=function(e){this.model.set(this.getValues());if(!this.model.isValid())return e.preventDefault()},AdventCalendarItemView.prototype.getValues=function(){return this.$("form").formData().advent_calendar_item},AdventCalendarItemView}(Backbone.View)}.call(this),function(){var IS_STAGING,domain;IS_STAGING=/staging\.qiita\.com$/.test(location.hostname),domain=""+(IS_STAGING?"staging.":"")+"qiita."+Qiita.TLD,ns("ttSources").publicUsersSource=new Bloodhound({remote:{url:"//"+domain+"/api/users?q=%QUERY",maxParallelRequests:1,beforeSend:function(jqXhr,settings){return settings.xhrFields={withCredentials:!0}},filter:function(resp){var url_names;return url_names=Qiita.db.users.pluck("url_name"),_.chain(resp).reject(function(datum){return _.contains(url_names,datum.url_name)}).map(function(datum){return{value:datum.url_name,tokens:[datum.url_name],iconUrl:datum.profile_image_url}}).value()}},datumTokenizer:function(d){return Bloodhound.tokenizers.whitespace(d.num)},queryTokenizer:Bloodhound.tokenizers.whitespace})}.call(this),function(){var AdventCalendarsRouter,__hasProp={}.hasOwnProperty
,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};AdventCalendarsRouter=function(_super){function AdventCalendarsRouter(){return AdventCalendarsRouter.__super__.constructor.apply(this,arguments)}return __extends(AdventCalendarsRouter,_super),AdventCalendarsRouter.prototype.routes={"advent-calendar/:year/:name":"show"},AdventCalendarsRouter.prototype.show=function(year,name){var match;if(!Qiita.user)return $(".js-adventCalendar_button-join").on("click",function(){var view;return view=new Qiita.views.LoginModalView({type:"AdventCalendarJoinView",action:"participate",target:$(this).data("day")}),view.render().$el.appendTo("body")});$(".js-adventCalendar_button-join").on("click",function(){var day;return day=$(this).data("day"),$("#advent_calendar_item_date").val(day),$(".js-title-day").text(day)}),$(".js-adventCalendar_button-leave").on("click",function(){var $button;return $button=$(this),$(".js-modal-leave").find(".js-adventCalendar_button-delete").attr("href",""+$button.data("calendar")+"/day/"+$button.data("day"))}),$(".js-adventCalendar_button-cancel").on("click",function(){var $button;return $button=$(this),$button.closest(".js-modal").modal("hide"),!1});if(match=location.search.match(/day=(\d+)/))return $(".js-adventCalendar_button-join[data-day="+match[1]+"]").click()},AdventCalendarsRouter}(Backbone.Router),new AdventCalendarsRouter}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};ns("views").ApiV2ConsoleView=function(_super){function ApiV2ConsoleView(){return ApiV2ConsoleView.__super__.constructor.apply(this,arguments)}var LOCAL_STORAGE_KEY;return __extends(ApiV2ConsoleView,_super),LOCAL_STORAGE_KEY="lastUsedAccessToken",ApiV2ConsoleView.prototype.initialize=function(){this.$accessTokenInputElement=this.$(".js-accessToken"),this.$pathInputElement=this.$(".js-path"),this.$responseElement=this.$(".js-response"),this.$responseElement.hide();if(this.$accessTokenInputElement.val()==="")return this.$accessTokenInputElement.val(Qiita.store.get(LOCAL_STORAGE_KEY))},ApiV2ConsoleView.prototype.el=".js-apiV2Console",ApiV2ConsoleView.prototype.events={"ajax:before":function(){return Qiita.store.set(LOCAL_STORAGE_KEY,this.$accessTokenInputElement.val()),Backbone.history.navigate(""+location.pathname+"?path="+this.$pathInputElement.val())},"ajax:success":function(event,data,status,xhr){return this.$responseElement.show().text(data.formatted_result)}},ApiV2ConsoleView}(Backbone.View)}.call(this),function(){var ConsolesRouter,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};if(Qiita.controller!=="consoles")return;ConsolesRouter=function(_super){function ConsolesRouter(){return ConsolesRouter.__super__.constructor.apply(this,arguments)}return __extends(ConsolesRouter,_super),ConsolesRouter.prototype.routes={"api/v2/console":"show"},ConsolesRouter.prototype.show=function(){return new(ns("views").ApiV2ConsoleView)},ConsolesRouter}(Backbone.Router),new ConsolesRouter}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.ScrollChaserView=function(_super){function ScrollChaserView(){return ScrollChaserView.__super__.constructor.apply(this,arguments)}return __extends(ScrollChaserView,_super),ScrollChaserView.prototype.el=".js-scroll-chaser-container",ScrollChaserView.prototype.initialize=function(){return this.$el.find(".js-scroll-chaser-fixed").scrollChaser({wrapper:this.$el})},ScrollChaserView}(Backbone.View)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.DeveloperPageView=function(_super){function DeveloperPageView(){return DeveloperPageView.__super__.constructor.apply(this,arguments)}var WIDTH_FOR_DOUBLE_COLUMNS;return __extends(DeveloperPageView,_super),WIDTH_FOR_DOUBLE_COLUMNS=768,DeveloperPageView.prototype.initialize=function(){if(this._isScrollChasable())return new Qiita.views.ScrollChaserView},DeveloperPageView.prototype._isScrollChasable=function(){return window.innerWidth>=WIDTH_FOR_DOUBLE_COLUMNS},DeveloperPageView}(Backbone.View)}.call(this),function(){var DocsRouter,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};if(Qiita.controller!=="docs")return;DocsRouter=function(_super){function DocsRouter(){return DocsRouter.__super__.constructor.apply(this,arguments)}return __extends(DocsRouter,_super),DocsRouter.prototype.routes={"api/v2/docs":"show"},DocsRouter.prototype.show=function(){return new Qiita.views.DeveloperPageView},DocsRouter}(Backbone.Router),new DocsRouter}.call(this),function(){var DocsRouter,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};if(Qiita.controller!=="docs")return;DocsRouter=function(_super){function DocsRouter(){return DocsRouter.__super__.constructor.apply(this,arguments)}return __extends(DocsRouter,_super),DocsRouter.prototype.routes={"api/v1/docs":"api","api/webhook/docs":"webhook"},DocsRouter.prototype.api=function(){return this._setUpToc(),new Qiita.views.DeveloperPageView},DocsRouter.prototype.webhook=function(){return this._setUpToc(),new Qiita.views.DeveloperPageView},DocsRouter.prototype._setUpToc=function(){return $(".js-markdown h2").each(function(idx){var anchorLink,list,text;return $(this).attr("id",idx),text=$(this).text(),anchorLink=$("<a>",{href:"#"+idx}).text(text),list=$("<li>").append(anchorLink),$(".js-toc").append(list)})},DocsRouter}(Backbone.Router),new DocsRouter}.call(this),function(){var namespace;namespace=ns("models.concerns"),namespace.Previewable={previewable:!0,_previewDeferreds:null,_previewCache:null,_previewingRawBody:null,initializePreviewable:function(){return this._previewDeferreds=[],this._previewCache={},_.bindAll(this,"_previewDone","_previewFail","_previewAlways")},fetchPreview:function(){var dfd;return dfd=$.Deferred(),this._previewDeferreds.push(dfd),this._previewingRawBody||(this._previewCache[this.get("raw_body")]?this._previewDone(this._previewCache[this.get("raw_body")]):(this._previewingRawBody=this.get("raw_body"),this._callPreviewAPI())),dfd.promise()},_callPreviewAPI:function(){var data;return data={raw_body:this.get("raw_body")},$.ajax({type:"post",url:"/api/preview",data:data}).done(this._previewDone).fail(this._previewFail).always(this._previewAlways)},_previewDone:function(html){return this._previewCache[this._previewingRawBody]=html,_.each(this._previewDeferreds,function(deferred){return deferred.resolve(html)}),this.set("body",html)},_previewFail:function(){return _.each(this._previewDeferreds,function(deferred){return deferred.reject()}),this.unset("body"),this.trigger("error:preview")},_previewAlways:function(){return _.defer(function(_this){return function(){return _this._previewDeferreds=[],_this._previewingRawBody=null}}(this))}}}.call(this),function(){var namespace;namespace=ns("validators"),namespace.Validator=function(){function Validator(){this.i18nScope="js.validators."+this.CLASSNAME}return Validator.prototype.commonRuleNames=[],Validator.prototype.teamRuleNames=[],Validator.prototype.publicRuleNames=[],Validator.validate=function(model){var validator;return validator=new this,validator.validate(model)},Validator.prototype.validate=function(model){var errors;return this.model=model,errors=_.reduce(this._ruleNames(),this._iter,[],this),errors.length?errors:null},Validator.prototype.t=function(name,args){return I18n.t(""+this.i18nScope+"."+name,args)},Validator.prototype._ruleNames=function(){var ruleNames;return ruleNames=Qiita.teamName?this.teamRuleNames:this.publicRuleNames,this.commonRuleNames.concat(ruleNames)},Validator.prototype._iter=function(errors,ruleName){var error;if(error=this[ruleName](this.model))_.isArray(error)?errors.push.apply(errors,error):errors.push(error);return errors},Validator}()}.call(this);var I18n=I18n||{};I18n.addTranslations({en:{js:{validators:{TagDatumValidator:{name_too_long:"Tag name is too long (must be equal to or less than {{maximum}} characters).",contains_invalid_symbol:"Tag name cannot contain empty char or colon.",cannot_start_with_slash:"Tag name cannot start with slash.",cannot_end_with_slash:"Tag name cannot end with slash.",cannot_end_with_backslash:"Tag name cannot end with slash.",cannot_end_with_items:"Tag name cannot end with '/items'.",cannot_use_slash:"Tag name cannot contain slash.",cannot_use_backslash:"Tag name cannot contain backslash.",cannot_use_sequential_slash:"Tag name cannot contain sequential slashes."}}}},ja:{js:{validators:{TagDatumValidator:{name_too_long:"タグが長過ぎます（{{maximum}}文字まで）。",contains_invalid_symbol:"タグに空文字やコロンを含めることはできません。",cannot_start_with_slash:"タグはスラッシュで始めることはできません。",cannot_end_with_slash:"タグをスラッシュで終えることはできません。",cannot_end_with_backslash:"タグをバックスラッシュで終えることはできません。",cannot_end_with_items:"タグを '/items' で終えることはできません。",cannot_use_slash:"タグにスラッシュを含めることはできません。",cannot_use_backslash:"タグにバックスラッシュを含めることはできません。",cannot_use_sequential_slash:"タグに連続したスラッシュを含めることはできません。"}}}}}),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("validators"),namespace.TagDatumValidator=function(_super){function TagDatumValidator(){return TagDatumValidator.__super__.constructor.apply(this,arguments)}return __extends(TagDatumValidator,_super),TagDatumValidator.prototype.CLASSNAME="TagDatumValidator",TagDatumValidator.prototype.commonRuleNames=["nameTooLong","containsInvalidSymbol"],TagDatumValidator.prototype.teamRuleNames=["cannotEndWithBackslash","cannotStartWithSlash","cannotEndWithSlash","cannotEndWithItems","cannotUseSequentialSlash"],TagDatumValidator.prototype.publicRuleNames=["cannotUseBackslash","cannotUseSlash"],TagDatumValidator.prototype.nameTooLong=function(tagDatum){if(tagDatum.name.length>30||encodeURI(tagDatum.name).length>512)return{message:this.t("name_too_long",{maximum:30})}},TagDatumValidator.prototype.containsInvalidSymbol=function(tagDatum){if(/[<>;:"'\s]/.test(tagDatum.name))return{message:this.t("contains_invalid_symbol")}},TagDatumValidator.prototype.cannotStartWithSlash=function(tagDatum){if(/^\//.test(tagDatum.name))return{message:this.t("cannot_start_with_slash")}},TagDatumValidator.prototype.cannotEndWithSlash=function(tagDatum){if(/\/$/.test(tagDatum.name))return{message:this.t("cannot_end_with_slash")}},TagDatumValidator.prototype.cannotEndWithBackslash=function(tagDatum){if(/\\$/.test(tagDatum.name))return{message:this.t("cannot_end_with_backslash")}},TagDatumValidator.prototype.cannotEndWithItems=function(tagDatum){if(/\/items$/.test(tagDatum.name))return{message:this.t("cannot_end_with_items")}},TagDatumValidator.prototype.cannotUseSlash=function(tagDatum){if(/\//.test(tagDatum.name))return{message:this.t("cannot_use_slash")}},TagDatumValidator.prototype.cannotUseBackslash=function(tagDatum){if(/\\/.test(tagDatum.name))return{message:this.t("cannot_use_backslash")}},TagDatumValidator.prototype.cannotUseSequentialSlash=function(tagDatum){if(/\/\//.test(tagDatum.name))return{message:this.t("cannot_use_sequential_slash")}},TagDatumValidator}(namespace.Validator)}.call(this);var I18n=I18n||{};I18n.addTranslations({en:{js:{validators:{TagDataValidator:{empty:"Tag cannot be empty.",invalid_syntax:"Invalid tag notation: “{{invalid_character}}”.",please_specify_up_to_five_tags:"Please specify up to 5 tags."}}}},ja:{js:{validators:{TagDataValidator:{empty:"タグを空にすることはできません。",invalid_syntax:"タグの記法が間違っています。 “{{invalid_character}}” が不正です。",please_specify_up_to_five_tags:"タグは5つ以内で指定してください。"}}}}}),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("validators"),namespace.TagDataValidator=function(_super){function TagDataValidator(){return TagDataValidator.__super__.constructor.apply(this,arguments)}var MAX_COUNT;return __extends(TagDataValidator,_super),TagDataValidator.prototype.CLASSNAME="TagDataValidator",MAX_COUNT=5,TagDataValidator.prototype.commonRuleNames=["countValidation","tagDatumValidations","syntaxValidation"],TagDataValidator.prototype.publicRuleNames=["presence"],TagDataValidator.prototype.presence=function(tagData){if(_.filter(tagData||[],function(datum){return datum.name}).length===0)return{name:"tag_data",message:this.t("empty")}},TagDataValidator.prototype.countValidation=function(tagData){return tagData.length>MAX_COUNT?{name:"tag_data",message:this.t("please_specify_up_to_five_tags")}:null},TagDataValidator.prototype.tagDatumValidations=function(tagData){var errors,validator;validator=new namespace.TagDatumValidator,errors=_.chain(tagData).map(function(tagDatum){return validator.validate(tagDatum)}).flatten().compact().value();if(errors.length)return{name:"tag_data",message:_.pluck(errors,"message").join(" ")}},TagDataValidator.prototype.syntaxValidation=function(tagData){var invalidCharacter;return tagData.syntaxError?(invalidCharacter=tagData.notation.substr(tagData.syntaxError.column-1,1),{name:"tag_data",message:this.t("invalid_syntax",{invalid_character:invalidCharacter})}):null},TagDataValidator}(namespace.Validator)}.call(this);var I18n=I18n||{};I18n.addTranslations({en:{js:{validators:{AbstractArticleValidator:{title:{cannot_be_empty:"Title is required.",too_long:"Title is too long (maximum is %{count} characters)."},raw_body:{cannot_be_empty:"Body is required."}}}}},ja:{js:{validators:{AbstractArticleValidator:{title:{cannot_be_empty:"タイトルは必須です。",too_long:"タイトルは %{count} 文字以内で入力してください。"},raw_body:{cannot_be_empty:"本文は必須です。"}}}}}}),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("validators"),namespace.AbstractArticleValidator=function(_super){function AbstractArticleValidator(){return AbstractArticleValidator.__super__.constructor.apply(this,arguments)}return __extends(AbstractArticleValidator,_super),AbstractArticleValidator.prototype.CLASSNAME="AbstractArticleValidator",AbstractArticleValidator.prototype.EMPTY_REGEXP=/^\s*$/,AbstractArticleValidator.prototype.commonRuleNames=["titleCannotBeEmpty","titleLength","tagDataValidations","rawBodyCannotBeEmpty"],AbstractArticleValidator.prototype.titleCannotBeEmpty=function(item){if(this.EMPTY_REGEXP.test(item.title))return{name:"title",message:this.t("title.cannot_be_empty")}},AbstractArticleValidator.prototype.titleLength=function(item){if(item.title.length>255)return{name:"title",message:this.t("title.too_long",{count:255})}},AbstractArticleValidator.prototype.rawBodyCannotBeEmpty=function(item){if(this.EMPTY_REGEXP.test(item.raw_body))return{name:"raw_body",message:this.t("raw_body.cannot_be_empty")}},AbstractArticleValidator.prototype.tagDataValidations=function(item){var errors;if(errors=namespace.TagDataValidator.validate(item.tag_data))return{name:"tag_data",message:_.pluck(errors,"message").join(" ")}},AbstractArticleValidator}(namespace.Validator)}.call(this);var namespace=ns("util");namespace.mixin=function(Class){"use strict";var proto=Class.prototype;return _.chain(arguments).rest(1).each(function(Mixin){if(!Mixin)return;_.each(Mixin,function(value,prop){var prev=proto[prop];prev?_.isFunction(value)?_.isFunction(prev)?proto[prop]=function(){prev.apply(this,arguments),value.apply(this,arguments)}:(proto[prop]=value,_.extend(proto[prop],prev)):_.extend(prev,value):proto[prop]=value})}),Class},function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("models"),namespace.AbstractArticle=function(_super){function AbstractArticle(){return AbstractArticle.__super__.constructor.apply(this,arguments)}return __extends(AbstractArticle,_super),AbstractArticle.prototype.initialize=function(){return this.initializePreviewable()},AbstractArticle.prototype.validate=function(attrs){return Qiita.validators.AbstractArticleValidator.validate(attrs)},AbstractArticle.prototype.toJSON=function(){return this.pick("title","raw_body","tag_data")},AbstractArticle}(Backbone.Model),Qiita.util.mixin(namespace.AbstractArticle,namespace.concerns.Previewable)}.call(this),function(){var namespace;namespace=ns("models.concerns"),namespace.Comparable={comparable:!0,_compareDeferreds:null,_compareCache:null,_comparingRawBody:null,initializeComparable:function(){return this._compareDeferreds=[],this._compareCache={},_.bindAll(this,"_compareDone","_compareFail","_compareAlways")},fetchDiff:function(){var dfd;return dfd=$.Deferred(),this._compareDeferreds.push(dfd),this._comparingRawBody||(this._compareCache[this.get("raw_body")]?this._compareDone(this._compareCache[this.get("raw_body")]):(this._comparingRawBody=this.get("raw_body"),this._callDiffAPI())),dfd.promise()},_callDiffAPI:function(){var data;return data={text:this.get("raw_body")},$.ajax({type:"post",url:""+this.url()+"/diff",data:data}).done(this._compareDone).fail(this._compareFail).always(this._compareAlways)},_compareDone:function(html){return this._compareCache[this._comparingRawBody]=html,_.each(this._compareDeferreds,function(deferred){return deferred.resolve(html)}),this.set("diff",html)},_compareFail:function(){return _.each(this._compareDeferreds,function(deferred){return deferred.reject()}),this.unset("diff"),this.trigger("error:diff")},_compareAlways:function(){return _.defer(function(_this){return function(){return _this._compareDeferreds=[],_this._comparingRawBody=null}}(this))}}}.call(this),function(){var namespace;namespace=ns("validators"),namespace.DraftItemValidator=namespace.AbstractArticleValidator}.call(this);var I18n=I18n||{};I18n.addTranslations({en:{js:{models:{DraftItem:{comment:{required:"Comment is required."}}}}},ja:{js:{models:{DraftItem:{comment:{required:"コメントを入力してください"}}}}}}),function(){var namespace;namespace=ns("util.promises"),namespace.resolved=function(){var promise;return promise=$.Deferred(),promise.resolve.apply(promise,arguments),promise},namespace.rejected=function(){var promise;return promise=$.Deferred(),promise.reject.apply(promise,arguments),promise}}.call(this),function(){var namespace,promises,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("models"),promises=Qiita.util.promises,namespace.DraftItem=function(_super){function DraftItem(){return DraftItem.__super__.constructor.apply(this,arguments)}var CREATING,EDITING,MERGING,NAMESPACE,PATCHING;return __extends(DraftItem,_super),CREATING=1,EDITING=2,PATCHING=3,MERGING=4,NAMESPACE="js.models.DraftItem.",DraftItem.prototype.editing=!1,DraftItem.prototype.idAttribute="item_uuid",DraftItem.prototype.urlRoot="/drafts",DraftItem.prototype.initialize=function(){return DraftItem.__super__.initialize.apply(this,arguments),this.initializeComparable(),this.diffs={},this.previews={},this.on("sync",this.takeSnapShot,this),this.takeSnapShot()},DraftItem.prototype.validate=function(attrs,options){var errors;return errors=Qiita.validators.DraftItemValidator.validate(attrs),this.isPatching()&&(options!=null?!options.comment:!void 0)&&(errors==null&&(errors=[]),errors.push({name:"comment",message:I18n.t(""+NAMESPACE+"comment.required")})),errors},DraftItem.prototype.escape=function(name){var datum,tag_data,versions,_i,_len,_ref;if(name==="tag_data"){tag_data=[],_ref=this.get("tag_data");for(_i=0,_len=_ref.length;_i<_len;_i++){datum=_ref[_i];if(!datum)continue;name=datum.name,versions=datum.versions,tag_data.push({name:_.escape(name),versions:versions?_.map(versions,function(version){return _.escape(version)}):[]})}return tag_data}return DraftItem.__super__.escape.apply(this,arguments)},DraftItem.prototype.toJSON=function(options){var datum,json,opts,_i,_len,_ref;json=this.pick("title","raw_body","tag_data");if(json.tag_data){_ref=json.tag_data;for(_i=0,_len=_ref.length;_i<_len;_i++)datum=_ref[_i],datum.versions||(datum.versions=[])}return this.isCreating()&&(json.secret=this.get("secret")),options?(opts={},options.comment&&(opts.comment=options.comment),options.create_update_notification&&(opts.create_update_notification=options.create_update_notification),options.tweet&&(opts.tweet=!0),options.gist&&(opts.gist=!0),{publish:!!options.publish,draft_item:json,options:opts}):json},DraftItem.prototype.save=function(attrs,options){var promise,willUpdated;return attrs==null&&(attrs={}),options==null&&(options={}),willUpdated=!options.publish&&!this.isNew(),willUpdated&&(options.silent=!0),(promise=DraftItem.__super__.save.call(this,attrs,options))&&willUpdated&&promise.done(function(_this){return function(){return _this.set({save_count:_this.get("save_count")+1,updated_at:new Date})}}(this)),promise},DraftItem.prototype.parse=function(repr){return repr&&(repr.raw_body&&(repr.raw_body=repr.raw_body.replace(/&#39;/g,"'")),repr.title&&(repr.title=repr.title.replace(/&#39;/g,"'")),repr.updated_at=repr.updated_at?new Date(repr.updated_at):new Date),repr},DraftItem.prototype.isCreating=function(){return this.get("type_int")===CREATING},DraftItem.prototype.isEditing=function(){return this.get("type_int")===EDITING},DraftItem.prototype.isPatching=function(){return this.get("type_int")===PATCHING},DraftItem.prototype.isMerging=function(){return this.get("type_int")===MERGING},DraftItem.prototype.getType=function(){switch(this.get("type_int")){case CREATING:return"creating";case EDITING:return"editing";case PATCHING:return"patching";case MERGING:return"merging"}},DraftItem.prototype.takeSnapShot=function(){return this.initAttributes=this.toJSON()},DraftItem.prototype.hasChangedFromInitAttrs=function(attrs){var fields;return fields=["title","tag_data","raw_body"],!_.isEqual(_.pick(this.initAttributes,fields),_.pick(attrs,fields))},DraftItem}(namespace.AbstractArticle),Qiita.util.mixin(namespace.DraftItem,namespace.concerns.Comparable)}.call(this),function(){var KEY,namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views.draft_items"),KEY="DraftItemForm:initAction",Qiita.currentTeam&&(KEY+=Qiita.currentTeam.id),namespace.FormActionsView=function(_super){function FormActionsView(){return FormActionsView.__super__.constructor.apply(this,arguments)}return __extends(FormActionsView,_super),FormActionsView.prototype.el=".js-submitButtonWrapper",FormActionsView.prototype.submitType=null,FormActionsView.prototype.events={"click .js-dropdownButton":"toggleDropdown","click .js-dropdownMenu a":"clickDropdownItem","click .js-dropdownMenu":function(e){return e.originalEvent[this.cid]=!0}},FormActionsView.prototype.initialize=function(){var initAction;return this.bindEventListeners(),initAction=$("[href=#"+Qiita.store.get(KEY)+"]").length?Qiita.store.get(KEY):"post",this.switchSubmitButton(initAction)},FormActionsView.prototype.clickDropdownItem=function(e){return e.preventDefault(),this.switchSubmitButton($(e.currentTarget).attr("href").substr(1))},FormActionsView.prototype.toggleDropdown=function(e){return e.originalEvent[this.cid]=!0,this.$(".js-dropdownMenu").toggleClass("active")},FormActionsView.prototype.closeDropdown=function(){return this.$(".js-dropdownMenu").removeClass("active")},FormActionsView.prototype.switchSubmitButton=function(submitType){return this.$(".active").removeClass("active"),this.$("[href='#"+submitType+"']").addClass("active"),this.$("#"+submitType).addClass("active"),this.setSubmitType(submitType),this.closeDropdown()},FormActionsView.prototype.setSubmitType=function(value){return this.submitType=value,Qiita.store.set(KEY,value),$("#draft_item_secret").val(value==="secret-post"?1:0),$("#draft_item_publish").val(value==="save"?"":1),$("#draft_item_coediting").val(value==="coediting-post"?1:0)},FormActionsView.prototype.bindEventListeners=function(){return this.listenTo(Backbone,"click",function(_this){return function(e){var _ref;if((_ref=e.originalEvent)!=null?!_ref[_this.cid]:!void 0)return _this.closeDropdown()}}(this))},FormActionsView}(Backbone.View)}.call(this),function(){var namespace;namespace=ns("analysis"),namespace.saveDraftItem=namespace.wrap([namespace.mixpanel("Save a draft item",function(props){return{action:"save",type:props.type}}),namespace.analytics("DraftItem","Save",function(props){return{eventLabel:props.label}})])}.call(this),function(){var analytics,favorableActionFactory,mixpanel,namespace,wrap;namespace=ns("analysis"),mixpanel=namespace.mixpanel,analytics=namespace.analytics,wrap=namespace.wrap,favorableActionFactory=namespace.favorableActionFactory,namespace.submitDraftItem=function(props){var dfd;switch(props.type){case"creating":return wrap([favorableActionFactory("Post an item"),mixpanel("Save a draft item",function(props){return{action:"publish",type:props.type,url_name:Qiita.user.url_name}}),mixpanel("Post an item",function(props){return{github:props.github,"private":!!props.secret,tags_count:props.tagsCount,twitter:props.twitter,first:Qiita.user.first,first_web:Qiita.user.firstWeb}}),analytics("Item","Create",function(props){return{eventLabel:props.secret?"Private":"Public"}})])(props);case"editing":return wrap([favorableActionFactory("Update an item"),mixpanel("Save a draft item",function(props){return{action:"publish",type:props.type,url_name:Qiita.user.url_name}}),analytics("Item","Update",function(props){return{eventLabel:props.secret?"Private":"Public"}})])(props);case"patching":return wrap([favorableActionFactory("Send a Patch"),mixpanel("Save a draft item",function(props){return{action:"publish",type:props.type,url_name:Qiita.user.url_name}}),analytics("Patch","Create")])(props);case"marging":return dfd=$.Deferred(),dfd.resolve(),dfd.promise()}}}.call(this),function(){this.JST||(this.JST={}),this.JST["t/emoji_picker"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="emojiPicker_topBar js-topBar">\n  <span class="close"><i class="fa fa-times"></i></span>\n</div>\n<ul class="nav nav-tabs emojiPicker_tabs">\n  <li>\n    <a href="#',presenter.idWith("people"),'" data-toggle="tab" data-url="/emoji/people.txt">\n      <img src="//cdn.qiita.com/emoji/smile.png"/>\n    </a>\n  </li>\n  <li>\n    <a href="#',presenter.idWith("nature"),'" data-toggle="tab" data-url="/emoji/nature.txt">\n      <img src="//cdn.qiita.com/emoji/sunny.png"/>\n    </a>\n  </li>\n  <li>\n    <a href="#',presenter.idWith("objects"),'" data-toggle="tab" data-url="/emoji/objects.txt">\n      <img src="//cdn.qiita.com/emoji/tada.png"/>\n    </a>\n  </li>\n  <li>\n    <a href="#',presenter.idWith("places"),'" data-toggle="tab" data-url="/emoji/places.txt">\n      <img src="//cdn.qiita.com/emoji/house.png"/>\n    </a>\n  </li>\n  <li>\n    <a href="#',presenter.idWith("symbols"),'" data-toggle="tab" data-url="/emoji/symbols.txt">\n      <img src="//cdn.qiita.com/emoji/a.png"/>\n    </a>\n  </li>\n</ul>\n<div class="tab-content">\n  <div id="',presenter.idWith("people"),'" class="tab-pane"></div>\n  <div id="',presenter.idWith("nature"),'" class="tab-pane"></div>\n  <div id="',presenter.idWith("objects"),'" class="tab-pane"></div>\n  <div id="',presenter.idWith("places"),'" class="tab-pane"></div>\n  <div id="',presenter.idWith("symbols"),'" class="tab-pane"></div>\n</div>\n<div class="emojiPicker_preview">\n</div>\n');return __p.join("")}}.call(this),function(){var namespace;namespace=ns("mixins"),namespace.Draggable={draggable:!0,_initPosition:{elX:null,elY:null,mouseX:null,mouseY:null},_dragging:!1,_dname:null,initializeDraggable:function(position){return this._dname="draggable"+this.cid,$(document).on("mousemove."+this._dname,_.bind(this._dragMove,this)).on("mouseup."+this._dname,_.bind(this._dragEnd,this))},removeDraggable:function(){return $(document).off("."+this._dname)},dragStart:function(e){return this._caribrate(e),this._dragging=!0},_dragMove:_.throttle(function(e){if(!this._dragging)return;return this._followDrag(e)},20),_dragEnd:function(){return this._dragging=!1},_caribrate:function(e){var offset;return offset=this.$el.position(),this._initPosition.elX=offset.left,this._initPosition.elY=offset.top,this._initPosition.mouseX=e.clientX,this._initPosition.mouseY=e.clientY},_followDrag:function(e){var diffX,diffY;return diffX=e.clientX-this._initPosition.mouseX,diffY=e.clientY-this._initPosition.mouseY,this.$el.css({top:this._initPosition.elY+diffY,left:this._initPosition.elX+diffX})}}}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.EmojiPickerView=function(_super){function EmojiPickerView(){return EmojiPickerView.__super__.constructor.apply(this,arguments)}return __extends(EmojiPickerView,_super),EmojiPickerView.prototype.className="emojiPicker",EmojiPickerView.prototype.events={"click .close":"hide","click .js-item":"onClickEmoji","mouseover .js-item":"onMouseOver","mousedown .js-topBar":"dragStart"},EmojiPickerView.prototype.initialize=function(options){return options==null&&(options={}),this.textarea=options.textarea,this.bindEventListeners(),this.initializeDraggable()},EmojiPickerView.prototype.remove=function(){return this.removeDraggable(),EmojiPickerView.__super__.remove.apply(this,arguments)},EmojiPickerView.prototype.render=function(){return this.$el.html(JST["t/emoji_picker"]({presenter:this})).hide(),this.assignElements(),this},EmojiPickerView.prototype.loadRemotePane=function(e){var $tab;if(($tab=$(e.target)).data("loaded"))return;return $.ajax({url:$tab.data("url"),type:"GET"}).done(function(_this){return function(emojis){var html;return emojis=_.compact(emojis.split("\n")),html=_.map(emojis,function(emoji){return'<span class="js-item" data-emoji="'+emoji+'">\n  <img class="emojiPicker_icon" src="'+_this.link(emoji)+'"/>\n</span>'}).join(""),_this.$($tab.attr("href")).html(html),$tab.data("loaded",!0)}}(this))},EmojiPickerView.prototype.onClickEmoji=function(e){return this.insertEmoji($(e.currentTarget).data("emoji"))},EmojiPickerView.prototype.onMouseOver=function(e){return this.previewEmoji($(e.currentTarget).data("emoji"))},EmojiPickerView.prototype.insertEmoji=function(emoji){var post
,pre,selectionEnd;return emoji=":"+emoji+": ",selectionEnd=this.textarea.selectionEnd,pre=this.textarea.value.substring(0,selectionEnd),post=this.textarea.value.substring(selectionEnd),pre!==""&&!_.include([" ","\n"],pre.charAt(pre.length-1))&&(emoji=" "+emoji),post.charAt(0)===" "&&(post=post.substr(1)),this.textarea.value=""+pre+emoji+post,this.textarea.selectionStart=this.textarea.selectionEnd=pre.length+emoji.length,this.trigger("pick")},EmojiPickerView.prototype.previewEmoji=function(emoji){return this.$preview.html('<img src="'+this.link(emoji)+'"/>\n<span>:'+emoji+":</span>")},EmojiPickerView.prototype.toggle=function(){return this.$("a:first").tab("show"),this.$el.toggle()},EmojiPickerView.prototype.hide=function(){return this.$el.hide()},EmojiPickerView.prototype.idWith=function(suffix){return""+this.cid+"-"+suffix},EmojiPickerView.prototype.link=function(emoji){return"https://cdn.qiita.com/emoji/"+encodeURIComponent(emoji)+".png"},EmojiPickerView.prototype.bindEventListeners=function(){return this.$el.on("show.bs.tab",_.bind(this.loadRemotePane,this))},EmojiPickerView.prototype.assignElements=function(){return this.$preview=this.$(".emojiPicker_preview")},EmojiPickerView}(Backbone.View),Qiita.util.mixin(namespace.EmojiPickerView,Qiita.mixins.Draggable)}.call(this),function(){Qiita.MathJaxHelper={run:function($el){var outputElems;if(!$el.find('[data-lang="math"]').length&&!/\$[^\$\n]*\$/.test($el.text()))return;return outputElems=this.prepareOutputElements($el),this.compile($el).done(function(){var $output,_i,_len,_results;if(!outputElems.length)return;$el.find('[data-lang="math"]').remove(),_results=[];for(_i=0,_len=outputElems.length;_i<_len;_i++)$output=outputElems[_i],_results.push($output.css("visibility",""));return _results})},compile:function($el){var dfd;return dfd=$.Deferred(),this.load().done(function(MathJax){return MathJax.Hub.Queue(function(){return MathJax.Hub.config.elements=[$el[0]],MathJax.Hub.Typeset(null,function(){return dfd.resolve()})})}),dfd.promise()},prepareOutputElements:function($el){var outputElems;return outputElems=[],$el.find('[data-lang="math"]').each(function(){var $code,$output;return $code=$(this),$output=$("<div style='visibility: hidden'>$${"+_.escape($code.find("pre").text())+"}$$</div>"),outputElems.push($output),$code.after($output)}),outputElems},state:"",load:function(){var promise,script;return this.state===""?(this.dfd=$.Deferred(),promise=this.dfd.promise(),this.config(),script=document.createElement("script"),script.src="https://cdn.qiita.com/MathJax/2.3/MathJax.js?config=TeX-AMS_HTML-full,Safe",document.getElementsByTagName("head")[0].appendChild(script),this.state="loading",this.checkLoaded(100)):this.state!=="ready"?promise=this.dfd.promise():(this.dfd=$.Deferred(),promise=this.dfd.promise(),this.dfd.resolve(MathJax)),promise},loaded:function(){return MathJax.isReady?(this.state="ready",this.dfd.resolve(MathJax)):(this.state="loaded",MathJax.Hub.Register.StartupHook("End",function(_this){return function(){return _this.state="ready",_this.dfd.resolve(MathJax)}}(this)))},config:function(options){var script;options==null&&(options={});if(window.MathJax)return;return script=document.createElement("script"),script.type="text/x-mathjax-config",script[window.opera?"innerHTML":"text"]="MathJax.Hub.Config({ skipStartupTypeset: true, showProcessingMessages: false, tex2jax: { inlineMath: [['$', '$']], displayMath: [['$$', '$$']], processEscapes: true, processEnvironments: false, processRefs: false, skipTags: ['script','noscript','style','textarea','pre','code','a','h1','h2','h3','h4','h5','h6'] } })",$("head").append(script)},checkLoaded:function(wait){return setTimeout(function(_this){return function(){if(window.MathJax)return _this.loaded();if(wait<5e3)return _this.checkLoaded(wait*2)}}(this),wait)}}}.call(this),function(){var INDENT,LIST_REGEXP,namespace;namespace=ns("mixins"),LIST_REGEXP=/^(\s*)(-|\+|\*|\d+\.)(\s+)(.*)/,INDENT=4,namespace.AutoindentMixin={bindMixin:function(){return this.$textarea==null&&(this.$textarea=this.$("textarea")),this.textarea==null&&(this.textarea=this.$textarea.get(0)),this.$textarea.on({"keydown.autoindent":_.bind(this.autoIndent,this),"textComplete:show.autoindent":function(_this){return function(){return _this.autoCompleting=!0}}(this),"textComplete:hide.autoindent":function(_this){return function(){return _this.autoCompleting=!1}}(this)})},unbindMixin:function(){var _ref;return(_ref=this.$textarea)!=null&&_ref.off(".autoindent"),this.$textarea=this.textarea=null},autoIndent:function(e){if(this.autoCompleting)return;if(this.textarea.selectionStart!==this.textarea.selectionEnd)return;switch(e.keyCode){case 13:return this.onPressEnter(e);case 9:return this.onPressTab(e)}},onPressEnter:function(e){var autoCompleteListDirective,caretToEnd,headToCaret,headToLastLine,lastLine,textLengthBeforeAppendingNewline,_ref;return _ref=this.parseTextareaValue(),headToCaret=_ref[0],caretToEnd=_ref[1],lastLine=_ref[2],headToLastLine=_ref[3],textLengthBeforeAppendingNewline=this.textarea.value.length,autoCompleteListDirective=function(_this){return function(e){var directive,match,number;if(_this.textarea.value.length===textLengthBeforeAppendingNewline){_.defer(autoCompleteListDirective,e);return}if(e.originalEvent.defaultPrevented)return;match=lastLine.match(LIST_REGEXP);if(!match)return;return headToCaret+="\n",directive=match[2],match[4]?directive.length===1?headToCaret+=match[1]+directive+match[3]:(number=parseInt(directive.substr(0,directive.length-1),10)+1,headToCaret+=""+match[1]+number+"."+match[3]):headToCaret=headToLastLine+"\n",_this.textarea.value=headToCaret+caretToEnd,_this.textarea.selectionStart=_this.textarea.selectionEnd=headToCaret.length}}(this),_.defer(autoCompleteListDirective,e)},onPressTab:function(e){var caretToEnd,currentIndentLevel,headToCaret,headToLastLine,i,indent,indentSize,lastLine,match,_ref;_ref=this.parseTextareaValue(),headToCaret=_ref[0],caretToEnd=_ref[1],lastLine=_ref[2],headToLastLine=_ref[3];if(match=lastLine.match(LIST_REGEXP))return e.preventDefault(),currentIndentLevel=Math.floor(match[1].length/INDENT),indentSize=Math.max((currentIndentLevel+(e.shiftKey?-1:1))*INDENT,0),indent=function(){var _i,_results;_results=[];for(i=_i=0;0<=indentSize?_i<indentSize:_i>indentSize;i=0<=indentSize?++_i:--_i)_results.push(" ");return _results}().join(""),headToCaret=headToLastLine+indent+match[2]+match[3]+match[4],this.textarea.value=headToCaret+caretToEnd,this.textarea.selectionStart=this.textarea.selectionEnd=headToCaret.length},parseTextareaValue:function(){var caretPosition,caretToEnd,headToCaret,headToLastLine,lastLine,splitedVal,value;return value=this.textarea.value,caretPosition=this.textarea.selectionEnd,headToCaret=value.substring(0,caretPosition),caretToEnd=value.substring(caretPosition),splitedVal=headToCaret.split("\n"),lastLine=splitedVal[splitedVal.length-1],headToLastLine=splitedVal.slice(0,splitedVal.length-1).join("\n"),headToLastLine&&(headToLastLine+="\n"),[headToCaret,caretToEnd,lastLine,headToLastLine]}}}.call(this),function(){this.JST||(this.JST={}),this.JST["t/autocomplete/emoji"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="autocomplete-image">\n  <img src="',image,'"/>\n  <span class="value">',value,"</span>\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["t/autocomplete/lang"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="autocomplete-lang">\n  <span class="code">',value,'</span>\n  <span class="name">',name,"</span>\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["t/autocomplete/mention"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="autocomplete-image">\n  <img src="',image,'"/>\n  <span class="value">',url_name,"</span>\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["t/autocomplete/mention_teams"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="autocomplete-image">\n  <img src="',image,'"/>\n  <span class="value">\n    ',url_name,"\n  </span>\n  "),name&&__p.push('\n    <span class="name">',name,"</span>\n  "),__p.push("\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["t/autocomplete/title"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="autocomplete-image">\n  <img src="',image,'"/>\n  <span class="value">',value,"</span>\n</div>\n");return __p.join("")}}.call(this),function(){var namespace;namespace=ns("mixins"),namespace.AutocompleteMixin={bindMixin:function(){var check,isInCode;return this.$textarea==null&&(this.$textarea=this.$("textarea")),isInCode=!1,check=function(text){var match;return match=text.match(/`{3,}/g),match&&match.length%2?isInCode=!0:(match=text.match(/`/g),match&&match.length%2?isInCode=!0:isInCode=!1)},this.$textarea.textcomplete([{match:/(^|\s|\():([\-\+\w]*)$/,search:function(term,callback){return $.getJSON("/api/emoji",{q:term}).done(function(data){return callback(data)}).fail(function(){return callback([])})},replace:function(datum){return"$1:"+datum.value+": "},template:function(datum){return JST["t/autocomplete/emoji"]({value:datum.value,image:"https://cdn.qiita.com/emoji/"+encodeURIComponent(datum.value)+".png"})},cache:!0,context:function(text){return check(text),!isInCode}},{match:/(^|\s)((\d+)x(\d+))$/,search:function(term,callback){return callback([term])},replace:function(format){var body,column,header,splitter,x,y,_i,_j,_k,_l,_ref,_results,_results1,_results2,_results3,_x,_y;return _ref=format.split("x"),_x=_ref[0],_y=_ref[1],x=parseInt(_x,10),y=parseInt(_y,10),header="|"+function(){_results=[];for(var _i=1;1<=x?_i<=x:_i>=x;1<=x?_i++:_i--)_results.push(_i);return _results}.apply(this).map(function(n){return" "+n+" |"}).join(""),splitter="|"+function(){_results1=[];for(var _j=1;1<=x?_j<=x:_j>=x;1<=x?_j++:_j--)_results1.push(_j);return _results1}.apply(this).map(function(n){return":-:|"}).join(""),column="|"+function(){_results2=[];for(var _k=1;1<=x?_k<=x:_k>=x;1<=x?_k++:_k--)_results2.push(_k);return _results2}.apply(this).map(function(n){return"   |"}).join(""),body=function(){_results3=[];for(var _l=1;1<=y?_l<=y:_l>=y;1<=y?_l++:_l--)_results3.push(_l);return _results3}.apply(this).map(function(){return column}).join("\n"),"$1"+header+"\n"+splitter+"\n"+body},template:function(){return"テーブルを挿入"},context:function(text){return!isInCode}},{match:/(^|\s|\()@(\S*)$/,search:function(term,callback){var data,reg;return Qiita.mentionCandidates&&(reg=new RegExp("^"+term,"i"),data=_.filter(Qiita.mentionCandidates,function(user){return reg.test(user.url_name)}),callback(data,!0)),term===""&&!Qiita.currentTeam?callback([]):$.getJSON("/api/mentionable_users",{q:term}).done(function(data){return callback(data)}).fail(function(){return callback([])})},replace:function(datum){return"$1@"+datum.url_name+" "},template:function(datum){var name;return name=Qiita.currentTeam?"mention_teams":"mention",JST["t/autocomplete/"+name]({url_name:datum.url_name,name:_.escape(datum.name||""),image:datum.profile_image_url})},cache:!0,idProperty:"url_name",context:function(text){return!isInCode}},{match:/(^|\n)```([^\s:]+)$/,search:function(term,callback){return $.getJSON("/api/lang",{q:term}).done(function(data){return callback(data)}).fail(function(){return callback([])})},replace:function(datum){return"$1```"+datum.value+"\n"},template:function(datum){return JST["t/autocomplete/lang"]({value:datum.value==="\\n"?"":datum.value,name:datum.name})},cache:!0,context:function(text){return isInCode}}],{debounce:100})},unbindMixin:function(){var _ref;return(_ref=this.$textarea)!=null&&_ref.textcomplete("destroy"),this.textarea=this.$textarea=null}}}.call(this);var I18n=I18n||{};I18n.addTranslations({en:{js:{mixins:{image_uploadable:{image_is_compressed:"The image is compressed."}}}},ja:{js:{mixins:{image_uploadable:{image_is_compressed:"画像が圧縮されました。"}}}}}),function(){var compress,dataURItoBlob,namespace;namespace=ns("util"),dataURItoBlob=function(dataURI){var ab,byteString,i,ia,_i,_ref;byteString=atob(dataURI.split(",")[1]),ab=new ArrayBuffer(byteString.length),ia=new Uint8Array(ab);for(i=_i=0,_ref=byteString.length;0<=_ref?_i<_ref:_i>_ref;i=0<=_ref?++_i:--_i)ia[i]=byteString.charCodeAt(i);return new Blob([ia])},compress=function(file,maxSize,currentSize){var dfd,reader;return dfd=$.Deferred(),reader=new FileReader,reader.onload=function(e){var img;return img=new Image,img.onload=function(){var blob,canvas,compRatio,ctx;return canvas=document.createElement("canvas"),ctx=canvas.getContext("2d"),compRatio=Math.sqrt(currentSize/file.size),canvas.width=img.width*compRatio,canvas.height=img.height*compRatio,ctx.drawImage(img,0,0,canvas.width,canvas.height),blob=dataURItoBlob(canvas.toDataURL(file.type)),blob.size<maxSize?dfd.resolve(blob):compress(file,maxSize,currentSize*.8).done(dfd.resolve).fail(dfd.reject)},img.src=e.target.result},reader.readAsDataURL(file),dfd.promise()},namespace.compressImage=function(file,maxSize){return compress(file,maxSize,maxSize*.8)}}.call(this),function(){var I18N_NAMESPACE,namespace,notification;if(!window.File){Qiita.mixins.ImageAuthorshipMixin={};return}namespace=ns("mixins"),I18N_NAMESPACE="js.mixins.image_uploadable.",notification=Qiita.notification,namespace.ImageAuthorshipMixin={events:{drop:"onDropFile",dragover:"onDragOver",paste:"onPaste"},initialize:function(options){return this.options=options,_.bindAll(this,"checkPolicies","handlePolicyViolation","uploadFile","showProgress","finishUploading","failUploading")},render:function(){return this.renderUploadableSize(),this},onFileChange:function(e){return this.tryToUpload(e.target.files[0],"file select")},onDropFile:function(e){return e.preventDefault(),this.tryToUpload(e.originalEvent.dataTransfer.files[0],"drag and drop")},onDragOver:function(e){return e.preventDefault()},onDragHoverStart:function(e,dragEnterEvent){var hasFiles,type,types,_i,_len,_ref,_ref1;hasFiles=!1;if(dragEnterEvent!=null?(_ref=dragEnterEvent.originalEvent)!=null?(_ref1=_ref.dataTransfer)!=null?_ref1.types:void 0:void 0:void 0){types=dragEnterEvent.originalEvent.dataTransfer.types;for(_i=0,_len=types.length;_i<_len;_i++){type=types[_i];if(type.toLowerCase()!=="files")continue;hasFiles=!0;break}}if(hasFiles)return this.$el.addClass("drop-target")},onDragHoverEnd:function(){return this.$el.removeClass("drop-target")},onPaste:function(ev){var blob,fileItems,i,items,_i,_len,_ref,_ref1;if(items=(_ref=ev.originalEvent)!=null?(_ref1=_ref.clipboardData)!=null?_ref1.items:void 0:void 0){fileItems=_.filter(items,function(i){return i.kind==="file"});if(fileItems.length>0){for(_i=0,_len=fileItems.length;_i<_len;_i++)i=fileItems[_i],blob=i.getAsFile(),this.tryToUpload(blob,"paste");return ev.preventDefault()}return!0}return!0},insertText:function(text){var caretToTail,headToCaret;return headToCaret=this.textarea.value.substring(0,this.textarea.selectionEnd)+text,caretToTail=this.textarea.value.substring(this.textarea.selectionEnd),this.textarea.value=headToCaret+caretToTail,this.textarea.selectionStart=this.textarea.selectionEnd=headToCaret.length},replaceText:function(before,after){var at;return at=this.textarea.selectionStart,this.textarea.value=this.textarea.value.replace(before,after),this.textarea.selectionStart=this.textarea.selectionEnd=at+after.length-before.length},renderUploadableSize:function(){var text;if(this.remainingSize==null||this.monthlySizeLimit==null)return;return text=""+_.numberToHumanSize(this.remainingSize)+" / "+_.numberToHumanSize(this.monthlySizeLimit),this.$(".js-uploadableSize").text(text)},tryToUpload:function(file,action){return this.mdPlaceHolder="![uploading "+(file.name||"")+"...]()",this.insertText(""+this.mdPlaceHolder+"\n"),this.validateFileType(file,action).then(this.checkPolicies).then(null,this.handlePolicyViolation).then(this.uploadFile).progress(this.showProgress).done(this.finishUploading).fail(this.failUploading)},validateFileType:function(file,action){var dfd;return dfd=$.Deferred(),/^image\/(?:png|gif|jpeg|tiff)$/.test(file.type)?dfd.resolve(file,action):(this.replaceText(this.mdPlaceHolder,"![Invalid file type: "+file.type+"]()"),dfd.reject()),dfd.promise()},checkPolicies:function(file,action,name,type){var dfd;return dfd=$.Deferred(),$.ajax({url:"/api/upload/policies",type:"POST",data:{image:{size:file.size,content_type:type||file.type,name:name||file.name||"image"},action:action},dataType:"json"}).done(function(data){return dfd.resolve(file,action,data)}).fail(function(error){return dfd.reject(file,action,error)}),dfd.promise()},handlePolicyViolation:function(file,action,error,dontResize){var errorMessage,match,maxSize,sizeErrorMessage;try{sizeErrorMessage=JSON.parse(error.responseText).errors.size[0];if(!dontResize&&(match=sizeErrorMessage.match(/^must be less than (.*)$/)))return maxSize=parseInt(error.getResponseHeader("X-IMAGE-LIMIT"),10),this.resizeImage(file,action,maxSize);errorMessage="the image size "+sizeErrorMessage}catch(_error){error=_error,errorMessage="Please try again later."}return this.replaceText(this.mdPlaceHolder,'![Failed to upload "'+file.name+'": '+errorMessage+"]()")},resizeImage:function(file,action,maxSize){var dfd;return dfd=$.Deferred(),Qiita.util.compressImage(file,maxSize).done(function(_this){return function(blob){return _this.checkPolicies(blob,action,file.name,file.type).done(function(blob,action,data){return notification.notice(I18n.t(""+I18N_NAMESPACE+"image_is_compressed")),dfd.resolve(blob,action,data)}).fail(function(blob,action,error){return _this.handlePolicyViolation(file,action,error,!0),dfd.reject(file,action)})}}(this)),dfd.promise()},uploadFile:function(file,action,data){var dfd,fd,key,value,xhr,_ref;dfd=$.Deferred(),fd=new FormData,_ref=data.form;for(key in _ref)value=_ref[key],fd.append(key,value);return fd.append("file",file),xhr=new XMLHttpRequest,xhr.upload.addEventListener("progress",function(e){var percentComplete;if(e.lengthComputable)return percentComplete=Math.round(e.loaded*100/e.total),dfd.notify(percentComplete)},!1),xhr.addEventListener("load",function(){var _ref1;return 200<=(_ref1=this.status)&&_ref1<300?dfd.resolve(data.asset):dfd.reject(this.statusText)},!1),xhr.addEventListener("error",function(){return dfd.reject(this.statusText)},!1),xhr.addEventListener("abort",function(){return dfd.reject(this.statusText)},!1),xhr.open("POST",data.upload_url,!0),xhr.send(fd),dfd.promise()},showProgress:function(percentComplete){return console.log(percentComplete)},finishUploading:function(asset){return this.replaceText(this.mdPlaceHolder,"!["+asset.name+"]("+asset.href+")"),this.remainingSize!=null&&(this.remainingSize-=asset.size),this.trigger("change:uploadableSize"),this.$textarea.trigger("change"),$.ajax({url:"/api/upload/images/"+asset.id,type:"PUT"})},failUploading:function(message){return this.replaceText(this.mdPlaceHolder,"!["+message+"]()")},bindMixin:function(){this.$textarea==null&&(this.$textarea=this.$("textarea")),this.textarea==null&&(this.textarea=this.$textarea[0]),this.$fileInput==null&&(this.$fileInput=this.$('input[type="file"]')),this.$fileInput.on("change",_.bind(this.onFileChange,this)),this.$(".js-droptarget").draghover().on({draghoverstart:_.bind(this.onDragHoverStart,this),draghoverend:_.bind(this.onDragHoverEnd,this)}),this.remainingSize=this.$fileInput.data("remaining-size"),this.monthlySizeLimit=this.$fileInput.data("monthly-size-limit"),this.everPosted=this.$fileInput.data("ever-posted");if(this.remainingSize!=null&&this.monthlySizeLimit!=null)return this.on("change:uploadableSize",this.renderUploadableSize,this)},unbindMixin:function(){var _ref;return(_ref=this.$fileInput)!=null&&_ref.off("change"),this.$fileInput=this.textarea=this.$textarea=null,this.$(".js-droptarget").off()}}}.call(this);var I18n=I18n||{};I18n.addTranslations({en:{js:{mixins:{previewable:{fail:"Fail to preview. Please retry later."}}}},ja:{js:{mixins:{previewable:{fail:"プレビュー取得に失敗しました。後ほど再試行してください。"}}}}}),function(){var namespace;namespace=ns("mixins"),namespace.PreviewableMixin={events:{"click .edit":"onClickEdit","click .preview":"onClickPreview"},onClickPreview:function(e){var text;e.preventDefault(),text=this.$("textarea").val();if(!text)return;return this.activate("preview"),this.renderPreview(JST["t/stream/circle-loading"]()),$.ajax({url:"/api/preview",type:"post",data:{raw_body:text}}).done(function(_this){return function(data){return _this.renderPreview(data)}}(this)).fail(function(_this){return function(){return _this.activate("edit"),Qiita.notification.error(I18n.t("js.mixins.previewable.fail"),{keep:!1})}}(this))},onClickEdit:function(e){return e.preventDefault(),this.activate("edit")},activate:function(type){this.$(".active").removeClass("active");switch(type){case"edit":return this.$(".edit").addClass("active"),this.$(".content-area").addClass("active");case"preview":return this.$(".preview").addClass("active"),this.$(".preview-area").addClass("active")}},renderPreview:function(data){var $el;return $el=this.$(".preview-area"),$el.html(data),Qiita.MathJaxHelper.run($el)}}}.call(this),function(){var AUTO_PREVIEW_INTERVAL,KEY,mixins,namespace,previewHandlerFactory,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),AUTO_PREVIEW_INTERVAL=1e3,KEY="draft_items/form_view:previewing",Qiita.store.get(KEY)===void 0&&($(window).width()>=768?Qiita.store.set(KEY,"half"):Qiita.store.set(KEY,!1)),previewHandlerFactory=function(state){return function(){return state&&!Qiita.store.get(KEY)&&this.fetchPreview(),Qiita.store.set(KEY,state),this.renderPreviewPanel(state)}},namespace.BodyFormView=function(_super){function BodyFormView(){return this.chasePreviewArea=__bind(this.chasePreviewArea,this),this.renderPreviewPanel=__bind(this.renderPreviewPanel,this),this.renderPreview=__bind(this.renderPreview,this),BodyFormView.__super__.constructor.apply(this,arguments)}var I18N_NAMESPACE,TOOLTIP_TEMPLATE;return __extends(BodyFormView,_super),I18N_NAMESPACE="js.views.draft_items.body_form_view.",TOOLTIP_TEMPLATE='<div class="tooltip editorImagePickerTooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',BodyFormView.prototype.el=".js-bodyFormView",BodyFormView.prototype.events={"click .js-helpModal":"showMarkdownHelpModal","click .js-noPreview":previewHandlerFactory(!1),"click .js-fullPreview":previewHandlerFactory("full"),"click .js-halfPreview":previewHandlerFactory("half"),"click .js-emojiPickerLauncher":function(){return this.emojiPicker.toggle()},"click .js-filePicker":"openFilePicker","keyup textarea":"updateRawBody","change textarea":"updateRawBody"},BodyFormView.prototype.initialize=function(options){return this.assignElements(),this.emojiPicker=new namespace.EmojiPickerView({textarea:this.textarea}),this.bindEventListeners(),this.bindMixin()},BodyFormView.prototype.render=function(){return this.renderPreviewPanel(Qiita.store.get(KEY)),this.emojiPicker.render().$el.appendTo(this.$el),Qiita.store.get(KEY)&&this.model.fetchPreview(),this},BodyFormView.prototype.openFilePicker=function(){return this.$fileInput.click()},BodyFormView.prototype.updateRawBody=function(){return this.model.set("raw_body",this.getValue(),{silent:!Qiita.store.get(KEY)})},BodyFormView.prototype.fetchPreview=_.throttle(function(){return this.model.fetchPreview()},AUTO_PREVIEW_INTERVAL,{leading:!1}),BodyFormView.prototype.renderUploadableSize=function(){var additionalHtml;return this.remainingSize!=null&&this.monthlySizeLimit!=null&&(additionalHtml='<div class="editorImagePickerTooltip_attachment">'+('<p class="editorImagePickerTooltip_label">'+I18n.t(""+I18N_NAMESPACE+"remaining_upload_quota_in_this_month")+"</p>")+("<p>"+_.numberToHumanSize(this.remainingSize)+" / "+_.numberToHumanSize(this.monthlySizeLimit)+"</p>"),this.everPosted||(additionalHtml+="<p>"+I18n.t(""+I18N_NAMESPACE+"monthly_limit_will_rise_once_you_publish_first_post")+"</p>"),additionalHtml+="</div>"),this.activateFilePickerTooltip(additionalHtml)},BodyFormView.prototype.activateFilePickerTooltip=function(additionalHtml){var $filePicker;return additionalHtml==null&&(additionalHtml=""),$filePicker=this.$(".js-filePicker"),$filePicker.tooltip("destroy"),$filePicker.tooltip({title:""+I18n.t(""+I18N_NAMESPACE+"select_image_or_drag_and_drop_html")+additionalHtml,html:!0,template:TOOLTIP_TEMPLATE,trigger:"hover",placement:"bottom",container:".js-bodyFormView",viewport:".js-bodyFormView"})},BodyFormView.prototype.renderPreview=function(){var html;return html=this.model.get("body"),html===""?this.$cheetsheet.show():this.$cheetsheet.hide(),this.$previewEl.html(html),Qiita.MathJaxHelper.run(this.$previewEl)},BodyFormView.prototype.renderPreviewPanel=function(state){return this.$el.removeClass("uninitialized"),state==="full"?this.$el.removeClass("halfPreviewing").removeClass("notPreviewing").addClass("fullPreviewing"):state==="half"?this.$el.removeClass("fullPreviewing").removeClass("notPreviewing").addClass("halfPreviewing"):this.$el.removeClass("fullPreviewing").removeClass("halfPreviewing").addClass("notPreviewing")},BodyFormView.prototype.showMarkdownHelpModal=function(){return $(".js-markdownHelpModal").modal("show")},BodyFormView.prototype.chasePreviewArea=function(){var scrollRate;if(!Qiita.store.get(KEY))return;return scrollRate=this.$textarea.scrollTop()/(this.textarea.scrollHeight-this.$textarea.innerHeight()),this.$previewEl.scrollTop(scrollRate*(this.previewEl.scrollHeight-this.$previewEl.innerHeight()))},BodyFormView.prototype.bindEventListeners=function(){return this.listenTo(this.model,"change:raw_body",this.fetchPreview),this.listenTo(this.model,"change:body",this.renderPreview),this.listenTo(this.model,"change:previewing",this.renderPreviewPanel),this.listenTo(this.emojiPicker,"pick",this.updateRawBody),this.textarea.onscroll=this.chasePreviewArea},BodyFormView.prototype.assignElements=function(){return this.$previewEl=this.$(".js-preview"),this.previewEl=this.$previewEl.get(0),this.$textarea=this.$("textarea"),this.textarea=this.$textarea.get(0),this.$cheetsheet=this.$(".js-editorPreview_cheatsheet")},BodyFormView.prototype.getValue=function(){return this.textarea.value.replace(/\r\n?/g,"\n")},BodyFormView}(Backbone.View),mixins=Qiita.mixins,Qiita.util.mixin(namespace.BodyFormView,mixins.AutocompleteMixin,mixins.AutoindentMixin,mixins.ImageAuthorshipMixin)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.ComparableBodyFormView=function(_super){function ComparableBodyFormView(){return ComparableBodyFormView.__super__.constructor.apply(this,arguments)}return __extends(ComparableBodyFormView,_super),ComparableBodyFormView.prototype.events={"click .js-tab":"clickTab"},ComparableBodyFormView.prototype.initialize=function(){return this.events=_.extend({},this.events,namespace.BodyFormView.prototype.events),ComparableBodyFormView.__super__.initialize.apply(this,arguments)},ComparableBodyFormView.prototype.clickTab=function(e){var $tab;e.preventDefault(),$tab=$(e.currentTarget);if(!$tab.hasClass("active")){this.switchTabs($tab);if($tab.data("type")==="diff")return this.model.set({raw_body:this.$("#draft_item_raw_body").val()}),this.model.fetchDiff()}},ComparableBodyFormView.prototype.renderDiff=function(){return this.$("#diff").html(this.model.get("diff"))},ComparableBodyFormView.prototype.renderDiffError=function(){return this.$("#diff").html("ERROR")},ComparableBodyFormView.prototype.switchTabs=function($tab){return this.$(".js-draftBody .active").removeClass("active"),$tab.addClass("active"),$($tab.attr("href")).addClass("active")},ComparableBodyFormView.prototype.bindEventListeners=function(){return ComparableBodyFormView.__super__.bindEventListeners.apply(this,arguments),this.listenTo(this.model,"change:diff",this.renderDiff),this.listenTo(this.model,"error:diff",this.renderDiffError)},ComparableBodyFormView}(namespace.BodyFormView)}.call(this),function(){this.JST||(this.JST={}),this.JST["t/autocomplete/tag"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="autocomplete-image">\n  '),tag.icon_url&&__p.push('\n    <img src="',tag.icon_url,'"/>\n  '),__p.push('\n  <span class="value">',tag.name,"</span> (",tag.item_count,")\n</div>\n");return __p.join("")}}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.TagFormView=function(_super){function TagFormView(){return TagFormView.__super__.constructor.apply(this,arguments)}var ENTER_KEY_CODE;return __extends(TagFormView,_super),ENTER_KEY_CODE=13,TagFormView.prototype.el=".js-tagFormView",TagFormView.prototype.events={"focusin input":"onFocusIn","focusout input":"onFocusOut","keydown input":"onKeyDown"},TagFormView.prototype.initialize=function(options){return this.input=this.$("input").get(0)},TagFormView.prototype.render=function(){return this.applyTextcomplete(),this.applyHighlight(),this},TagFormView.prototype.applyTextcomplete=function(){var strategy;return strategy={match:/(^|\s)([^<>;"'\s]+)$/,index:2,search:function(input,callback){if(input.indexOf(":")!==-1){callback([]);return}return $.getJSON("/api/tags",{q:input}).done(function(data){return callback(data)}).fail(function(){return callback([])})},cache:!0,template:function(tag){return JST["t/autocomplete/tag"]({tag:tag})},replace:function(tag){return"$1"+tag.name+" "}},this.$("input").textcomplete([strategy])},TagFormView.prototype.applyHighlight=function(){var strategy;return strategy={match:/[^ \f\n\r\t]+/g,css:{"background-color":"#D9EAFE"}},this.$("input").overlay([strategy])},TagFormView.prototype.onFocusIn=function(event){var input;return input=event.currentTarget,_.defer(function(){var allSelected;allSelected=input.selectionStart===0&&input.selectionEnd===input.value.length;if(!allSelected)return;return input.setSelectionRange(input.value.length,input.value.length)})},TagFormView.prototype.onFocusOut=function(event){return this.model.set("tag_data",this.getValue(),{silent:!0})},TagFormView.prototype.onKeyDown=function(event){if(event.keyCode===ENTER_KEY_CODE)return!1},TagFormView.prototype.getValue=function(){var error,tag_data,tag_notation;tag_notation=this.input.value.trim();try{tag_data=TagDataParser.parse(tag_notation)}catch(_error){error=_error,tag_data=[],tag_data.notation=tag_notation,tag_data.syntaxError=error}return tag_data},TagFormView}(Backbone.View)}.call(this);var I18n=I18n||{};I18n.addTranslations({en:{js:{templates:{draft_items:{tag_datum:{tag:"Tag",version:"Version"}}}}},ja:{js:{templates:{draft_items:{tag_datum:{tag:"タグ",version:"バージョン"}}}}}});var I18n=I18n||{};I18n.addTranslations({en:{js:{views:{draft_items:{body_form_view:{select_image_or_drag_and_drop_html:"Select Image or Drag & Drop",remaining_upload_quota_in_this_month:"Remaining upload quota in this month",monthly_limit_will_rise_once_you_publish_first_post:"Monthly limit will rise to 100MB once you publish the first post."},form_view:{publish:{fail:"Failed to submit. Please try again later."},save:{success:"Saved successfully",fail:"Failed to save. Please try again later."},"delete":{success:"Deleted successfully",fail:"Failed to delete. Please try again later."},alert:{unload:"The draft has unsaved changes.","delete":"Are you sure to delete the draft? This action cannot be undone."},invalid:"Validation error.",input_body:"Input body",you_can_upload_images:"You can insert images",post_when_finished_writing:"Post when finished writing",diff_error:"Diff error",preview_error:"Preview error"},modal_view:{fail:"Failed to submit. Please try again later."},preview_view:{confirm:"Are you sure to delete the draft?\nThis action cannot be undone."}}}}},ja:{js:{views:{draft_items:{body_form_view:{select_image_or_drag_and_drop_html
:"添付する画像を選択<br>またはドラッグ&ドロップ",remaining_upload_quota_in_this_month:"今月のアップロード残り容量",monthly_limit_will_rise_once_you_publish_first_post:"初めての記事を投稿すると、アップロード上限が100MBにアップします。"},form_view:{publish:{fail:"送信に失敗しました"},save:{success:"保存されました",fail:"保存に失敗しました"},"delete":{success:"削除されました",fail:"削除に失敗しました"},alert:{unload:"未保存の変更が失われますがよろしいですか？","delete":"削除した下書きは復元できません。本当に削除してもよろしいですか？"},invalid:"不正なデータが含まれています",input_body:"本文を入力",you_can_upload_images:"画像の挿入もできます",post_when_finished_writing:"書き終わったら投稿",diff_error:"差分の表示に失敗しました",preview_error:"プレビューの表示に失敗しました"},modal_view:{fail:"送信に失敗しました。後ほど再試行してください。"},preview_view:{confirm:"削除した下書きは復元できません。\n本当に削除してもよろしいですか？"}}}}}}),function(){this.JST||(this.JST={}),this.JST["t/draft_items/tag"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<input type="hidden" name="draft_item[tag_data][][name]" value="',tag.name,'">\n'),_.each(tag.versions,function(version){__p.push('\n  <input type="hidden" name="draft_item[tag_data][][versions][]" value="',version,'">\n')}),__p.push("\n");return __p.join("")}}.call(this),function(){var history,isBeforeUnloadTurnedOn,message,namespace;namespace=ns("util.beforeUnload"),history=Backbone.history,isBeforeUnloadTurnedOn=!1,message={set:function(msg){return this.msg=msg},get:function(){return this.msg||"Are you sure?"}},namespace.on=function(msg){if(isBeforeUnloadTurnedOn)return;return isBeforeUnloadTurnedOn=!0,message.set(msg),$(window).on("beforeunload",function(){return message.get()})},namespace.off=function(){if(!isBeforeUnloadTurnedOn)return;return isBeforeUnloadTurnedOn=!1,$(window).off("beforeunload")},history.orig_navigate=history.navigate,history.navigate=function(url,options){if(isBeforeUnloadTurnedOn){if(!window.confirm(message.get()))return;namespace.off()}return history.orig_navigate(url,options)}}.call(this),function(){var AUTO_SAVE_INTERVAL,namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views.draft_items"),AUTO_SAVE_INTERVAL=1e4,namespace.FormView=function(_super){function FormView(){return FormView.__super__.constructor.apply(this,arguments)}var I18N_NAMESPACE,TUTORIAL_POPOVER_TEMPLATE,VALIDATION_POPOVER_TEMPLATE;return __extends(FormView,_super),I18N_NAMESPACE="js.views.draft_items.form_view",VALIDATION_POPOVER_TEMPLATE='<div class="popover editorValidationError" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="editorValidationError_label"><i class="fa fa-exclamation-triangle"></i></div><div class="popover-content"></div></div>',TUTORIAL_POPOVER_TEMPLATE='<div class="popover editorTutorialPopover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',FormView.prototype.events={"click .js-dropdownButton":"toggleDropdown","click .js-dropdownMenu a":"clickDropdownItem","click .js-dropdownMenu":function(e){return e.originalEvent[this.cid]=!0},"click .js-submitButton":"clickSubmitButton","change .js-confirmationCheckbox":"toggleSubmitButton",keyup:"checkModelHasChanged"},FormView.prototype.shortcuts={"ctrl+s":function(){return this.saveModel("Keyboard")}},FormView.prototype.initialize=function(options){return this.options=options,this.model=new Qiita.models.DraftItem,this.initializeSubViews(),this.initializeModel(),this.bindEventListeners(),_.extend(this,Backbone.Shortcuts.prototype),this.delegateShortcuts()},FormView.prototype.render=function(){return _.each(this.subViews,function(view){return view.render()}),this.$("noscript").remove(),!Qiita.teamName&&this.$el.data("belongToTeam")&&this.activateConfirmation(),this.showAllValidationErrors(),this.$el.data("tutorial")&&this.showTutorialPopovers(),this},FormView.prototype.updateFormAction=function(){return this.$el.attr("action",this.model.url()).append('<input type="hidden" name="_method" value="put"></input>'),this.$(".js-preview").attr("id","item-"+this.model.id)},FormView.prototype.renderValidationMessages=function(){var error,_fn,_i,_len,_ref;this.$(".js-validationError").popover("destroy"),_ref=this.model.validationError,_fn=function(error){var $error,popover;return $error=this.$(".js-"+error.name+"ValidationError"),$error.popover({content:error.message,trigger:"manual",template:VALIDATION_POPOVER_TEMPLATE}).popover("show"),popover=$error.data("bs.popover"),popover.tip().on("click",function(_this){return function(){return popover.destroy()}}(this))};for(_i=0,_len=_ref.length;_i<_len;_i++)error=_ref[_i],_fn(error);return scrollTo(0,0)},FormView.prototype.activateConfirmation=function(){return this.$(".js-creatingModal button").attr("disabled",!0),this.$(".js-modalConfirmation").show()},FormView.prototype.showAllValidationErrors=function(){return this.$(".js-validationError").popover({trigger:"manual",template:VALIDATION_POPOVER_TEMPLATE}).popover("show")},FormView.prototype.showAutoSaveNotification=function(){var $autoSaveNotification;return $autoSaveNotification=this.$(".js-autoSaveNotification"),$autoSaveNotification.addClass("js-showAndHideAnimation"),setTimeout(function(){return $autoSaveNotification.removeClass("js-showAndHideAnimation")},4200)},FormView.prototype.showDiffErrorNotification=function(){return Qiita.notification.error(this.t("diff_error"),{keep:!1})},FormView.prototype.showPreviewErrorNotification=function(){return Qiita.notification.error(this.t("preview_error"),{keep:!1})},FormView.prototype.toggleSubmitButton=function(e){return this.$(".js-creatingModal button").attr("disabled",!e.currentTarget.checked)},FormView.prototype.clickSubmitButton=function(e){var comment,submitType;this.dismissAllTutorialPopovers(),this.generateTagDataForm(),submitType=this.subViews.actionsView.submitType;if(submitType==="save")return this.submit();comment=$("#options_comment").val();if(!this.model.set(this.getAttributes(),{validate:!0,comment:comment}))return e.preventDefault();if(this.model.isCreating()&&!Qiita.teamName&&submitType==="post")return e.preventDefault(),this.$(".js-creatingModal").modal("show")},FormView.prototype.onSubmit=function(e){var id;if(this.submitting==="submitting"||this.subViews.actionsView.submitType==="save")return;e.preventDefault();if(this.submitting==="tracking")return;return this.submitting="tracking",id=setTimeout(function(_this){return function(){return _this.submit()}}(this),300),this.trackSubmitAction().always(function(_this){return function(){return clearTimeout(id),_this.submit()}}(this))},FormView.prototype.submit=_.once(function(){return this.submitting="submitting",Qiita.util.beforeUnload.off(),this.$el.submit()}),FormView.prototype.getAttributes=function(){return this.titleInput==null&&(this.titleInput=this.$(".js-titleForm input").get(0)),{title:this.titleInput.value,tag_data:this.subViews.tagFormView.getValue(),raw_body:this.subViews.bodyView.getValue()}},FormView.prototype.checkModelHasChanged=function(){return this.model.hasChangedFromInitAttrs(this.getAttributes())?(this.updated=!0,this.autoSave(),Qiita.util.beforeUnload.on(this.t("alert.unload"))):(this.updated=!1,Qiita.util.beforeUnload.off())},FormView.prototype.saveModel=_.lock(function(free,action){return this.updated?(action!=="AutoSave"&&Qiita.analysis.saveDraftItem({type:this.model.getType(),label:action}),this.model.save(this.getAttributes(),this.getParamsForSavingModel()).done(function(_this){return function(){return _this.updated=!1,Qiita.util.beforeUnload.off()}}(this)).always(function(){return free()})):free()}),FormView.prototype.autoSave=_.debounce(function(){if(this.model.hasChangedFromInitAttrs(this.getAttributes()))return this.saveModel("AutoSave")},AUTO_SAVE_INTERVAL),FormView.prototype.initializeSubViews=function(){var actionsView,bodyView,tagFormView;return actionsView=new namespace.FormActionsView({model:this.model}),bodyView=new Qiita.views.ComparableBodyFormView({model:this.model}),tagFormView=new Qiita.views.TagFormView({model:this.model}),this.subViews={actionsView:actionsView,bodyView:bodyView,tagFormView:tagFormView}},FormView.prototype.initializeModel=function(){var attrs;return attrs=this.getAttributes(),attrs.type_int=this.$el.data("type-int"),this.model.set(attrs,{silent:!0}),this.model.takeSnapShot()},FormView.prototype.bindEventListeners=function(){return this.listenTo(this.model,"change",this.checkModelHasChanged),this.listenTo(this.model,"change:"+this.model.idAttribute,this.updateFormAction),this.listenTo(this.model,"invalid",this.renderValidationMessages),this.listenTo(this.model,"sync",this.showAutoSaveNotification),this.listenTo(this.model,"error:diff",this.showDiffErrorNotification),this.listenTo(this.model,"error:preview",this.showPreviewErrorNotification),this.$el.on("submit",_.bind(this.onSubmit,this))},FormView.prototype.generateTagDataForm=function(){var html,tagData;return tagData=this.model.get("tag_data"),html=_.map(tagData,function(tag){return JST["t/draft_items/tag"]({tag:tag})}).join(""),$(".js-tagData").html(html)},FormView.prototype.trackSubmitAction=function(){var dfd,promise,_ref;return promise=Qiita.analysis.submitDraftItem({type:this.model.getType(),tagsCount:this.model.get("tag_data").length,github:this.$('[name="options[gist]"]').val()==="1",twitter:this.$('[name="options[tweet]"]').val()==="1","private":this.model.get("secret")==="1"}),this.model.isCreating()?(dfd=$.Deferred(),mixpanel.perTeam.track("post an item",{user_url_name:(_ref=Qiita.user)!=null?_ref.url_name:void 0},function(){return dfd.resolve()}),$.when(promise,dfd.promise())):promise},FormView.prototype.showTutorialPopovers=function(){var bodyPopover,filePickerPopover,submissionButtonPopover;return filePickerPopover=this.showTutorialPopover(".js-filePicker",this.t("you_can_upload_images"),"bottom"),bodyPopover=this.showTutorialPopover(".editorMarkdown_textareaWrapper",this.t("input_body"),"top"),submissionButtonPopover=this.showTutorialPopover(".js-submitButtonWrapper",this.t("post_when_finished_writing"),"top"),this.tutorialPopovers=[filePickerPopover,bodyPopover,submissionButtonPopover],this.bodyTutorialPopovers=[filePickerPopover,bodyPopover],this.listenTo(this.model,"change:raw_body",this.dismissBodyTutorialPopovers)},FormView.prototype.dismissAllTutorialPopovers=function(){var popover,_i,_len,_ref;if(this.tutorialPopovers==null)return;_ref=this.tutorialPopovers;for(_i=0,_len=_ref.length;_i<_len;_i++)popover=_ref[_i],popover.destroy();return this.tutorialPopovers=null},FormView.prototype.dismissBodyTutorialPopovers=function(){var popover,_i,_len,_ref;this.stopListening(this.model,"change:raw_body",this.dismissBodyTutorialPopovers),_ref=this.bodyTutorialPopovers;for(_i=0,_len=_ref.length;_i<_len;_i++)popover=_ref[_i],popover.destroy();return this.bodyTutorialPopovers=null},FormView.prototype.showTutorialPopover=function(selector,message,placement){var $element,popover;return $element=this.$(selector),$element.popover({content:message,placement:placement,container:".editor_content",viewport:".editor_content",template:TUTORIAL_POPOVER_TEMPLATE,trigger:"manual"}).popover("show"),popover=$element.data("bs.popover"),popover.tip().on("click",function(_this){return function(){return popover.destroy()}}(this)),popover},FormView.prototype.t=function(name,args){return I18n.t(""+I18N_NAMESPACE+"."+name,args)},FormView.prototype.getParamsForSavingModel=function(){var $el,params;return params={wait:!0,validate:!1,action:"save"},this.model.isCreating()&&this.model.isNew()&&($el=this.$('[name="reserved_item_uuid"]')).length===1&&(params.beforeSend=function(_xhr,options){var data;return data=_.extend(JSON.parse(options.data),{reserved_item_uuid:$el.val()}),options.data=JSON.stringify(data)}),params},FormView}(Backbone.View)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views.draft_items"),namespace.ItemView=function(_super){function ItemView(){return ItemView.__super__.constructor.apply(this,arguments)}return __extends(ItemView,_super),ItemView.prototype.initialize=function(){return this.model=new Qiita.models.DraftItem(this.$el.data()),this.listenTo(this.model,"selected",this.activate),this.listenTo(this.model,"unselected",this.deactivate)},ItemView.prototype.activate=function(){return this.$el.addClass("active")},ItemView.prototype.deactivate=function(){return this.$el.removeClass("active")},ItemView}(Backbone.View)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views.draft_items"),namespace.ListView=function(_super){function ListView(){return ListView.__super__.constructor.apply(this,arguments)}return __extends(ListView,_super),ListView.prototype.initialize=function(options){var draftItems;return this.$tabEl=$(options.tabEl),draftItems=_.map(this.$el.children(),function(el){var view;return view=new namespace.ItemView({el:el}),view.model}),this.collection=new Backbone.Collection(draftItems),this.listenTo(this.collection,"selected",this.activate),this.listenTo(this.collection,"unselected",this.deactivate)},ListView.prototype.activate=function(){return this.$tabEl.addClass("active"),this.$el.addClass("active")},ListView.prototype.deactivate=function(){return this.$tabEl.removeClass("active"),this.$el.removeClass("active")},ListView}(Backbone.View)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views.draft_items"),namespace.PreviewView=function(_super){function PreviewView(){return PreviewView.__super__.constructor.apply(this,arguments)}return __extends(PreviewView,_super),PreviewView.prototype.events={"click .js-deleteButton":"deleteDraft"},PreviewView.prototype.deleteDraft=function(e){if(!window.confirm(this.t("confirm")))return e.preventDefault()},PreviewView.prototype.t=function(name,args){return I18n.t("js.views.draft_items.preview_view."+name,args)},PreviewView}(Backbone.View)}.call(this),function(){var draftItems,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};if(Qiita.controller!=="draft_items")return;draftItems=Qiita.views.draft_items,new(function(_super){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return __extends(_Class,_super),_Class.prototype.routes={drafts:function(){return Qiita.action==="index"?(this.index(),this.trigger("route","index")):(this["new"](),this.trigger("route","new"))},"drafts/:uuid/edit":"edit","drafts/:path":function(path){return path==="new"?(this["new"](),this.trigger("route","new")):Qiita.action==="show"?(this.show(path),this.trigger("route","show",path)):(this.edit(path),this.trigger("route","edit",path))}},_Class.prototype.index=function(){return this.setupIndex(),this.itemLists[0].activate()},_Class.prototype.show=function(uuid){var _ref;return this.setupIndex(),this.preview.setElement(".js-draftPreview"),(_ref=this.selectedModel)!=null&&_ref.trigger("unselected"),_.each(this.itemLists,function(_this){return function(list){var model;if(model=list.collection.get(uuid))return model.trigger("selected"),_this.selectedModel=model}}(this))},_Class.prototype["new"]=function(){var model;return model=this.createFormViewOnce().model,this.listenToOnce(model,"change:"+model.idAttribute,this.navigateToEdit)},_Class.prototype.edit=function(uuid){var model;return model=this.createFormViewOnce(uuid).model},_Class.prototype.setupIndex=_.once(function(){var $tabs;return $tabs=$(".nav-tabs li"),this.itemLists=[new draftItems.ListView({el:"#creatingDrafts",tabEl:$tabs[0]}),new draftItems.ListView({el:"#editingDrafts",tabEl:$tabs[1]})],this.preview=new draftItems.PreviewView,this.itemLists[0].$el.removeClass("active"),this.itemLists[1].$el.removeClass("active"),$tabs.parent().removeClass("hidden")}),_Class.prototype.createFormViewOnce=_.once(function(uuid){var view;return view=new draftItems.FormView({el:".js-editor"}),uuid&&view.model.set(view.model.idAttribute,uuid),view.render()}),_Class.prototype.navigateToEdit=function(model){return Qiita.util.beforeUnload.off(),this.navigate(""+model.url()+"/edit",{replace:!0})},_Class}(Backbone.Router))}.call(this),function(){var namespace;namespace=ns("analysis"),namespace.changeTab=namespace.mixpanel("ChangeTab",function(props){return{tab:props.tab}})}.call(this),function(){}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("models"),namespace.Activity=function(_super){function Activity(attrs,options){var db,id,modelClass;db=Qiita.db[""+attrs.target_content_type+"s"];if(!db)throw new Error("Unknown target content type");id=attrs.target_content_type==="item"?"uuid":"url_name",(this.target=db.get(attrs.target_content[id]))||(modelClass=namespace[_.capitalize(attrs.target_content_type)],this.target=new modelClass(attrs.target_content),db.add(this.target)),attrs.target_content=null,Backbone.Model.apply(this,[attrs,options])}return __extends(Activity,_super),Activity.prototype.target=null,Activity}(Backbone.Model)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("collections"),namespace.ActivityList=function(_super){function ActivityList(){return ActivityList.__super__.constructor.apply(this,arguments)}return __extends(ActivityList,_super),ActivityList.prototype.model=Qiita.models.Activity,ActivityList.prototype.interval=18e4,ActivityList.prototype.intervalId=null,ActivityList.prototype.comparator=function(model){return-parseInt(model.get("created_at_as_seconds"),10)},ActivityList.prototype.url=function(){return this.type==="stock"?"/"+Qiita.user.url_name+"/stock":"/api/"+this.type},ActivityList.prototype.initialize=function(models,options){return this.type=options.type},ActivityList.prototype.parse=function(resp){var action_type;return this.type==="following"?resp:(action_type=this.type==="mine"?"own_post":"public_post",_(resp).map(function(attrs){return{id:_.uniqueId("activity"),action_type:action_type,actors:[attrs.user],target_content_type:"item",target_content:attrs,created_at_as_seconds:attrs.created_at_as_seconds}}))},ActivityList.prototype.startPolling=function(){if(!this.intervalId)return this.intervalId=setInterval(function(_this){return function(){return _this.fetchPrevPage()}}(this),this.interval)},ActivityList.prototype.pausePolling=function(){return clearInterval(this.intervalId),this.intervalId=null},ActivityList.prototype.activate=function(){return this.isEmpty()?this.fetch({reset:!0,append:!0}):this.fetchPrevPage(),this.type!=="public"&&this.startPolling(),this.trigger("active",this)},ActivityList.prototype.deactivate=function(){return this.pausePolling(),this.trigger("deactive",this)},ActivityList.prototype.fetchPrevPage=function(){var data;return data=this.type==="following"?{after:this.first().id,type:"id"}:this.type==="public"?{after:this.first().target.get("id"),type:"id"}:{after:this.first().get("created_at_as_seconds")},this.fetch({data:data,remove:!1})},ActivityList.prototype.fetchNextPage=function(){var data;return data=this.type==="following"?{before:this.last().id,type:"id"}:this.type==="public"?{before:this.last().target.get("id"),type:"id"}:{before:this.last().get("created_at_as_seconds")},this.fetch({data:data,remove:!1,append:!0})},ActivityList}(Backbone.Collection)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("collections"),namespace.TrackList=function(_super){function TrackList(){return TrackList.__super__.constructor.apply(this,arguments)}var MAX_RECORDS_COUNT_PER_REQUEST;return __extends(TrackList,_super),MAX_RECORDS_COUNT_PER_REQUEST=20,TrackList.checkExistenceOfNextPage=function(response){return response.length===MAX_RECORDS_COUNT_PER_REQUEST},TrackList.prototype.activate=function(){return this.fetchFirstPage(),this.startPolling(),this.trigger("active",this)},TrackList.prototype.comparator=function(model){return-model.get("created_at_in_unixtime")},TrackList.prototype.deactivate=function(){return this.stopPolling(),this.trigger("deactive",this)},TrackList.prototype.fetchFirstPage=function(){return this.fetch({reset:!0,success:function(_this){return function(_,response){return _this.hasNext=_this.constructor.checkExistenceOfNextPage(response)}}(this)})},TrackList.prototype.fetchNextPage=function(){return this.fetch({data:{max_created_at:this.last().get("created_at_in_unixtime")},append:!0,remove:!1,success:function(_this){return function(_,response){return _this.hasNext=_this.constructor.checkExistenceOfNextPage(response)}}(this)})},TrackList.prototype.fetchPreviousPage=function(){return this.fetch({data:{min_created_at:this.first().get("created_at_in_unixtime")},remove:!1})},TrackList.prototype.getRepeatedElements=function(){var table;return table={},this.select(function(element){return element.get("mentioned_object_uuid")===null?!1:table[element.get("mentioned_object_uuid")]?!0:(table[element.get("mentioned_object_uuid")]=!0,!1)})},TrackList.prototype.initialize=function(){return this.hasNext=!0,this.listenTo(this,"reset sort",function(_this){return function(){return _this.markRepeatedMentionedObjects()}}(this))},TrackList.prototype.markRepeatedMentionedObjects=function(){return this.each(function(element){return element.unset("repeated")}),_.each(this.getRepeatedElements(),function(element){return element.set("repeated",!0)})},TrackList.prototype.pollingIntervalInMsec=18e4,TrackList.prototype.startPolling=function(){return this.intervalId=setInterval(function(_this){return function(){return _this.fetchPreviousPage()}}(this),this.pollingIntervalInMsec)},TrackList.prototype.stopPolling=function(){return clearInterval(this.intervalId),this.intervalId=null},TrackList.prototype.type="following",TrackList.prototype.url="/api/tracks",TrackList}(Backbone.Collection)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.ActivityView=function(_super){function ActivityView(){return ActivityView.__super__.constructor.apply(this,arguments)}return __extends(ActivityView,_super),ActivityView.prototype.streamType=null,ActivityView.prototype.initialize=function(options){return this.target=this.model.target,this.streamType=options.streamType},ActivityView.prototype.render=function(){return this.$el.html(JST[this.template](this.presenter())),this},ActivityView}(Backbone.View)}.call(this),function(){var namespace;namespace=ns("analysis"),namespace.expandAnItem=namespace.wrap([namespace.mixpanel("Expand an item",function(props){return{tab:props.currentTab,logged_in:!!Qiita.user,team_name:Qiita.teamName}}),namespace.analytics("Item","Expand",function(props){return{eventLabel:props.currentTab}})])}.call(this),function(){this.JST||(this.JST={}),this.JST["t/activity/item"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{}){__p.push('<div class="vertical-close-button close"><i class="fa fa-angle-double-right"></i></div>\n<div class="item-box-container-inner">\n  ');var actor=actors[0];__p.push("\n  "),actionType!=="following_tag_post"?(__p.push('\n    <div class="action-user-icon',actionType=="comment"||actionType=="stock"||item.private?" action":"",'">\n      '),actionType=="comment"?__p.push('\n        <div class="action-icon"><i class="fa fa-comment"></i></div>\n      '):actionType=="stock"?__p.push('\n        <div class="action-icon"><i class="fa fa-stock unstock"></i></div>\n      '):item.private&&__p.push('\n        <div class="action-icon"><i class="fa fa-lock"></i></div>\n      '),__p.push("\n      "),item.coediting?__p.push('\n        <i class="coeditorsIcon" alt="770"></i>\n      '):__p.push('\n        <a href="/',actor.url_name,'" title="',actor.url_name,'">\n          <img src="',actor.profile_image_url,'" class="user-icon" title="',actor.url_name,'" />\n        </a>\n      '),__p.push("\n    </div>\n  ")):__p.push('\n    <div class="action-user-icon action">\n      <div class="action-icon"><i class="fa fa-tag"></i></div>\n      <a href="/tags/',actor.url_name,'" title="',actor.name,'">\n        <img src="',actor.icon_url,'" class="user-icon" title="',actor.name,'" />\n      </a>\n    </div>\n  '),__p.push('\n  <div class="item-box-area">\n    <div class="item-box-header">\n      ');if(typeof actors!="undefined"){__p.push("\n        ");if(actionType=="comment")__p.push('\n          <div class="action">\n            <span class="user">\n              <a href="/',actors[0].url_name,'">\n                ',actors[0].url_name,"\n              </a>\n            </span>\n            ",I18n.t("js.item_box.action.comment"),"\n          </div>\n        ");else if(_.contains(["following_user_post","public_post","own_post"],actionType))__p.push('\n          <div class="action">\n            <span class="user">\n              <a href="/',actors[0].url_name,'">\n                ',actors[0].url_name,"\n              </a>\n            </span>\n            "),item.coediting?__p.push("\n              ",I18n.t("js.item_box.action.coediting_post.pre"),"",item.created_at_in_words,"",I18n.t("js.item_box.action.coediting_post.post"),"\n            "):__p.push("\n              ",I18n.t("js.item_box.action.post.pre"),"",item.created_at_in_words,"",I18n.t("js.item_box.action.post.post"),"\n            "),__p.push("\n          </div>\n        ");else if(actionType=="following_tag_post")__p.push("\n          "),Qiita.user&&Qiita.user.url_name==actors[0].url_name?__p.push('\n            <div class="action">\n              <span class="user">\n                <a href="/',actors[0].url_name,'">\n                  ',actors[0].url_name,"\n                </a>\n              </span>\n              ",I18n.t("js.item_box.action.post"),"\n            </div>\n          "):__p.push('\n            <div class="action">\n              <a href="/tags/',actors[0].url_name,'">\n                ',actors[0].name,"\n              </a>\n              ",I18n.t("js.item_box.action.new_post"),"\n            </div>\n          "),__p.push("\n        ");else if(actionType=="stock"){__p.push('\n          <div class="action">\n            <span class="user">\n            ');for(var i=0;i<actors.length;i++)__p.push('\n              <a href="/',actors[i].url_name,'">',actors[i].url_name,"</a>\n              "),i<actors.length-1&&__p.push(","),__p.push("\n            ");__p.push("\n            </span>\n            ",I18n.t("js.item_box.action.stock"),"\n          </div>\n        ")}__p.push("\n      ")}else __p.push('\n        <div class="action">\n          <span class="user">\n            <a href="/',item.user.url_name,'">\n              ',item.user.url_name,"\n            </a>\n          </span>\n          ",I18n.t("js.item_box.action.post"),"\n        </div>\n      ");__p.push('\n      <div class="item-box-title">\n        <h1>\n          <a href="',item.url,'" title="',item.title,'">\n            ',item.title,'\n          </a>\n        </h1>\n        <ul class="item-box_tagList list-unstyled">\n          '),_.each(item.tags,function(tag){__p.push('\n            <li>\n              <a href="/tags/',tag.url_name,'">\n                ',tag.name,"\n              </a>\n            </li>\n          ")}),__p.push('\n        </ul>\n      </div>\n      <div class="item-status-box">\n        <ul class="list-unstyled">\n          '),item.private||__p.push('\n            <li>\n              <i class="stock-button js-stock-button fa fa-stock ',item.stocked?"unstock":"",'"></i>\n              <span class="js-stock-count">',item.stock_count,"</span>\n            </li>\n          "),__p.push("\n          "),Qiita.teamName&&item.lgtm_count>0&&__p.push('\n            <li>\n              <i class="fa fa-check"></i>\n              <span>',item.lgtm_count,"</span>\n            </li>\n          "),__p.push("\n          "),item.comment_count>0&&__p.push('\n            <li>\n              <a href="',item.url,'#comments">\n                <i class="fa fa-comment-o"></i>\n                ',item.comment_count,"\n              </a>\n            </li>\n          "),__p.push('\n        </ul>\n      </div>\n    </div>\n    <div class="item-body-wrapper">\n      <div id="item-',item.uuid,'" class="item-body markdownContent bordered"></div>\n    </div>\n  </div>\n  <div class="loading"></div>\n</div> <!-- item-box-container-inner -->\n<fieldset class="toggle-button-field">\n  <legend class="toggle-button">\n    <span class="expand"><i class="fa fa-angle-double-down"></i></span>\n    <span class="close"><i class="fa fa-angle-double-up"></i></span>\n  </legend>\n</fieldset>\n')}return __p.join("")}}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.ItemActivityView=function(_super){function ItemActivityView(){return ItemActivityView.__super__.constructor.apply(this,arguments)}return __extends(ItemActivityView,_super),ItemActivityView.prototype.className="item-box",ItemActivityView.prototype.template="t/activity/item",ItemActivityView.prototype.shown=!1,ItemActivityView.prototype.animDuration=100,ItemActivityView.prototype.expandWidth=30,ItemActivityView.prototype.shiftWidth=20,ItemActivityView.prototype.events={"click .expand":"onClickExpand","click a":"onClickATag","click .close":"onClickClose","click .item-box-container-inner":"onClickExpand","dblclick .item-box-container-inner":"onClickClose","click .stock-button":"toggleStock"},ItemActivityView.prototype.initialize=function(){return ItemActivityView.__super__.initialize.apply(this,arguments),this.listenTo(this.target,"change:stocked",this.renderStockIcon)},ItemActivityView.prototype.expand=function(){var $loading;return this.$el.addClass("expanding"),this.model.target.get("body")?this.inserted?this._expand():(this.insert(),this._expand()):($loading=this.$(".loading"),$loading.html(JST["t/stream/circle-loading"]()),Qiita.analysis.expandAnItem({currentTab:this.streamType}),this.model.target.fetch().done(function(_this){return function(){return $loading.remove(),_this.insert(),_this._expand()}}(this)))},ItemActivityView.prototype.insert=function(){var $el;return $el=this.$(".item-body"),$el.html(this.model.target.get("body")),Qiita.MathJaxHelper.run($el),this.inserted=!0},ItemActivityView.prototype._expand=function(){return this.$itemBodyWrapper==null&&(this.$itemBodyWrapper=this.$(".item-body-wrapper")),this.elWidth==null&&(this.elWidth=this.$el.width()),this.itemBodyHeight==null&&(this.itemBodyHeight=this.$(".item-body").height()),this.$containerInner==null&&(this.$containerInner=this.$(".item-box-container-inner")),this.$itemBodyWrapper.animate({height:this.itemBodyHeight},{duration:this.animDuration,complete:function(_this){return function(
){return _this.$itemBodyWrapper.removeAttr("style"),_this.$el.removeClass("expanding").addClass("expanded")}}(this)}),this.$el.animate({width:this.elWidth+this.expandWidth,left:-this.shiftWidth},this.animDuration),this.$containerInner.animate({"margin-left":10,"padding-left":10,"padding-right":10},this.animDuration)},ItemActivityView.prototype.close=function(){var headerHeight,position,scrollTo;this.$el.addClass("expanding").removeClass("expanded"),this.$itemBodyWrapper.animate({height:0},{duration:this.animDuration,complete:function(_this){return function(){return _this.$el.removeClass("expanding")}}(this)}),this.$el.animate({width:this.elWidth,left:0},this.animDuration),this.$containerInner.animate({"margin-left":0,"padding-left":0,"padding-right":0},this.animDuration),position=this.$el.position().top,headerHeight=$(".js-globalNavigation").height(),scrollTo=position-headerHeight*2;if($(window).scrollTop()>scrollTo)return $("html,body").animate({scrollTop:scrollTo},this.animDuration)},ItemActivityView.prototype.renderStockIcon=function(){return this.$(".js-stock-button").toggleClass("unstock"),this.$(".js-stock-count").text(this.model.target.get("stock_count"))},ItemActivityView.prototype.onClickExpand=function(e){if(this.shown)return;return _.defer(function(_this){return function(){var _ref;if((_ref=e.originalEvent)!=null?_ref[_this.cid]:void 0)return;return _this.shown=!0,_this.expand()}}(this))},ItemActivityView.prototype.onClickClose=function(){if(!this.shown)return;return this.shown=!1,this.close()},ItemActivityView.prototype.onClickATag=function(e){return e.originalEvent[this.cid]=!0},ItemActivityView.prototype.toggleStock=_.lock(function(free,e){return e.originalEvent[this.cid]=!0,this.target.toggleStock().done(function(_this){return function(){var position;return _this.model.target.get("stocked")&&(position=_this.streamType==="following"?"feed":_this.streamType,Qiita.analysis.stockAnItem({uuid:_this.target.id,position:position})),free()}}(this))}),ItemActivityView.prototype.presenter=function(){return{item:this.target.toJSON(),actors:this.model.get("actors"),actionType:this.model.get("action_type")}},ItemActivityView}(namespace.ActivityView)}.call(this),function(){this.JST||(this.JST={}),this.JST["t/activity/tag"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<span class="user">\n  <a href="/',actor.url_name,'" target="_blank">\n    <img src="',actor.profile_image_url,'">',actor.url_name,"\n  </a>\n</span>\n",I18n.t("js.tag-box.pre"),'\n<a href="/tags/',target.get("url_name"),'" target="_blank">\n  <img src="',target.get("icon_url"),'">',target.get("name"),"\n</a>\n",I18n.t("js.tag-box.post"),"\n"),target.get("following")||__p.push('\n  <span class="follow-button">\n    ',I18n.t("js.tag-box.follow"),"\n  </span>\n"),__p.push("\n");return __p.join("")}}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.TagActivityView=function(_super){function TagActivityView(){return TagActivityView.__super__.constructor.apply(this,arguments)}return __extends(TagActivityView,_super),TagActivityView.prototype.className="tag-box",TagActivityView.prototype.template="t/activity/tag",TagActivityView.prototype.events={"click .follow-button":"follow"},TagActivityView.prototype.follow=_.lock(function(free){return this.target.follow().done(function(_this){return function(){return _this.$(".follow-button").remove(),free()}}(this))}),TagActivityView.prototype.presenter=function(){return{actor:this.model.get("actors")[0],target:this.target}},TagActivityView}(namespace.ActivityView)}.call(this),function(){this.JST||(this.JST={}),this.JST["t/activity/user"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<span class="user">\n  <a href="/',actor.url_name,'" target="_blank">\n    <img src="',actor.profile_image_url,'">\n    ',actor.url_name,"\n  </a>\n</span>\n",I18n.t("js.user-box.pre"),'\n<span class="user">\n  <a href="/',target.get("url_name"),'" target="_blank">\n    <img src="',target.get("profile_image_url"),'">\n    ',target.get("url_name"),"\n  </a>\n</span>\n",I18n.t("js.user-box.post"),"\n"),!target.get("following")&&target.get("url_name")!==Qiita.user.url_name&&__p.push('\n  <span class="follow-button">\n    ',I18n.t("js.user-box.follow"),"\n  </span>\n"),__p.push("\n");return __p.join("")}}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.UserActivityView=function(_super){function UserActivityView(){return UserActivityView.__super__.constructor.apply(this,arguments)}return __extends(UserActivityView,_super),UserActivityView.prototype.className="user-box",UserActivityView.prototype.template="t/activity/user",UserActivityView.prototype.events={"click .follow-button":"follow"},UserActivityView.prototype.follow=_.lock(function(free){return this.target.follow().done(function(_this){return function(){return _this.$(".follow-button").remove(),free()}}(this))}),UserActivityView.prototype.presenter=function(){return{actor:this.model.get("actors")[0],target:this.target}},UserActivityView}(namespace.ActivityView)}.call(this);var I18n=I18n||{};I18n.addTranslations({en:{js:{"item_box-adcal":{expand:"Expand",action:{post:"posted",stock:"Stock",unstock:"Unstock",stocking:"Stock"}}}},ja:{js:{"item_box-adcal":{expand:"展開",action:{post:"が投稿しました",stock:"ストック",unstock:"ストックを解除",stocking:"ストックする"}}}}});var I18n=I18n||{};I18n.addTranslations({en:{js:{"item_box-team":{post:{pre:"posted ",post:"&nbsp;ago"}}}},ja:{js:{"item_box-team":{post:{pre:"が",post:"前に投稿しました"}}}}});var I18n=I18n||{};I18n.addTranslations({en:{js:{"item_box-user":{"private":"This post is Private.",stock:"Stock",unstock:"Unstock"}}},ja:{js:{"item_box-user":{"private":"この投稿は限定共有設定されています",stock:"ストック",unstock:"ストック解除"}}}});var I18n=I18n||{};I18n.addTranslations({en:{js:{item_box:{expand:"Expand",close:"Close",action:{post:{pre:"<span>posted</span> ",post:"&nbsp;ago"},coediting_post:{pre:"<span>created a coediting item</span> ",post:"&nbsp;ago"},comment:"<span>commented</span>",new_post:"new post",stock:"<span>stocked</span>"},stock_button:{stock:"Stock",unstock:"Unstock"},stocked_count:"stocked count",post:" posted",comment:"Comment"}}},ja:{js:{item_box:{expand:"展開",close:"閉じる",action:{post:{pre:"が",post:"前に<span>投稿</span>しました"},coediting_post:{pre:"が",post:"前に<span>共同編集記事を作成</span>しました"},comment:"が<span>コメント</span>しました",new_post:"に新しい投稿がありました",stock:"が<span>ストック</span>しました"},stock_button:{stock:"ストック",unstock:"ストックを解除"},stocked_count:"ストックされた数",post:"が投稿",comment:"コメントする"}}}});var I18n=I18n||{};I18n.addTranslations({en:{js:{item_edit_page:{alert_when_moving_after_input:"You haven't saved yet, do you want to leave without finishing?"}}},ja:{js:{item_edit_page:{alert_when_moving_after_input:"変更箇所の保存が完了していません。このまま移動しますか？"}}}});var I18n=I18n||{};I18n.addTranslations({en:{js:{no_posts_yet_html:"No posts found.<br /><a href='/drafts/new'>Why don't you share your programming tips or code snippets?</a>"}},ja:{js:{no_posts_yet_html:"投稿はまだありません。<br /><a href='/drafts/new'>Qiita全体の投稿</a>を見て、あなたの持っているtips、コードを投稿したり、タグやユーザーをフォローしてみましょう!"}}});var I18n=I18n||{};I18n.addTranslations({en:{js:{qiita:{follow:"Follow",unfollow:"Unfollow",stock:"Stock",unstock:"Unstock",expand:"Expand",close:"Close",no_notifications:"You have no notifications."}}},ja:{js:{qiita:{follow:"フォローする",unfollow:"フォロー解除",stock:"ストック",unstock:"ストック解除",expand:"展開",close:"閉じる",no_notifications:"通知はまだありません。"}}}});var I18n=I18n||{};I18n.addTranslations({en:{js:{qiita_toppage:{stock:"Stock",unstock:"Unstock",expand:"Expand",close:"Close",followed:"Followed"}}},ja:{js:{qiita_toppage:{stock:"ストックする",unstock:"ストック解除",expand:"展開",close:"閉じる",followed:"フォローしました"}}}});var I18n=I18n||{};I18n.addTranslations({en:{js:{stream:{more:"Show More",notification:"%{count} new Activity"}}},ja:{js:{stream:{more:"もっと見る",notification:"%{count} 件の新しいアクティビティ"}}}});var I18n=I18n||{};I18n.addTranslations({en:{js:{"tag-box":{pre:"followed",post:"tag",follow:"Follow"}}},ja:{js:{"tag-box":{pre:"が",post:"タグをフォローしました",follow:"フォローする"}}}});var I18n=I18n||{};I18n.addTranslations({en:{js:{"user-box":{pre:"followed",post:"&nbsp;",follow:"Follow"}}},ja:{js:{"user-box":{pre:"が",post:"をフォローしました",follow:"フォローする"}}}}),function(){this.JST||(this.JST={}),this.JST["t/no_posts_yet"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<p class='no-posts-yet'>",I18n.t("js.no_posts_yet_html"),"</p>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["t/stream/inner"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="flush-button"></div>\n<div class="activities"></div>\n<div class="tail"></div>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["t/stream/more-button"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="more-button btn btn-default btn-block" tabindex="0">',I18n.t("js.stream.more"),"</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["t/stream/search_form"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{}){__p.push("");var namespace="js.templates.stream.search_form.";__p.push('\n<form action="/search" class="stream_searchForm" method="GET">\n  <div>\n    <input placeholder="',I18n.t(namespace+type),'" class="stream_searchForm_textField js-stream_searchForm_textField" />\n    <button type="submit" class="btn stream_searchForm_searchButton">\n      <i class="fa fa-search"></i>\n    </button>\n  </div>\n  <input type="hidden" name="q" class="js-stream_searchForm_searchQuery"\n    value="',type==="mine"?"user:"+Qiita.user.url_name:"",'">\n  '),stocked&&__p.push('\n    <input type="hidden" name="stocked" value="1" />\n  '),__p.push("\n</form>\n")}return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["t/stream/fail_to_fetch"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{}){__p.push("");var namespace="js.templates.stream.fail_to_fetch.";__p.push('\n<div class="feedActivities_failToFetch">\n  ',I18n.t(namespace+"fail_to_fetch_html"),"\n</div>\n")}return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["t/teams/feed-tutorial"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="markdown-content">\n  <p>\n    Qiita:Teamをご利用いただきありがとうございます。<br />\n    簡単にこの機能の説明をさせていただきます。\n  </p>\n  <h2>Qiita:Teamの3つの特徴</h2>\n  <h3>1. 投稿やタグが外部に公開されることはありません</h3>\n  <p>\n    Qiita:Teamで作成されたり利用された投稿およびタグは、各チーム専用に保存されるため、これらの情報が外部に公開されることはありません。\n  </p>\n  <h3>2. メンバーへのメンションが可能です</h3>\n  <p>\n    投稿内やコメント内で<code>@hoge</code>と記述することで、同じチーム内のメンバーに向けてメンションすることができます。もし間違って外部のユーザーへメンションしてしまった場合、相手に通知されることはありませんのでご安心ください。<br />\n    なお、投稿を編集する際にメンションを追記した場合は相手に通知されませんのでご注意ください。\n  </p>\n  <h3>3. 編集リクエストが利用できます</h3>\n  <p>\n    <a href="http://qiita.com">Qiita</a>の機能である編集リクエストはQiita:Teamでも利用可能です。編集履歴も残りますので、メンバー同士で情報の質を向上しあうことができます。\n  </p>\n  <hr />\n  <p>\n    他にも便利な機能はありますが、まずは投稿してQiita:Teamを体験してみてください。\n    Qiita:Teamで、快適な情報共有を。\n  </p>\n  <a href="/items/new">',teamName,"に投稿する</a>\n</div>\n");return __p.join("")}}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.TrackView=function(_super){function TrackView(){return TrackView.__super__.constructor.apply(this,arguments)}var CLASS_NAME_FOR_EXPANDED,SELECTOR_FOR_MAX_JAX_HELPER_TARGET,STREAM_TYPE_FOR_ANALYSIS;return __extends(TrackView,_super),CLASS_NAME_FOR_EXPANDED="expanded",SELECTOR_FOR_MAX_JAX_HELPER_TARGET=".item-body",STREAM_TYPE_FOR_ANALYSIS="following",TrackView.prototype.contract=function(){return this.$el.removeClass(CLASS_NAME_FOR_EXPANDED)},TrackView.prototype.events={"click .close":"contract","click .expand":"expand","dblclick .item-box-container-inner":"contract"},TrackView.prototype.ensureMaxJaxHelperRunned=function(){if(!this.mathJaxHelperRunned)return this.runMathJaxHelper()},TrackView.prototype.expand=function(){return this.ensureMaxJaxHelperRunned(),this.$el.addClass(CLASS_NAME_FOR_EXPANDED)},TrackView.prototype.getRendererFunction=function(){return JST[this.templatePath]},TrackView.prototype.initialize=function(){return this.mathJaxHelperRunned=!1},TrackView.prototype.model=ns("models").Track,TrackView.prototype.render=function(){return this.$el.html(this.getRendererFunction()(this.model.toJSON())),this},TrackView.prototype.runMathJaxHelper=function(){return Qiita.MathJaxHelper.run(this.$(SELECTOR_FOR_MAX_JAX_HELPER_TARGET)),this.mathJaxHelperRunned=!0},TrackView.prototype.sendExpandEventForAnalysis=function(){return Qiita.analysis.expandAnItem({currentTab:STREAM_TYPE_FOR_ANALYSIS})},TrackView}(Backbone.View)}.call(this),function(){this.JST||(this.JST={}),this.JST["t/tracks/following_user"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<span class="user">\n  <a href="',followable_url,'" target="_blank">\n    <img src="',followable_image_url,'">\n    ',followable_name,"\n  </a>\n</span>\n",I18n.t("js.user-box.pre"),'\n<span class="user">\n  <a href="',mentioned_object_url,'" target="_blank">\n    <img src="',mentioned_object_image_url,'">\n    ',mentioned_object_name,"\n  </a>\n</span>\n",I18n.t("js.user-box.post"),"\n");return __p.join("")}}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.FollowingUserTrackView=function(_super){function FollowingUserTrackView(){return FollowingUserTrackView.__super__.constructor.apply(this,arguments)}return __extends(FollowingUserTrackView,_super),FollowingUserTrackView.prototype.className="user-box",FollowingUserTrackView.prototype.templatePath="t/tracks/following_user",FollowingUserTrackView}(namespace.TrackView)}.call(this),function(){this.JST||(this.JST={}),this.JST["t/tracks/public_domain_article"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="vertical-close-button close">\n  <i class="fa fa-angle-double-right"></i>\n</div>\n<div class="item-box-container-inner">\n  <div class="action-user-icon',trackable_type=="PublicDomainArticle"?"":" action",'">\n    '),trackable_type=="Comment"?__p.push('\n      <div class="action-icon">\n        <i class="fa fa-comment"></i>\n      </div>\n    '):trackable_type=="StockItem"?__p.push('\n      <div class="action-icon">\n        <i class="fa fa-stock unstock"></i>\n      </div>\n    '):trackable_type=="Tagging"&&__p.push('\n      <div class="action-icon">\n        <i class="fa fa-tag"></i>\n      </div>\n    '),__p.push('\n    <a href="',followable_url,'" title="',followable_name,'">\n      <img src="',followable_image_url,'" class="user-icon" title="',followable_name,'" />\n    </a>\n  </div>\n  <div class="item-box-area">\n    <div class="item-box-header">\n      <div class="action">\n        <span class="user">\n          <a href="',followable_url,'">\n            ',followable_name,"\n          </a>\n        </span>\n        "),trackable_type=="Comment"?__p.push("\n          ",I18n.t("js.item_box.action.comment"),"\n        "):trackable_type=="PublicDomainArticle"?__p.push("\n          ",I18n.t("js.item_box.action.post.pre"),"",created_at_in_words,"",I18n.t("js.item_box.action.post.post"),"\n        "):trackable_type=="StockItem"?__p.push("\n            ",I18n.t("js.item_box.action.stock"),"\n        "):trackable_type=="Tagging"&&__p.push("\n          ",I18n.t("js.item_box.action.new_post"),"\n        "),__p.push('\n      </div>\n      <div class="item-box-title">\n        <h1>\n          <a href="',mentioned_object_url,'" title="',(""+mentioned_object_name).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'">\n            ',(""+mentioned_object_name).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'\n          </a>\n        </h1>\n        <ul class="item-box_tagList list-unstyled">\n          '),_.each(mentioned_object_tags,function(tag){__p.push('\n            <li>\n              <a href="/tags/',tag.url_name,'">\n                ',(""+tag.name).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n              </a>\n            </li>\n          ")}),__p.push('\n        </ul>\n      </div>\n      <div class="item-status-box">\n        <ul class="unstyled">\n          <li>\n            <i class="fa fa-stock"></i>\n            ',mentioned_object_stocks_count,'\n          </li>\n          <li>\n            <a href="',mentioned_object_url,'#comments">\n              <i class="fa fa-comment-o"></i>\n              ',mentioned_object_comments_count,'\n            </a>\n          </li>\n        </ul>\n      </div>\n    </div>\n    <div class="item-body-wrapper">\n      <div id="item-',mentioned_object_uuid,'" class="item-body markdownContent bordered">\n        ',mentioned_object_body,'\n      </div>\n    </div>\n  </div>\n  <div class="loading"></div>\n</div>\n<fieldset class="toggle-button-field">\n  <legend class="toggle-button">\n    <span class="expand"><i class="fa fa-angle-double-down"></i></span>\n    <span class="close"><i class="fa fa-angle-double-up"></i></span>\n  </legend>\n</fieldset>\n');return __p.join("")}}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.PublicDomainArticleTrackView=function(_super){function PublicDomainArticleTrackView(){return PublicDomainArticleTrackView.__super__.constructor.apply(this,arguments)}return __extends(PublicDomainArticleTrackView,_super),PublicDomainArticleTrackView.prototype.className=function(){var name;return name="item-box track",this.model.get("repeated")&&(name+=" hidden"),name},PublicDomainArticleTrackView.prototype.templatePath="t/tracks/public_domain_article",PublicDomainArticleTrackView}(namespace.TrackView)}.call(this),function(){this.JST||(this.JST={}),this.JST["t/tracks/tag_followlist"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<span class="user">\n  <a href="',followable_url,'" target="_blank">\n    <img src="',followable_image_url,'">',followable_name,"\n  </a>\n</span>\n",I18n.t("js.tag-box.pre"),'\n<a href="',mentioned_object_url,'" target="_blank">\n  <img src="',mentioned_object_image_url,'">',(""+mentioned_object_name).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n</a>\n",I18n.t("js.tag-box.post"),"\n");return __p.join("")}}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.TagFollowlistTrackView=function(_super){function TagFollowlistTrackView(){return TagFollowlistTrackView.__super__.constructor.apply(this,arguments)}return __extends(TagFollowlistTrackView,_super),TagFollowlistTrackView.prototype.className="tag-box",TagFollowlistTrackView.prototype.templatePath="t/tracks/tag_followlist",TagFollowlistTrackView}(namespace.TrackView)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.StreamView=function(_super){function StreamView(){return StreamView.__super__.constructor.apply(this,arguments)}return __extends(StreamView,_super),StreamView.prototype.appendBuffer=null,StreamView.prototype.prependBuffer=null,StreamView.prototype.shown=!1,StreamView.prototype.events={"click .more-button":"onClickMoreButton","click .flush-button":"onClickFlushButton","keypress .more-button":"onKeyPressMoreButton"},StreamView.prototype.initialize=function(){var $textField,_ref;this.appendBuffer=[],this.prependBuffer=[],this.listenTo(this.collection,"reset",this.render),this.listenTo(this.collection,"add",this.addToBuffer),this.listenTo(this.collection,"active",this.show),this.listenTo(this.collection,"deactive",this.hide),this.listenTo(this.collection,"error",this.renderFetchError);if((_ref=this.collection.type)==="stock"||_ref==="mine")this.$el.append(JST["t/stream/search_form"]({stocked:this.collection.type==="stock",type:this.collection.type})),$textField=this.$(".js-stream_searchForm_textField"),$textField.on("keyup",function(_this){return function(){var query;return query=$textField.val(),_this.collection.type==="mine"&&(query+=" user:"+Qiita.user.url_name),_this.$(".js-stream_searchForm_searchQuery").val(query)}}(this));return this.$inner=$("<div></div>"),this.$inner.html(JST["t/stream/circle-loading"]()),this.$el.append(this.$inner)},StreamView.prototype.show=function(){return this.$el.addClass("active")},StreamView.prototype.hide=function(){return this.$el.removeClass("active")},StreamView.prototype.showFlushButton=function(){return this.shown||(this.$(".flush-button").addClass("active"),this.shown=!0),this.$(".flush-button").html(I18n.t("js.stream.notification",{count:this.prependBuffer.length}))},StreamView.prototype.render=function(){var html;return this.collection.isEmpty()?Qiita.teamName?(html=function(){switch(this.collection.type){case"following":return JST["t/teams/feed-tutorial"]({teamName:Qiita.teamName});case"stock":return"No stocks.";case"mine":return"No posts."}}.call(this),this.$inner.html(html)):this.$inner.html(JST["t/no_posts_yet"]()):(this.$inner.html(JST["t/stream/inner"]()),this.renderModels(this.collection.models),(this.collection.hasNext===void 0||this.collection.constructor.checkExistenceOfNextPage(this.collection))&&this.$inner.find(".tail").html(JST["t/stream/more-button"]())),this},StreamView.prototype.renderModels=function(models,append){var el;return el=document.createDocumentFragment(),_.chain(models).sortBy(function(model){return-model.get("created_at_as_seconds")}).each(function(_this){return function(model){return el.appendChild(_this.createView(model).render().el)}}(this)),this.$inner.children(".activities")[append?"append":"prepend"](el)},StreamView.prototype.renderFetchError=function(){if(this.collection.isEmpty())return this.$inner.html(JST["t/stream/fail_to_fetch"])},StreamView.prototype.onClickMoreButton=function(e){return this.loadMoreItems(e)},StreamView.prototype.onKeyPressMoreButton=function(e){if(e.keyCode===13)return this.loadMoreItems(e)},StreamView.prototype.onClickFlushButton=function(){return this.$(".flush-button").removeClass("active"),this.shown=!1,this.renderModels(this.prependBuffer,!1),this.prependBuffer=[]},StreamView.prototype.loadMoreItems=_.lock(function(free){return this.$(".tail").html(JST["t/stream/circle-loading"]()),this.collection.fetchNextPage().done(function(_this){return function(items){return _this.$(".tail").html(_this.collection.hasNext===!0||_this.collection.hasNext===void 0&&items.length?JST["t/stream/more-button"]():""),free()}}(this))}),StreamView.prototype.createView=function(model){var viewClass;return viewClass=function(){switch(model.get("target_content_type")){case"item":return namespace.ItemActivityView;case"user":return namespace.UserActivityView;case"tag":return namespace.TagActivityView;default:switch(model.get("trackable_type")){case"Comment":case"PublicDomainArticle":case"StockItem":case"Tagging":return namespace.PublicDomainArticleTrackView;case"FollowingUser":return namespace.FollowingUserTrackView;case"TagFollowlist":return namespace.TagFollowlistTrackView}}}(),new viewClass({model:model,streamType:this.collection.type})},StreamView.prototype.addToBuffer=function(model,collection,options){return options.append?(_.isEmpty(this.appendBuffer)&&_.defer(function(_this){return function(){return _this.renderModels(_this.appendBuffer,!0),_this.appendBuffer=[]}}(this)),this.appendBuffer.push(model)):(this.prependBuffer.push(model),this.showFlushButton()),this},StreamView}(Backbone.View)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.StreamContainerView=function(_super){function StreamContainerView(){return StreamContainerView.__super__.constructor.apply(this,arguments)}return __extends(StreamContainerView,_super),StreamContainerView.prototype.el=".streamContainer",StreamContainerView.prototype.activeType=null,StreamContainerView.prototype.events={"click nav a":"onClickTab"},StreamContainerView.prototype.initialize=function(options){var collection,type,_ref,_results;this.$nav=this.$("nav"),this.collections=options.collections,_ref=this.collections,_results=[];for(type in _ref){if(!__hasProp.call(_ref,type))continue;collection=_ref[type],this.listenTo(collection,"active",this.changeActiveTab),_results.push(new namespace.StreamView({collection:collection,el:this.$("."+type+"-stream")}))}return _results},StreamContainerView.prototype.changeActiveTab=function(collection){return this.activeType=collection.type,this.$nav.find(".active").removeClass("active"),this.$nav.find("."+this.activeType+"-tab").addClass("active")},StreamContainerView.prototype.onClickTab=function(e){return e.preventDefault(),this.navigateTo($(e.target))},StreamContainerView.prototype.navigateTo=_.debounce(function($target){var type;return type=$target.parent().data("type"),this.activeType===type?this.collections[this.activeType].fetchPrevPage():(Qiita.analysis.changeTab({tab:type}),Backbone.history.navigate($target.attr("href"),!0))},1e3,!0),StreamContainerView}(Backbone.View)}.call(this);var I18n=I18n||{};I18n.addTranslations({en:{js:{views:{registration:{"new":{email_suggestion_html:"Did you mean: %{address}@<b>%{domain}</b>?"}}}}},ja:{js:{views:{registration:{"new":{email_suggestion_html:"もしかして: %{address}@<b>%{domain}</b>"}}}}}}),function(){var ACCEPTABLE_TLD,namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),ACCEPTABLE_TLD=Mailcheck.defaultTopLevelDomains.concat(["co.jp","ne.jp"]),namespace.MailcheckView=function(_super){function MailcheckView(){return MailcheckView.__super__.constructor.apply(this,arguments)}return __extends(MailcheckView,_super),MailcheckView.prototype.el="#user_email",MailcheckView.prototype.events={"keyup input":"mailcheck"},MailcheckView.prototype.initialize=function(){return this.$el.wrap($("<div></div>")),this.$input=this.$el,this.setElement(this.$input.parent()),this.$message=$('<div class="help-block"></div>'),this.$message.hide().appendTo(this.$el)},MailcheckView.prototype.mailcheck=function(e){if(!/@([^.]+\.)+.+$/.test(e.target.value))return;return this.$input.mailcheck({topLevelDomains:ACCEPTABLE_TLD,suggested:function(_this){return function(element,suggestion){var suggestion_html;return suggestion_html=I18n.t("js.views.registration.new.email_suggestion_html",{address:suggestion.address,domain:suggestion.domain}),_this.$message.fadeIn(200).html(suggestion_html)}}(this),empty:function(_this){return function(){return _this.$message.slideUp(200).html("")}}(this)})},MailcheckView}(Backbone.View)}.call(this),function(){var HomeRouter,TYPE,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};if(!!Qiita.teamName||Qiita.controller!=="home")return;TYPE=["following","public","mine","stock"],HomeRouter=function(_super){function HomeRouter(){return HomeRouter.__super__.constructor.apply(this,arguments)}return __extends(HomeRouter,_super),HomeRouter.prototype.routes={"":"followingOrLanding",items:"items",mine:"mine",stock:"stock"},HomeRouter.prototype.followingOrLanding=function(){return Qiita.user?this.following():this.landingPage()},HomeRouter.prototype.following=function(){var type,_i,_len,_results;if(Qiita.variant!=="phone"){this.setUpIndexPage(),this.collections.following.activate(),_results=[];for(_i=0,_len=TYPE.length;_i<_len;_i++)type=TYPE[_i],type!=="following"&&_results.push(this.collections[type].deactivate());return _results}},HomeRouter.prototype.landingPage=function(){return $(".js-form-toggle-link").on("click",function(){return $(".js-oauth-signup-form").hide(),$(".js-signup-form").addClass("active")}),$(".js-cancel-link").on("click",function(){return $(".js-signup-form").removeClass("active"),$(".js-oauth-signup-form").show()}),new Qiita.views.MailcheckView,new Qiita.views.settings.PasswordStrengthView({el:$("#js-password")})},HomeRouter.prototype.items=function(){var type,_i,_len,_results;this.setUpIndexPage(),this.collections["public"].activate(),_results=[];for(_i=0,_len=TYPE.length;_i<_len;_i++)type=TYPE[_i],type!=="public"&&_results.push(this.collections[type].deactivate());return _results},HomeRouter.prototype.mine=function(){var type,_i,_len,_results;this.setUpIndexPage(),this.collections.mine.activate(),_results=[];for(_i=0,_len=TYPE.length;_i<_len;_i++)type=TYPE[_i],type!=="mine"&&_results.push(this.collections[type].deactivate());return _results},HomeRouter.prototype.stock=function(){var type,_i,_len,_results;this.setUpIndexPage(),this.collections.stock.activate(),_results=[];for(_i=0,_len=TYPE.length;_i<_len;_i++)type=TYPE[_i],type!=="stock"&&_results.push(this.collections[type].deactivate());return _results},HomeRouter.prototype.setUpIndexPage=_.once(function(){var tab,_i,_len,_ref;navigator.userAgent.indexOf("Mac")!==-1&&Qiita.tutorial&&$(".kobito-ad").show(),_ref=["following","public","mine"];for(_i=0,_len=_ref.length;_i<_len;_i++)tab=_ref[_i],$("#local-nav-"+tab).on("click",function(){return analysis.changeTab({tab:tab})});this.collections={following:new Qiita.collections.TrackList,"public":new Qiita.collections.ActivityList(null,{type:"public"}),mine:new Qiita.collections.ActivityList(null,{type:"mine"}),stock:new Qiita.collections.ActivityList(null,{type:"stock"})},new Qiita.views.StreamContainerView({collections:this.collections});switch(location.hash){case"#public":return Backbone.history.navigate("items",!0);case"#mine":return Backbone.history.navigate("mine",!0)}}),HomeRouter}(Backbone.Router),new HomeRouter}.call(this),function(){var namespace;namespace=ns("analysis"),namespace.careerSelectButtonClick=namespace.wrap([namespace.mixpanel("Career Select Button Click",function(props){return{type:props.type,position:props.position,logged_in:!!Qiita.user}}),namespace.analytics("Button","Click",function(props){return{eventLabel:props.type}})])}.call(this),function(){var namespace;namespace=ns
("analysis"),namespace.sendAHumanResource=namespace.wrap([namespace.mixpanel("Send a human resource",function(props){return{saint_media:props.saintMedia,smazin:props.smazin,logged_in:!!Qiita.user}}),namespace.analytics("HumanResource","Send",function(props){var label;return label=[],props.saintMedia&&label.push("saintmedia"),props.smazin&&label.push("smazin"),{eventLabel:label.join("&")}})])}.call(this),function(){var HumanResourcesRouter,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};if(Qiita.controller!=="human_resources")return;HumanResourcesRouter=function(_super){function HumanResourcesRouter(){return HumanResourcesRouter.__super__.constructor.apply(this,arguments)}return __extends(HumanResourcesRouter,_super),HumanResourcesRouter.prototype.routes={"new":"new"},HumanResourcesRouter.prototype["new"]=function(){return this.bindToggleTerms(),this.bindSendAHumanResourceEvent()},HumanResourcesRouter.prototype.bindToggleTerms=function(){return $(".js-toggleLink").on("click",function(ev){return $($(this).data("target")).toggleClass("active")})},HumanResourcesRouter.prototype.bindSendAHumanResourceEvent=function(){return $("#new_human_resource").one("submit",function(ev){return ev.preventDefault(),Qiita.analysis.sendAHumanResource({saintMedia:!!$("#human_resource_net_jinzai_bank").attr("checked"),smazin:!!$("#human_resource_smazin").attr("checked"),phone:!!$("#human_resource_phone").val()}).always(function(_this){return function(){return _this.submit()}}(this))})},HumanResourcesRouter}(Backbone.Router),new HumanResourcesRouter}.call(this),function(){var actionType,namespace;namespace=ns("analysis"),actionType="Post a comment",namespace.postAComment=namespace.wrap([namespace.favorableActionFactory(actionType),namespace.mixpanel(actionType,function(props){return{item_uuid:props.uuid}}),namespace.analytics("Comment","Create")])}.call(this),function(){var mixins,namespace,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views.items"),namespace.CommentFormView=function(_super){function CommentFormView(){return this.onKeyDown=__bind(this.onKeyDown,this),CommentFormView.__super__.constructor.apply(this,arguments)}return __extends(CommentFormView,_super),CommentFormView.prototype.expanded=!1,CommentFormView.prototype.isAsyncPostEnabled=!1,CommentFormView.prototype.events={"click .js-commentRawBody":"onClickCommentBody","click .js-emojiPickerLauncher":"toggleEmojiPicker","click .js-submitBtn":"onClickSubmit",keydown:"onKeyDown"},CommentFormView.prototype.initialize=function(options){var _ref;this.options=options,this.isAsyncPostEnabled=(_ref=this.options)!=null?_ref.enableAsyncPost:void 0,this.bindMixin();if(document.activeElement===this.$(".js-commentRawBody").get(0))return this.showContents()},CommentFormView.prototype.onKeyDown=function(ev){var _ref;if(((_ref=ev.keyCode)===10||_ref===13)&&(ev.ctrlKey||ev.metaKey))return ev.preventDefault(),this.submit()},CommentFormView.prototype.onClickCommentBody=function(e){return this.showContents()},CommentFormView.prototype.onClickSubmit=function(e){return e.preventDefault(),this.submit()},CommentFormView.prototype.showContents=function(){var content;if(this.expanded)return;return this.expanded=!0,this.renderUploadableSize(),content=this.$(".js-commentContent"),content.find(".js-commentRawBody").css({"min-height":140}).animate({height:"10em"},150),content.find(".js-commentFadein").fadeIn(),content.addClass("image-uploadable-textarea")},CommentFormView.prototype.hideTooltips=function(){var _ref;return(_ref=this.emojiPicker)!=null?_ref.hide():void 0},CommentFormView.prototype.remove=function(){var _ref;return(_ref=this.emojiPicker)!=null&&_ref.remove(),this.emojiPicker=null,CommentFormView.__super__.remove.apply(this,arguments)},CommentFormView.prototype.toggleEmojiPicker=function(){return this.emojiPicker||(this.emojiPicker=new Qiita.views.EmojiPickerView({textarea:this.$("textarea")[0]}),this.emojiPicker.render().$el.appendTo(document.body).offset(this._emojiPickerInitPos())),this.emojiPicker.toggle()},CommentFormView.prototype.submit=_.lock(function(free){var $submitBtn;return $submitBtn=this.$(".js-submitBtn").addClass("disabled"),/^\s*$/.test(this.$("textarea").val())?($submitBtn.removeClass("disabled"),free()):this.isAsyncPostEnabled?this.asyncPost().always(function(){return $submitBtn.removeClass("disabled"),free()}).done(function(){return Qiita.analysis.postAComment()}):this.model.isNew()?Qiita.analysis.postAComment().always(function(_this){return function(){return $submitBtn.removeClass("disabled"),_this.$el.submit()}}(this)):this.$el.submit()}),CommentFormView.prototype.asyncPost=function(){var xhr;return(xhr=this.model.save(this.$el.formData().comment))?xhr:jQuery.Deferred().reject()},CommentFormView.prototype._emojiPickerInitPos=function(){var offset;return offset=this.$el.offset(),{top:offset.top,left:offset.left+this.$el.width()+10}},CommentFormView}(Backbone.View),mixins=Qiita.mixins,Qiita.util.mixin(namespace.CommentFormView,mixins.PreviewableMixin,mixins.AutocompleteMixin,mixins.ImageAuthorshipMixin,mixins.AutoindentMixin)}.call(this);var I18n=I18n||{};I18n.addTranslations({en:{js:{views:{items:{editable_comment_view:{cancel:"Cancel"},stock_button:{active:"Stock this post",deactive:"Unstock",clicked:"Stocking",activating:"Stocking",deactivating:"Unstocking"},toc_view:{toc:"TOC"},comment_view:{thank_html:'<i class="fa fa-smile-o"></i>Thank',thanked_html:"Sent Thanks"},thank_button:{active:'<i class="fa fa-smile-o"></i>Thank',deactive:"Sent Thanks"}}}}},ja:{js:{views:{items:{editable_comment_view:{cancel:"キャンセル"},stock_button:{active:"この投稿をストックする",deactive:"ストックを解除",activating:"ストック中",deactivating:"ストックを解除中"},toc_view:{toc:"目次"},comment_view:{thank_html:'<i class="fa fa-smile-o"></i>Thank',thanked_html:"Thankを伝えました"},thank_button:{active:'<i class="fa fa-smile-o"></i>Thank',deactive:"Thankを伝えました"}}}}}}),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views.items"),namespace.ThankView=function(_super){function ThankView(){return ThankView.__super__.constructor.apply(this,arguments)}return __extends(ThankView,_super),ThankView.prototype.namespace="js.views.items.thank_button",ThankView.prototype.activeClass=null,ThankView.prototype.activatingText=null,ThankView.prototype.deactivatingText=null,ThankView.prototype.isActive=function(){return!this.model.get("thanked")},ThankView.prototype.execute=function(){return this.model.toggleThanked()},ThankView.prototype.bindRenderEvent=function(){return this.model.set("thanked",this.$el.hasClass("thanked")),this.listenTo(this.model,"change:thanked",this.render)},ThankView.prototype.modalSettings=function(){return{action:"thank",target:this.model.id,type:"thank"}},ThankView}(Qiita.views.ResponsiveButtonView)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views.items"),namespace.CommentView=function(_super){function CommentView(){return CommentView.__super__.constructor.apply(this,arguments)}return __extends(CommentView,_super),CommentView.prototype.initialize=function(){return this.listenTo(this.model,"remove",this.remove),this.listenTo(this.model,"change:html",this.render),this.listenTo(this.model,"change:thanked",this.renderThankBtn)},CommentView.prototype.render=function(){var _ref;return this.model.has("html")&&((_ref=this.view)!=null&&_ref.remove(),this.view=null,this.$el.html(this.model.get("html")),this.trigger("change:html")),this.view||(this.view=new namespace.ThankView({model:this.model,el:this.$(".js-thank-btn")})),this},CommentView.prototype.renderThankBtn=function(){var $btn;return $btn=this.$(".js-thank-btn"),this.model.get("thanked")?$btn.addClass("thanked").html(I18n.t("js.views.items.comment_view.thanked_html")):$btn.removeClass("thanked").html(I18n.t("js.views.items.comment_view.thank_html"))},CommentView.prototype.remove=function(){var _ref;return(_ref=this.view)!=null&&_ref.remove(),CommentView.__super__.remove.apply(this,arguments)},CommentView.parse=function($el,options){var attrs,model;return attrs=_.parse($el.find(".js-comment").html()),model=new Qiita.models.Comment(attrs),this.create(model,$el,options).render()},CommentView.createByModel=function(model,options){return this.create(model,null,options)},CommentView.create=function(model,$el,options){var viewClass;return viewClass=model.isEditable()?namespace.EditableCommentView:this,new viewClass(_.extend({model:model,el:$el},options))},CommentView}(Backbone.View)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views.items"),namespace.EditableCommentView=function(_super){function EditableCommentView(){return EditableCommentView.__super__.constructor.apply(this,arguments)}return __extends(EditableCommentView,_super),EditableCommentView.prototype.events={"click .js-edit":"onClickEdit","click .js-cancel-btn":"onClickCancel"},EditableCommentView.prototype.initialize=function(_arg){return this.enableAsyncPost=(_arg!=null?_arg:{}).enableAsyncPost,EditableCommentView.__super__.initialize.apply(this,arguments),this.listenTo(this,"change:html",this._resetFormView),this.formView=this._createFormView()},EditableCommentView.prototype.onClickEdit=function(e){return e.preventDefault(),this.$(".js-comment-body").hide(),this.$(".js-embedded-comment-form").show(),this.formView.showContents()},EditableCommentView.prototype.onClickCancel=function(e){return this.$(".js-comment-body").show(),this.$(".js-embedded-comment-form").hide(),this.formView.hideTooltips()},EditableCommentView.prototype._resetFormView=function(){var _ref;return(_ref=this.formView)!=null&&_ref.remove(),this.formView=this._createFormView()},EditableCommentView.prototype._createFormView=function(){return new namespace.CommentFormView({el:this.$("form"),model:this.model,enableAsyncPost:this.enableAsyncPost})},EditableCommentView}(namespace.CommentView)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views.items"),namespace.CommentListView=function(_super){function CommentListView(){return CommentListView.__super__.constructor.apply(this,arguments)}return __extends(CommentListView,_super),CommentListView.prototype.initialize=function(_arg){return this.enableAsyncPost=(_arg!=null?_arg:{}).enableAsyncPost,this.$(".comment").each(function(_this){return function(index,el){var view;return view=namespace.CommentView.parse($(el),{enableAsyncPost:_this.enableAsyncPost}),_this.collection.add(view.model,{silent:!0})}}(this)),this.listenTo(this.collection,"add",this.appendComment)},CommentListView.prototype.appendComment=function(model){var view;return view=namespace.CommentView.createByModel(model,{enableAsyncPost:this.enableAsyncPost}),this.$el.append(view.render().el),view.$(".task-list-item-checkbox").attr("disabled",null)},CommentListView}(Backbone.View)}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views.items"),namespace.NewCommentView=function(_super){function NewCommentView(){return NewCommentView.__super__.constructor.apply(this,arguments)}return __extends(NewCommentView,_super),NewCommentView.prototype.initialize=function(_arg){return this.collection=_arg.collection,this.enableAsyncPost=_arg.enableAsyncPost,this.initialFormEl=this.$("form").clone(!1),this.resetFormView()},NewCommentView.prototype.resetFormView=function(){return this.formView&&(this.$el.append(this.initialFormEl.clone()),this.formView.remove()),this.resetModel(),this.formView=new namespace.CommentFormView({el:this.$("form"),model:this.model,enableAsyncPost:this.enableAsyncPost})},NewCommentView.prototype.resetModel=function(){return this.model&&this.stopListening(this.model),this.model=new Qiita.models.Comment,this.listenTo(this.model,"sync",this.onPostComment)},NewCommentView.prototype.onPostComment=function(comment){return this.collection.add(comment),this.resetFormView()},NewCommentView}(Backbone.View)}.call(this),function(){var namespace;namespace=ns("analysis"),namespace.toggleToc=namespace.wrap([namespace.mixpanel("Toggle TOC",function(props){return{type:props.type,logged_in:!!Qiita.user}}),namespace.analytics("TOC","Toggle",function(props){return{eventLabel:props.type}})])}.call(this),function(){var key,namespace,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views.items"),key="items#show:toc-collapsed",namespace.TocView=function(_super){function TocView(){return this.renderContents=__bind(this.renderContents,this),TocView.__super__.constructor.apply(this,arguments)}return __extends(TocView,_super),TocView.prototype.collapsed=null,TocView.prototype.promise=null,TocView.prototype.className="tocTree",TocView.prototype.initialize=function(options){return options==null&&(options={}),this.$bodyEl=options.$bodyEl,this.promise=this.buildTocTree().done(this.renderContents).fail(function(_this){return function(){return _this.remove(),_this.trigger("empty")}}(this))},TocView.prototype.adjustToScreenHeight=function(offset){var screenHeight;return offset==null&&(offset=10),screenHeight=$(window).height(),this.promise.done(function(_this){return function(){var padding;return padding=parseInt(_this.$el.css("padding-top"),10)*2,_this.$(".js-tocTreeContents").css({maxHeight:screenHeight-padding-offset*2})}}(this)),this},TocView.prototype.renderContents=function($contents){return this.$contentsEl=$('<div class="tocTree_contents js-tocTreeContents"></div>').append($contents).appendTo(this.$el),this.adjustToScreenHeight(),this.runScrollspy()},TocView.prototype.activateScrollspy=function($body){var className;return className=this.$el.attr("class").split(" ")[0],$body.scrollspy({target:"."+className})},TocView.prototype.runScrollspy=function(){return $("body").scrollspy({target:".js-tocTreeContents"})},TocView.prototype.buildTocTree=function(){var dfd,tocArray;return dfd=$.Deferred(),tocArray=this.parseBody(),_.defer(function(_this){return function(){var $contents;return tocArray.length>0?($contents=_this.parseTocArray(tocArray),dfd.resolve($contents)):dfd.reject()}}(this)),dfd.promise()},TocView.prototype.parseBody=function(){var currentArray,prevLevel,tocArray;return tocArray=currentArray=[],tocArray.level=prevLevel=0,this.$bodyEl||(this.model.$body||this.model.loadBody(),this.$bodyEl=this.model.$body),this.$bodyEl.children().each(function(i,el){var childArray,currentLevel,match;match=el.tagName.match(/^H(\d)/);if(!match||!$(el).text())return;currentLevel=parseInt(match[1],10);if(prevLevel>currentLevel)while(currentArray.parent.level>=currentLevel)currentArray=currentArray.parent;else prevLevel<currentLevel&&(childArray=[],childArray.parent=currentArray,childArray.level=currentLevel,currentArray.push(childArray),currentArray=childArray);return currentArray.push(el),prevLevel=currentLevel}),tocArray[0]||[]},TocView.prototype.parseTocArray=function(tocArray){var $el,el,fragment,text,ul,_i,_len;ul=$('<ul class="nav"></ul>');for(_i=0,_len=tocArray.length;_i<_len;_i++){el=tocArray[_i];if(_.isArray(el))ul.children(":last-child").append(this.parseTocArray(el));else{$el=$(el),text=_.escape($el.text());if(fragment=$el.find("a").attr("href"))text="<a href='"+fragment+"' track='click' data-label='TOC'>"+text+"</a>";ul.append($("<li>"+text+"</li>"))}}return ul},TocView}(Backbone.View)}.call(this),function(){var ItemsRouter,items,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};if(Qiita.controller!=="items")return;items=Qiita.views.items,ItemsRouter=function(_super){function ItemsRouter(){return ItemsRouter.__super__.constructor.apply(this,arguments)}return __extends(ItemsRouter,_super),ItemsRouter.prototype.routes={":user_id/:type/:id":function(user_id,type,id){if((type==="items"||type==="private")&&id!=="new")return this.show(id)}},ItemsRouter.prototype.show=function(uuid){var id,item,tocView,_i,_len,_ref,_results;item=new Qiita.models.Item(_.parse($("#js-item").html())),Qiita.db.items.add(item),new items.CommentListView({el:".js-comments",collection:item.comments,enableAsyncPost:!1}),new items.NewCommentView({el:".js-new-comment",collection:item.comments,enableAsyncPost:!1}),$("#single-item-status-box ul li").hover(function(){return $(this).find(".tooltip").toggle()}),window.innerWidth>767&&(tocView=new Qiita.views.items.TocView({model:item}),tocView.render().$el.insertBefore($(".js-tocAnchor")),$(".scroll-chaser").scrollChaser({wrapper:".scroll-chaser-wrapper",offsetTop:10})),_ref=["#item-"+item.id,"#comments"],_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++)id=_ref[_i],_results.push(Qiita.MathJaxHelper.run($(id)));return _results},ItemsRouter}(Backbone.Router),new ItemsRouter}.call(this),function(){this.JST||(this.JST={}),this.JST["t/typeahead"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push(""),typeof iconUrl!="undefined"&&__p.push('\n  <img src="',iconUrl,'"/>\n'),__p.push("\n<p>\n  ",value,"\n  "),typeof count!="undefined"&&__p.push("\n    (",count,")\n  "),__p.push("\n</p>\n");return __p.join("")}}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};if(Qiita.controllerPath!=="organizations/settings/members")return;new(function(_super){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return __extends(_Class,_super),_Class.prototype.routes={"organizations/:organization_id/settings/members":"index"},_Class.prototype.index=function(organization_id){return Qiita.ttSources.publicUsersSource.initialize(),$("#member_url_name").typeahead({highlight:!0,hint:!1},{name:"member",templates:{suggestion:JST["t/typeahead"]},source:Qiita.ttSources.publicUsersSource.ttAdapter()})},_Class}(Backbone.Router))}.call(this),function(){var namespace;namespace=ns("analysis"),namespace.signup=namespace.wrap([namespace.mixpanel("Signup"),namespace.analytics("Account","Signup")])}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};if(Qiita.controller!=="registration")return;new(function(_super){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return __extends(_Class,_super),_Class.prototype.routes={registration:"new","registration/new":"new"},_Class.prototype["new"]=function(){return new Qiita.views.MailcheckView,$("form").one("submit",function(ev){return ev.preventDefault(),$.when(Qiita.analysis.formSubmit({event_name:"Signup with password"}),Qiita.analysis.signup()).always(function(_this){return function(){return _this.submit()}}(this))})},_Class}(Backbone.Router))}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};if(Qiita.controllerPath!=="sessions/kobito")return;new(function(_super){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return __extends(_Class,_super),_Class.prototype.routes={"signup/kobito":"new"},_Class.prototype["new"]=function(){return new Qiita.views.MailcheckView,$(".js-openSignupForm").on("click",function(){return $(".js-oauthSignupWrapper").removeClass("active"),$(".js-emailSignupWrapper").addClass("active")}),$(".js-openOauthForm").on("click",function(){return $(".js-oauthSignupWrapper").addClass("active"),$(".js-emailSignupWrapper").removeClass("active")})},_Class}(Backbone.Router))}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};if(Qiita.controllerPath!=="sessions")return;new(function(_super){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return __extends(_Class,_super),_Class.prototype.routes={signup:"new"},_Class.prototype["new"]=function(){return new Qiita.views.MailcheckView},_Class}(Backbone.Router))}.call(this);var I18n=I18n||{};I18n.addTranslations({en:{js:{routes:{settings:{passwords:{password_mismatch:"Password does not much",min_word_count:"Password must be more than %{count} characters"}}}}},ja:{js:{routes:{settings:{passwords:{password_mismatch:"パスワードが一致していません",min_word_count:"パスワードは%{count}文字以上で入力して下さい"}}}}}});var I18n=I18n||{};I18n.addTranslations({en:{js:{templates:null}},ja:{js:{templates:null}}});var I18n=I18n||{};I18n.addTranslations({en:{js:{views:{settings:{password_strength_view:{strength:{very_weak:"Very Weak",weak:"Weak",medium:"Medium",strong:"Strong",very_strong:"Very Strong"}},profiles:{form_view:{url_name:{valid:"Username is available.",invalid_length:"Please use between 3 and 32 characters.",invalid_characters:"Please use only letters (a-z), numbers, underscores, and dashes.",already_exists:"Someone already has that username. Try another?",please_merge:"Or, is this your other Qiita account? <a href='/settings/account'>You can merge it into current account.</a>"}}}}}}},ja:{js:{views:{settings:{password_strength_view:{strength:{very_weak:"とても弱い",weak:"弱い",medium:"まずまず",strong:"強い",very_strong:"とても強い"}},profiles:{form_view:{url_name:{valid:"このユーザ名は利用できます。",invalid_length:"3〜32文字の範囲で入力してください。",invalid_characters:"アルファベット（a〜z）、数字、ハイフン、アンダースコア以外は使用できません。",already_exists:"そのユーザ名を持つユーザが既に存在します。別の名前を入力してください。",please_merge:"もしくはこれがあなたの他のQiitaアカウントなら、<a href='/settings/account'>データを結合することができます。</a>"}}}}}}}}),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views.settings"),namespace.PasswordStrengthView=function(_super){function PasswordStrengthView(){return PasswordStrengthView.__super__.constructor.apply(this,arguments)}var I18N_NAME_SPACE;return __extends(PasswordStrengthView,_super),I18N_NAME_SPACE="js.views.settings.password_strength_view.",PasswordStrengthView.prototype.initialize=function(){var strengthes;return this.$el.append('<span id="js-password_verdict" class="form-control-feedback password_verdict" />'),strengthes=_.map(["very_weak","weak","medium","strong","very_strong"],function(name){return I18n.t(""+I18N_NAME_SPACE+"strength."+name)}),this.$("input").pwstrength({common:{minChar:8},ui:{bootstrap2:!1,showStatus:!0,showProgressBar:!1,verdicts:strengthes,viewports:{verdict:"#js-password_verdict"}}})},PasswordStrengthView}(Backbone.View)}.call(this),function(){var PasswordsRouter,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__slice=[].slice;if(Qiita.controller!=="passwords"||!!Qiita.teamName)return;PasswordsRouter=function(_super){function PasswordsRouter(){return PasswordsRouter.__super__.constructor.apply(this,arguments)}return __extends(PasswordsRouter,_super),PasswordsRouter.prototype.routes={"settings/password/new":"new","settings/password":"edit"},PasswordsRouter.prototype["new"]=function(){return this.bindEventHandlers()},PasswordsRouter.prototype.edit=function(){return this.bindEventHandlers()},PasswordsRouter.prototype.i18n=function(){var args,name;return name=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],args.unshift("js.routes.settings.passwords."+name),I18n.t.apply(I18n,args)},PasswordsRouter.prototype.bindEventHandlers=function(){return this.$password=$(".password").on("change",function(_this){return function(){return _this.validate()}}(this)),this.$message=$(".js-validMessage"),$("#password-form").on("submit",function(_this){return function(e){if(!_this.validate())return e.preventDefault()}}(this)),new Qiita.views.settings.PasswordStrengthView({el:$("#js-password")})},PasswordsRouter.prototype.validate=function(){return this.$password.val().length<8?(this.$message.text(this.i18n("min_word_count",{count:8})).fadeIn(),!1):(this.$message.text("").hide(),!0)},PasswordsRouter}(Backbone.Router),new PasswordsRouter}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views.settings.profiles"),namespace.FormView=function(_super){function FormView(){return FormView.__super__.constructor.apply(this,arguments)}var I18N_NAME_SPACE;return __extends(FormView,_super),I18N_NAME_SPACE="js.views.settings.profiles.form_view.",FormView.prototype.events={submit:"onSubmit"},FormView.prototype.initialize=function(){var el;this.$urlNameGroup=this.$(".url_name-group"),this.$urlNameMessage=this.$(".url_name-validation-message"),this.$("#user_url_name").on("focus",_.bind(this.resetUrlNameMessage,this)).on("blur",_.bind(this.validateUrlNameAsync,this)),el=this.$("#js-user"),this.can_update_url_name=el.length>0;if(this.can_update_url_name)return this.initUrlName=el.data("url_name")},FormView.prototype.renderValidationMessage=function(type,level,url_name){var html;return this.$urlNameGroup.addClass(level),html=I18n.t(""+I18N_NAME_SPACE+"url_name."+type),type==="already_exists"&&this.initUrlName===""+url_name+"@github"&&(html+="<br/>"+I18n.t(""+I18N_NAME_SPACE+"url_name.please_merge")),this.$urlNameMessage.html(html).show()},FormView.prototype.resetUrlNameMessage=function(){return this.$urlNameGroup.removeClass("error").removeClass("success"),this.$urlNameMessage.hide()},FormView.prototype.validateUrlNameAsync=function(){var url_name;url_name=this.getValues().url_name;if(url_name!==this.initUrlName)return this.model.validateUrlName(url_name).done(function(_this){return function(type){return _this.renderValidationMessage(type,"success",url_name),_this.invalidUrlName=!1}}(this)).fail(function(_this){return function(type){return _this.renderValidationMessage(type,"error",url_name),_this.invalidUrlName=!0}}(this))},FormView.prototype.onSubmit=function(e){if(this.invalidUrlName)return e.preventDefault();if(!this.model.set(this.getValues(),{varidate:!0}))return e.preventDefault()},FormView.prototype.getValues=function(){return this.$el.formData().user},FormView}(Backbone.View)}.call(this),function(){var ProfilesRouter,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};if(Qiita.controller!=="profiles"||!!Qiita.teamName)return;ProfilesRouter=function(_super){function ProfilesRouter(){return ProfilesRouter.__super__.constructor.apply(this,arguments)}return __extends(ProfilesRouter,_super),ProfilesRouter.prototype.routes={"settings/profile":"edit"},ProfilesRouter.prototype.edit=function(){return new Qiita.views.settings.profiles.FormView({el:$("form.user_form"),model:new Qiita.models.User(Qiita.user)})},ProfilesRouter}(Backbone.Router),new ProfilesRouter}.call(this),function(){var actionType,namespace;namespace=ns("analysis"),actionType="Stock an item",namespace.stockAnItem=namespace.wrap([namespace.favorableActionFactory(actionType),namespace.mixpanel(actionType,function(props){return{item_uuid:props.uuid,position:props.position}}),namespace.analytics("Item","Stock",function(props){return{eventLabel:_.capitalize(props.position)}})])}.call(this),function(){var namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.FeedbackFormView=function(_super){function FeedbackFormView(){return FeedbackFormView.__super__.constructor.apply(this,arguments)}return __extends(FeedbackFormView,_super),FeedbackFormView.prototype.el=".js-feedback-form",FeedbackFormView.prototype.events={"shown.bs.modal":"focusOnTextArea"},FeedbackFormView.prototype.focusOnTextArea=function(){return this.getTextArea().focus()},FeedbackFormView.prototype.getTextArea=function(){return this.$el.find(".js-feedback-form-text-area")},FeedbackFormView.prototype.initialize=function(){return this.getTextArea().bind("keydown","ctrl+return",function(_this){return function(){return _this.submit()}}(this)),this.getTextArea().bind("keydown","meta+return",function(_this){return function(){return _this.submit()}}(this))},FeedbackFormView.prototype.submit=function(){return this.$el.find(".js-feedback-form-form").submit()},FeedbackFormView}(Backbone.View)}.call(this),function(){var AnonymousGlobalButtonClickView,GlobalButtonClickView,namespace,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};namespace=ns("views"),namespace.App=function(_super){function App(){return App.__super__.constructor.apply(this,arguments)}return __extends(App,_super),App.run=function(){return new this},App.prototype.el="body",App.prototype.events=function(){return{"pjax:start":"startLoading","pjax:end":"finishLoading","mouseover .js-lazyDropdown":"loadSubmenu"}},App.prototype.initialize=function(){var _base;typeof (_base=this.$el.find('[data-toggle="tooltip"]')).tooltip=="function"&&_base.tooltip({});if(!Qiita.currentTeam)return Qiita.user?new GlobalButtonClickView:new AnonymousGlobalButtonClickView},App.prototype.startLoading=function(){return this.$el.addClass("pjax-loading")},App.prototype.finishLoading=function(){return this.$el.removeClass("pjax-loading")},App
.prototype.loadSubmenu=function(e){var $el;$el=$(e.currentTarget);if($el.data("load"))return;return $el.data("load",!0),$.ajax({url:$el.data("remote"),type:"GET",success:function(html){return $($el.data("target")).html(html)}})},App}(Backbone.View),GlobalButtonClickView=function(_super){function GlobalButtonClickView(){return GlobalButtonClickView.__super__.constructor.apply(this,arguments)}return __extends(GlobalButtonClickView,_super),GlobalButtonClickView.prototype.el="body",GlobalButtonClickView.prototype.events={"click .js-stockButton":"stockItem"},GlobalButtonClickView.prototype.stockItem=function(e){var $el,path;return e.preventDefault(),path=$(e.currentTarget).data("path"),$el=$(".js-stockButton[data-path='"+path+"']"),$el.find(".btn").prop("disabled","disabled"),$el.hasClass("stocked")?this.unstock(""+path+"/unstock",$el):this.stock(""+path+"/stock",$el)},GlobalButtonClickView.prototype.unstock=function(url,$el){return $.ajax({url:url,type:"POST",success:function(){var $counter,counter,value;return!(counter=$el.data("counter"))||($counter=$(counter),value=parseInt($counter.text(),10),$counter.text(Math.max(value-1,0))),$el.removeClass("stocked")},complete:function(){return $el.find(".btn").prop("disabled",!1)}})},GlobalButtonClickView.prototype.stock=function(url,$el){var promise;return promise=$el.data("position")?Qiita.analysis.stockAnItem({uuid:$el.data("uuid"),position:$el.data("position")}):Qiita.util.promises.resolved(),promise.always(function(){return $.ajax({url:url,type:"POST",success:function(){var $counter,counter,value;return!(counter=$el.data("counter"))||($counter=$(counter),value=parseInt($counter.text(),10),$counter.text(value+1)),$el.addClass("stocked")},complete:function(){return $el.find(".btn").prop("disabled",!1)}})})},GlobalButtonClickView}(Backbone.View),AnonymousGlobalButtonClickView=function(_super){function AnonymousGlobalButtonClickView(){return AnonymousGlobalButtonClickView.__super__.constructor.apply(this,arguments)}return __extends(AnonymousGlobalButtonClickView,_super),AnonymousGlobalButtonClickView.prototype.stockItem=function(e){var $el,view;return e.preventDefault(),$el=$(e.currentTarget),view=new Qiita.views.LoginModalView({action:"stock",target:$el.data("uuid"),type:"stock:"+$el.data("position")}),$("body").append(view.render().el)},AnonymousGlobalButtonClickView}(GlobalButtonClickView)}.call(this),Qiita.views.App.run();